<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO> ZF32-278-058 </DOCNO><DOCID>07 711 228</DOCID><JOURNAL>Microprocessor Report  Sept 1989 v3 n9 p7(1)* Full Text COPYRIGHT MicroDesign Resources Inc. 1989.andM;</JOURNAL><TITLE>Revision D pares 29000 down to three bugs. (AMD 29000 revision D;Bugs andamp; Quirks) (column)andM;</TITLE><DESCRIPT/><TEXT>AMD has acknowledged three known bugs in the current stepping of the 29000,revision D.andP;  The most serious bug from revision C, the failure of tbe branchtarget cache to work reliably, has been fixed.andP;  The three errata listed herewere also present in revision CA.andM;AMD has distributed samples of the new revision, and orders placed from nowon are expected to be filled with this revision.andM;Erratum 1:andM;Instruction Burst Mode ProblemandM;The processor may lock up if:andM;* An instruction burst mode access is preempted at the same time that theprefetcb buffer is filled [in other words, *IRDY (instruction ready),andM;*IBACK (instruction burst acknowledge), andandM;*IBREQ (instruction burst request) are negated simultaneously], andandM;* a load or store data transaction is performed, followed byandM;*the simultaneous assertion of *IRDY andandM;*DRDY.andM;Under these conditions, the 29000 will assert *IRE Q and lock up when *IRDYis asserted.andP;  Workaround: This bug can be avoided in either of two ways:andM;* Do not allow preemption of instruction bursts by the external memorysystem; always allow the 29000 to complete the burst transfer.andM;* Do not assert *IRDY and *DRDY (data ready) simultaneously unless *IBREQ isasserted.andM;Erratum 2:andM;Exception Handling Priority ErrorandM;If an interrupt or trap whose priority is lower tban the data-access orcoprocessor exceptions is pending prior to the assertion of *DERR (dataerror), then tbe processor mistakenly services the lower-priority exceptionfirst.andM;Workaround: Any exception handler routine that responds to exceptions oflower priority tban the data-acce ss exception or coprocessor exceptionshould test the &quot;transaction faulted&quot; (TF) bit in tbe channel controlregister.andP;  If the TF bit is set, the &quot;contents valid&quot; (CV) bit in the channelcontrol register should be cleared (see erratum3), and an IRET instructionshould be executed immediately.andP;  This will correctly return program executionto the data-access exception handler.andP;  Upon completion of the data-accessexception handler, execution will resume with the lower-priority exceptionhandler.andM;Erratum 3:andM;Data-Access Exception ProblemandM;If the *DERR signal is asserted, and anotber exception is taken and completedbefore tbe data-access exception is taken, tben tbe previous transaction thatcaused *DERR to be asserted will be restarted before entering the data-accessexception handler.andM;Workaround: This problem may be avoided in either of two ways:andM;* If restarting the previously faulted transaction is allowed, tben thedata-access exception handler sbould test the &quot;contents valid&quot; (CV) bit inthe cbannel control register.andP;  If the CV bit is clear, then tbe restartedtransaction was successful.andP;  The &quot;transaction faulted&quot; (TF) bit should thenbe cleared, and an IRET instruction executed.andP;  If, on tbe otber band, the CVbit is set, then the restarted transaction failed again, and normaldata-access exception handling should proceed.andM;* If restarting tbe previously faulted transaction is not allowed, tben allexception handler routines must test tbe TF bit.andP;  If the TF bit is set, thenthe CV bit should be cleared, followed by a return from the exceptionhandler.andP;  Execution will tben continue properly with the data-accessexception handler.andM;SummaryandM;All three bugs appear to be minor.andP;  Erratum 1 requires a hardware workaround,but since hardware workarounds have been required since tbe first silicon,existing designs eitber already incorporate the fixes or don't produce tbeoffending set of conditions.andP;  The last two bugs can be fully corrected witbappropriate modifications to tbe exception handlers, wbich is relativelypainless.andO;</TEXT></DOC>
<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF108-541-790  </DOCNO><DOCID>08 541 790.andM;</DOCID><JOURNAL>PC Magazine  June 26 1990 v9 n12 p427(3)* Full Text COPYRIGHT Ziff-Davis Publishing Co. 1990.andM;</JOURNAL><TITLE>Windows. (tutorial)</TITLE><AUTHOR>Hall, William S.andM;</AUTHOR><SUMMARY>The difference between Microsoft Corp's Windows/386 andWindows/286 is the former's use of the virtual 8086 mode of the80386, a mode that can be used to create multiple 8086-basedoperating systems operating under a protected-mode supervisoryprogram.andP;  The WIND386.386 supervisor program is loaded by theWIN386.EXE, and manages and creates expanded memory, eventuallycreating WIN86.COM.andP;  Intelligent choices in memory software andhardware configuration can result in a significantly improvedperformance, especially with Windows.andP;  If a user is using anexpanded memory board on a 386 computer, Windows/386 may notoperate, due to the fact that Windows/386 emulates expanded memoryin extended memory.andM;</SUMMARY><DESCRIPT>Company:   Microsoft Corp. (products).andO;Ticker:    MSFT.andO;Product:   Microsoft Windows (Graphical user interface) (usage).andO;Topic:     WindowingTutorialGraphical User Interface.andM;</DESCRIPT><TEXT>WindowsandM;EXECUTING WINDOWSandM;Ben Wolff of Amarillo, Texas, poses some questions that many user ofMicrosoft Windows/386 have asked: &quot;What is the difference between WIN386.EXEand WIN86.EXE?andP;  Why can I run multiple copies of WIN86 but not of WIN386, andhow does MSDOS.EXE fit into this?&quot;andM;Acomparison with Windows/286 may help.andP;  In this case you run Windows from DOSusing WIN.COM.andP;  When WIN.COM starts, it displays the Windows logo and thenloads Windows.andP;  During this process MSDOS.EXE is executed and becomes thefirst Windows application.andP;  MS-DOS acts as the command shell for Windows andis used to manipulate files and run other programs.andP;  One program you canexecute from MS-DOS is WIN.COM itself, but now instead of loading WINDOWSagain, another instance of MS-DOS is created.andP;  You can get the same effect byexecuting MSDOS.EXE from Windows.andM;In Windows/386, WIN86.COM plays the same role as WIN.COM.andP;  From DOS, you canrun WIN86.andP;  What you get is just Windows/286.andP;  The only piece missing is theWindows/286 standard application support.andP;  Even that can be supplied if youreplace the Windows/386 versions of WINOLDAP.MOD and WINOLDAP.GRB with thecorresponding 286 versions.andM;What differentiates Windows/386 from Windows/286 is the former's use of theVirtual 8086 (V86) mode of the 80386.andP;  As you may know, V86 mode can be usedto create multiple 8086-based operating systems running under aprotected-mode supervisory program.andP;  WIN386.EXE loads the WIN386.386supervisor program, creates and manages expanded memory, and eventuallyexecutes WIN86.COM.andP;  At that point, you have an 8086 virtual machine runningthe equivalent of Windows/286.andP;  Because only one supervisor can be present,WIN386 can be executed only once.andP;  You can run WIN86 again, but as inWindows/286, you will just get another instance of MS-DOS.andM;For some additional insight into the role of WIN386.EXE, you may want to tryan experiment.andP;  In your Window/386 directory, copy.andP;  WIN86.COM to WIN.COM.andO;Copy COMMAND.COM to WIN86.COM.andP;  Now execute WIN386.COM.andP;  When the DOS promptreturns, you will be in virtual 8086 mode with an expanded memory manager.andO;If you now type WIN, you will find yourself in Windows.andP;  This technique isused by programmers to run the Windows version of the Code View Debugger,which must be started from DOS and requires expanded memory to run.andM;Once you have run WIN386 to get into V86 mode as described above, you couldeven switch to your Windows/286 directory and run Windows from there.andP;  You'llalso find that you have expanded memory (pull down the About box to see howmuch).andP;  However, don't expect standard application support to work as it doesin Windows/386.andP;  In fact, after you have experimented a bit, you should besure to return to your original configuration.andM;WINDOWS' MEMORY USAGEandM;Contributing editor Barry Simon recently sent me the following tip on Windowsmemory switches:andM;&quot;Ironically, with Windows 2.x, you may get out of memory errors because youhave LIM EMS 4.0 memory available!andP;  If you have such memory available below640K, then by default, Windows will use a large page-frame model.andO;Windows/386 always has such memory available.andP;  You can have this same memoryavailable under Windows/286 if you run it on a 386 machine with QEMM-386 or386MAX, and you'll have it with a true LIM EMS 4.0 hardware board.andM;&quot;With the large page-frame model, Windows divides conventional memory intotwo pieces, the page frame and the rest.andP;  The page frame consists of EMSmemory that can be swapped in and out.andP;  The remainder is not swapped out andis needed for some special-purpose items such as printer drivers.andM;&quot;When you want to run many applications, a large swappable region can begood, but with even one application you can run out of room in thenonswappable region if it is too small.andP;  If you get an 'Out of Memory'message even when using only a single application, you may want to experimentwith two command-line switches when you load Windows.andM;win/nandM;loads Windows with no EMS support for the Windows kernel, so it disables thelarge page-frame model.andM;win/L+40andM;loads Windows with a large page frame 40K smaller than the default.andP;  Thenumber 40 can be changed to other possibilities like +20 and +80.andM;&quot;There is no magic formula for figuring out which switch is best--onlyexperimenting with your setup can help.&quot;andM;What Simon writes is true-only experimentation will help you find somethingclose to your needs.andP;  To add to this confusion, machine architecture, CPUdesign, and history have conspired to produce a muddled picture of memorylayout, usage, and options in today's PC.andP;  The situation is not helped byterms such as extended, expanded, and expansion memory, which simply soundtoo much alike to be informative.andP;  And, although Windows comes with severalMS-DOS device drivers designed to help you use your computers' extra memory,their functionality has not always been made clear.andM;However, making intelligent choices in memory hardware and softwareconfiguration can result in significant performance improvements, expeciallywith a memory- hungry program such as Windows.andP;  So it pays to take a closerlook at this matter.andM;In most machines, there are unused areas in the range between the end ofconventional memory and the beginning of extended memory (if any isinstalled).andP;  The technique of using one or more of these gaps as a windowinto a memory bank is the basis for expanded memory.andP;  Since the window lieswithin the 8086's address range, it becomes possible to provide memory beyondthe 640K limit for 8086-, as well as for 80286- and 80386-based machinesoperating in real mode.andP;  Special hardware such as Intel's Above Board andAST's Rampage card along with the supporting software are usually required touse expanded memory.andP;  However, like almost every other statement we'll makein this column, there are exceptions.andP;  in particular, there are some softwarepackages, including Windows/386 itself, that are able to emulate expandedmemory in extended memory.andM;Expanded memory is sometimes called banked memory, and the term is a goodone.andP;  Imagine a row of 64K memory blocks on a board.andP;  According to settingson the board, one of these blocks appears at an address below 1MB but aboveteh installed conventional memory.andP;  By switching the hardware on the boardunder software control, another memory block can be made to appear in thissame memory space.andP;  In this way, a program that knows how to use expandedmemory can store data and even execute code in one of these blocks.andM;In a multitasking environment like Windows, each task can be partially orfully loaded into a block, and the scheduler can then switch to theappropriate block as the task becomes active.andP;  In this way, even an 8086processor can see, albeit through a small window, quite a large amount ofmemory.andP;  The Above Board, for example, holds up to 4MB of memory, and it ispossible to have several such boards in a single machine.andM;It is important to understand that expanded and extended memory do notconflict if differenct hardware is used for each.andP;  It is possible to have afull complement of extended memory and as much as 32MB of expanded memory.andO;The reason is, of course, that expanded minory does not lie in any particularaddress space until a block is activated.andP;  Even so, expanded memory isaddressed below the beginning of extended, so the two do not conflict.andP;  Ofcourse, if you are using a software package to emulate expanded memory inextended memory, then some of the latter will be reduced.andM;Understanding expanded memory is complicated by the fact that there are twostandards for its control.andP;  One is called LIM (Lotus-Intel-Microsoft) EMS(Expanded Memory Specification) 4.0 and the other LIM EMS 3.2.andP;  Although LIMEMS 3.2 is a subset of 4.0, there are some differences that could affect howWindows uses this kind of memory.andP;  Basically, in order for 3.2 to work, thesupporting software must be able to locate four 16K (64K total) contiguousblocks of unused memory space.andP;  Usually this area is found above the videoaddres space but below system ROM.andM;Sometimes it can be difficult to find a contiguous 64K block because ofsupplemental ROMs, LAN cards, and so forth.andP;  Often there may be additionalfree areas smaller than 64K that would go unused under 3.2.andP;  LIM 4.0 removessome of these restrictions, since up to 256 16K blocks are permitted, andthey do not have to be contiguous.andP;  If you are still using LIM 3.2, it's timeto upgrade your software.andM;SUPPORT FOR EXPANDED MEMORYandM;From its 1.0 days, Windows has included EMS (expanded memory) support for theIntel Above Board by distributing a form of the required software driverEMM.SYS on the Windows disks.andP;  In windows 2.0, the AST Rampage board wasadded (REMM.SYS) along with AST's special memory board designed for the ATandamp;T6300 Plus (AEMM.SYS).andP;  Finally, PS2EMM.SYS was provided for the IBM PS2expanded memory board.andP;  If you use Windows and these boards, you should beusing the Windows-supplied version of the drivers.andM;Four README files with the same names as the drivers but with the extension.TXT explain quite clearly how to install the software.andP;  In particular thereare notes about how to select the page frame (the window into the memory) andhow to avoid conflict with networks.andM;You do need to be careful when using expanded memory and Windows/386.andP;  Forexample, take the following letter from Joel Bryant of Boston, Massachusetts:andM;&quot;Why can't I get Windows/386 to work with my AST expanded memory board?andP;  Inever had any trouble until I tried to switch to Windows/386.&quot;andM;The answer is simple.andP;  If you use an expanded memory board on a 386 machine,you may not be able to run Windows/386, because Windows/386 emulates expandedmemory in extended memory.andP;  Windows/386 probably will not function correctlyif expanded-memory hardware and the appropriate driver are installed.andO;Therefore, it's highly recommended that such memory be converted to extendedmemory, if possible.andP;  For example, the AST and the Above Board both allow youto distribute memory between the two modes in a fairly arbitrary manner.andM;This may make it inconvenient, however, when you are not running Windows.andO;You may want to consider creating different CONFIG.SYS files to match theneeds of the various environments under which you operate your system.andM;There is another unpleasant surprise for which you should be prepared.andO;Memory boards usually provided slow, 16-bit memory; the 80386 would muchrather see fast, 32-bit memory.andP;  If converted to extended memory, the 16-bitmemory will perform much more slowly.andM;Windows itself will perform about the same, since it runs in the first 1MB ofmemory where the memory is 32 bits wide.andP;  But if you then start running oldapplications, however, some of them may end up in your 16-bit extendedmemory.andP;  It can be quite a performance hit.andP;  When I first got my ZenithZ-386, it had only 1MB of memory.andP;  I added 4MB using my Intel Above Board,but the speed of processing dropped by a factor of nearly four for oldapplications!andP;  I strongly suggest that you retire such boards or leave themin 80286 or 8086 machines.andM;Windows/386 will give you expanded memory from your fast 32-bit memory if youuse it as a basic control program.andP;  Again, however, this solution may not beadequate; for example, the amount of memory space provided for standardapplications that can be executed is less than you would have availabledirectly under DOS.andP;  It has been a source of some frustration to me that Ican't always use the tool I need most under Windows/386, the Microsoft Ccompiler.andP;  We all hope that in the future Windows will become a trueoperating environment capable of supporting both DOS and Windows withouthaving to leave one for the other.andM;RAMDRIVE AND SMARTDRIVEandM;If you are an experienced Windows user, you know that Windows moves,discards, and reloads program segments according to the demands of themoment.andP;  You're also aware that Windows may create numerous temporary filesboth for Windows applications and for storage of memory and screen images ofstandard applications during context switching between them and Windows.andO;Windows' performance improves greatly if these activities can be made frommemory rather than from disk.andM;This is the programmer's answer for Bob Vox of Canton, Ohio, who wants toknow about the importance and use of RAMDrive and SMARTDrive:andM;&quot;Windows comes with two programs called SMARTDrive and RAMDrive.andP;  I'm notsure exactly why Windows needs these programs.andP;  I have to support severalcomputers on which Windows is run and I would appreciate any information youcan shed about them, as well as on how they might affect our use of windows.&quot;andM;Let's take a closer look at the two programs.andP;  RAMDrive and SMARTDrive, eachwith a separate purpose, can help you take full advantage of extra extendedor expanded memory to increase the speed of operations in Windows and inMS-DOS itself.andM;RAMDRIVE.SYS is an MS-DOS device driver that has been offered as part of theWindows package since its beginning.andP;  Capable of creating a virtual diskdrive in any kind of memory, RAMDRIVE.SYS can be used to replace thetraditional VDISK.SYS that comes with MS-DOS.andP;  RAMDrive is documented in thefile RAMDRIVE.TXT supplied on the Windows distribution disk.andP;  Although recentversions of this file are more accurate, older versions of Windows 2.0omitted the fact that RAMDrive can also use expanded memory.andP;  In addition,its use with the ATandamp;T 6300 PLUS was confused with the Olivetti M28, causingfurther confusion.andP;  If you think that your documentation is suspect, perhapsyou should try to obtain the latest version.andM;RAMDrive is installed by placing the appropriate DEVICE= line intoCONFIG.SYS.andP;  More than one RAMDrive can be used.andP;  The options are toonumerous to describe here, but basically, you must choose where the RAM diskwill reside: in conventional (not recommended), expanded, or extended memory;and the size, block size, and number of entries in the root directory.andP;  Thelatter two can be defaulted if you expect only temporary files to be createdthere.andP;  However, if you plan to store programs as well, then you may need toincrease the number of root directory entries above the default value of 64.andM;Whether you place RAMDrive in extended or expanded memory depends on a lot offactors, including the processor and the version of Windows (/286 or /386)you are running.andP;  As a general rule, you should use extended memory if enoughis available.andP;  As for the size, try at least 1MB if you use a lot of standardapplications.andP;  But even a small RAMDrive can help you.andP;  And, don't forget toset two environment variables in your AUTOEXEC.BAT file.andP;  For example, ifdrive E: is the RAM disk, include the following:andM;set temp=e:\ set tmp=e:\andM;Different MS-DOS programs use different environment variables.andP;  These are themost common but are by no means universal.andM;SMARTDRV.SYS requires much less thinking to use.andP;  It is also one of the mostuseful of all the supplementary programs supplied by Windows.andP;  SMARTDrive isa disk caching program that keeps the most recently accessed portions of thedisk in memory.andP;  Once installed, it works quietly in the background.andO;SMARTDrive is not only useful in Windows but in DOS as well.andP;  I am alwayssurprised, however, by the number of experienced Windows users and developerswho know about SMARTDrive but don't use it.andP;  I can always tell if one of mycolleagues has not installed it by the amount of disk activity; a compile ofa Windows program is almost completely devoid of disk activity when thedriver is present and completes noticeably faster.andM;The installation of SMARTDrive is described adequately in the Windows manual.andO;You'll have to make the same choices as for RAMDrive concerning which kindand how much memory to use, but these are only decisions.andP;  SMARTDrive is alsoWindows-aware; if placed in expanded memory, the amount of space used fordisk caching is adjusted according to the demands for memory.andM;You can see the effects of SMARTDrive as follows.andP;  Run a large program suchas GW-BASIC from DOS and note the time it takes to load.andP;  Then exit and runit again.andP;  The program will load recognizably faster.andM;OPENING WINDOWSandM;Share your experiences with the Windows environment.andP;  We'll pay you $50 forany tips we print.andP;  Please send your letter on a disk along with a printout.andO;Mail your contributions to Windows, PC Magazine, One Park Avenue, New York,NY 10016, or upload them to PC MagNet (see the &quot;By Modem&quot; sidebar in theUtilities column).andO;</TEXT></DOC>
<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF109-557-115  </DOCNO><DOCID>09 557 115.andM;</DOCID><JOURNAL>PC Magazine  Nov 13 1990 v9 n19 p463(7)* Full Text COPYRIGHT Ziff-Davis Publishing Co. 1990.andM;</JOURNAL><TITLE>Bringing it all together: a look inside the 486 chip. (LabNotes)(includes related articles on cache memory, register set)</TITLE><AUTHOR>Boling, Douglas.andM;</AUTHOR><SUMMARY>The integrated design of Intel's 80486 microprocessor isdiscussed.andP;  The 486 is a good CPU for computation-intensiveapplications because it includes a built-in math coprocessor and8Kbyte memory cache.andP;  It uses the same basic register set andarchitecture as the early 8086 chip but can address up to 16Mbytesof memory, allowing for complex applications.andP;  It shares the pagedvirtual memory management scheme of the 80386, combining the 386microprocessor with the 387 coprocessor and 82385 cache controlleron a single chip.andP;  The internal cache uses a four-way setassociative design and can be disabled at the memory-page orbus-cycle level.andP;  New instructions in the 486 include byteswapping; exchange and add; compare and exchange; invalidate datacache; write back to data cache; and invalidate TransactionLookaside Buffer entry.andP;  The 486 cannot slow down the processorand may not work with some antiquated software.andM;</SUMMARY><DESCRIPT>Company:   Intel Corp. (Products).andO;Ticker:    INTC.andO;Product:   Intel 80486 (Microprocessor) (Design and construction).andO;Topic:     MicroprocessorsCircuit DesignHigh TechnologyRegistersInstruction Sets.andO;Feature:   illustrationchart.andO;Caption:   Register set of the 80486. (chart)Input/output diagram of the Intel 80486. (chart)Control registers for the 80486. (chart)andM;</DESCRIPT><TEXT>Bringing It All Together: A Look Inside The 486 Chip Intel's release of a newmicroprocessor every few years has become an eagerly awaited ritual.andP;  Sinceit is newer, faster, and more powerful, the Intel 80486 has become themust-have chip for the 1990s power user.andM;The 486 features a faster execution unit to speed processing of basicinstructions, a redesigned interface to memory, and an integrated mathcoprocessor.andP;  All of these improvements combine to make the 486 the fastestand most powerful microprocessor of the 80x86 line.andM;Yet, for all its improvements in speed, the 486 is more of an evolutionarystep than a revolutionary one.andP;  Unlike the 286 and 386 processors, the 486does not extend the 80x86 line's basic architecture.andP;  Although the 486 chipdoes not contain any new modes--such as protected mode or Virtual 86 (V86)mode--its improvements nevertheless position the 486 to have a significantimpact in a number of areas.andM;INTEGRATED FUNCTIONALITYandM;The integrated floating-point math coprocessor makes a 486-based machine anexcellent choice for computation-intense applications like CAD(computer-aided design) packages and spreadsheets using higher-mathoperations.andP;  Since the math coprocessor is included in the microprocessoritself, floating-point performance is much faster than a comparable 386/387combination.andM;In earlier members of the 80x86 family, a processor and its companion mathcoprocessor communicate through a complicated protocol of I/O reads andwrites.andP;  This protocol slows down both the processor and coprocessor, sinceeach must wait for data from the other.andP;  Combining the processor andcoprocessor allows data to be transferred as fast as it can move between twointernal registers.andM;Intel did not stop with improving the floating-point performance.andP;  The 486also includes a built-in memory cache unit to improve memory access times.andO;The 8K memory cache not only stores recently used data, but it alsoanticipates future accesses by the processor by reading memory locationsbefore the data there is actually needed.andM;To keep the cache full, the protocol with which the 486 reads memory has beenredesigned for much greater efficiency.andP;  The 486 can use its burst mode toread large blocks of data at close to twice the speed of the 386.andP;  This is animportant feature of the 486, but simply substituting a 486 in an old 386system will not take advantage of the processor's high-speed burst mode.andM;Unfortunately, there is no way to determine whether a 486-based system isdesigned to use burst mode.andP;  Users interested in tapping this feature in aparticular system should first check with its manufacturer to determinewhether it uses the burst mode to read memory.andM;Another benefit of the 486 can be seen in the high integration of functionsonto the chip itself.andP;  To provide the equivalent of the 486 using 386-typecomponents, you would need a microprocessor, a floating-point coprocessor, amemory cache controller, and the RAM chips that comprise the cache.andO;Obviously, all these parts cost money and take up space.andP;  Even though the 486is quite expensive (close to $1,000 for a single 486), the cost of creatingthe same functionality from a 386 chip set can easily be higher.andM;Cost is not the only benefit of this high level of integration.andP;  since the486 chip is physically smaller than the combination of a 386 and 387, the 486takes up less space on the motherboard.andP;  The space saved by the 486 can beused to add extra features, add more memory, or simply make the motherboardsmaller.andM;ORIGINS OF THE 486andM;In order to gain a better understanding of the ideas behind the 486, it'shelpful to take a look back at previous version of the 80x86 family.andP;  Allprocessors in the series are capable of running programs designed for theoriginal 8086.andP;  A companion floating-point coprocessor, identified by an80x87 number, is available for all versions except the 486.andM;The 8086, which was considered quite advanced for its day, pales incomparison with the 486.andP;  The 8086 and its sister chip, the 8088, have a slowfour-cycle bus interface, can address only 1MB of memory, and by today'sstandards are quite slow.andP;  Crude as the 8086 appears these days, however,there's no overstating its contribution.andP;  The basic register set andarchitecture, after all, is still the core of every 80x86 processor.andM;The 8086's register set consists of four 16-bit general-purpose registers, AXthrough DX.andP;  Another two registers, DI and SI, can be used as either indexregisters or general-purpose registers.andP;  A 16-bit flags register provides thecurrent state of the processor.andM;Since all registers internal to the 8086 are only 16 bits wide, a set of foursegment registers is used to provide base pointers for all addresses.andP;  Duringa memory access, the appropriate segment register is shifted 4 bits to theleft and added to the offset of the instruction.andP;  This shift provides the 20bits needed to address the 1MB of address space.andM;The 80186 and 80188 started with the core of the 8086 chip and added aninternal timer and DMA channels.andP;  You won't find either of these chipsserving as CPUs in many PCs, though, because these particular processors weredesigned more for the intelligent controller market than for the PC market.andM;Intelligent controllers are computers used for specific tasks.andP;  And Intel8042 controller, for instance, is used in most PCs to control the keyboard.andO;On many LAN adapter cards, 80186s are used to relieve the main processor fromhaving to spend time with low-level network protocol.andM;The Intel 80286, first available in 1984, extended the 80x86 architecture toa new level of performance and functionality.andP;  The 286 includes asophisticated memory management system to protect programs from interferingwith one another.andP;  It can also address up to 16MB of memory, providing roomfor much more complex applications.andM;The major advance in the 286 was the addition of the processor's protectedmode.andP;  When the 286 is in protected mode, its segment registers are used aspointers to memory tables instead of as base registers, as they are in the8086.andP;  In a concession to backward compatibility, the 286 can be configuredin real mode so that the segment registers are used as they are on the 8086.andM;When memory is addressed in protected mode, the 286 uses the appropriatesegment register as a pointer into what's called a descriptor table.andP;  Thistable contains the actual base address of the segment as well as its size andaccess rights.andP;  The base address in the table is 24 bits wide, which allowsthe segment to be placed anywhere within the 16MB memory space.andP;  And theaccess-right bits allow the 286 to protect segments from unauthorized readsand writes.andP;  Since reading a descriptor entry for each memory access isunacceptably slow, the 286 caches the last entry read for each segmentregister.andM;Protected mode is a vastly improved system of memory management over realmode.andP;  Unfortunately, the resulting loss of compatibility between real modeand protected mode has dealt the PC industry a blow from which it has yet torecover.andP;  The difference between real mode and protected mode iw what allowsOS/2 to use up to 16MB of memory.andP;  It also, however, is what prevents DOSapplications from running under OS/2.andM;To provide compatibility, OS/2 provides the DOS compatibility box--a part ofOS/2 that executes in real mode and simulates the DOs environment.andP;  Butbecause the 286 can run only one task at a time in real mode, the usefulnessof the compatibility box is limited.andM;INDUSTRY EXPLOSIONandM;The 80386 was the first processor of the 80x86 series that was designed afteran explosion within the PC industry.andP;  While the 8086 and 80286 were 16-bitprocessors with 16-bit-wide registers, the 80386 doubled the bus width to 32bits.andP;  The 32-bit data and address buses doubled the speed at which theprocessor could access memory.andP;  It also increased memory addressability to 4gigabytes (4,096MB).andM;The 32-bit buses were not the 386's only attractive features.andP;  A pagedvirtual-memory scheme and the ability to simulate multiple 8086 chips alsoincreased the versatility of the 80x86 series.andP;  Another inprovement was theremoval of the 64K segment limit; this allowed segment sizes up to the entire4GB address space.andM;Removing the segment size limit provides flexibility in how the 386 isprogrammed.andP;  For example, by making a segment start at address 0 and have asize of 4GB, the segment concept no longer has any significance.andP;  The OS/22.0flat memory model is implemented in this manner.andM;For designs that prefer the protection of separate segments for differentsections of code, the segment registers can be set as in the 286.andP;  Segmentshave the advantage that you can set them to specific size.andP;  If a programaccesses memory outside of its segments, an error is reported to theoperating system.andM;The 386's paged virtual-memory scheme has provided system programmers with analternative to the segment-based, virtual-memory system of protected mode.andO;Virtual memory allows an operating system to make it appear that applicationshave more memory available than actually exists in the system.andM;In a paged memory system, memory is divided into small portions of memorycalled pages (4K on the 386).andP;  As memory is accessed, the 386 checks a pagetable to see if the page requested is currently in memory.andP;  If it isn't, theprocessor interrupts the operating system to read that page of memory fromdisk.andM;While allowing the 286 version of protected-mode operation, an additional 386mode called Virtual 86 (V86) mode allows the 386 to emulate multiple 8086processors and, therefore, multiple DOS sessions.andP;  Using V86, software suchas Mcirosoft Windows 3.0 can run multiple DOS programs at the same time.andM;The registers of the 386 are 32 bits wide, but they retain their 8- and16-bit addressability.andP;  Two new segment registers, FS and GS, were added tohelp in manipulating large numbers of segments.andP;  Four control registers areincluded to control and test the paged memory system.andP;  A set of debugregisters is included to aid in program development.andM;80486 INTERNALSandM;In simple terms, an 80486 is a combination of a microprocessor (80386), afloating-point math coprocessor (80387), a memory cache controller (82385),and 8K of RAM cache, all in one chip.andP;  Also included has been hardware forparity generation and parity checking.andP;  The speed improvements the chip makeswere done by increasing the speed at which the 486 executes instructions,improving the speed at which the 486 talks to memory, and dramaticallyincreasing the speed of the floating-point operations.andM;Software that takes advantages of the 387, you'll find, will run withoutmodification using the 486.andP;  The reason?andP;  The 486's floating-point unit iscompletely compatible with the 80387.andM;Just as a 387 operates in parallel with the 386, the 486's floating-pointunit operates in parallel with the Arithmetic Logic Unit (ALU).andP;  The ALUprovides the function for all basic instructions such as moves, adds, andmultiples; the floating-point unit implements all floating-pointinstructions.andP;  The two unit operate independently of one another.andM;The 486's integral floating-point unit can read memory directly through thesame bus interface that the ALU uses.andP;  Data is transferred between thegeneral-purpose registers and the floating-point unit on an internal64-bit-wide data transfer bus.andM;The 486 can be configured to report floating-point errors in two differentways.andP;  The Intel-defined interrupt for reporting floating-point errors is INT10h.andP;  (Note: this shouldn't be confused with INT 10h used for BIOS videoroutines in DOS systems.)andM;On DOS systems, a floating-point error is reported via the nonmaskableinterrupt (NMI).andP;  The 486 can be configured either to perform an interrupt10h automatically or to activate an external outside of the chip.andP;  For DOSsystems, the 486 is configured to activate the external NMI hardware usingthe external floating-point error pin.andM;Aside from the integration of the coprocessor hardware, the 486 bus interfaceis the most functionally improved area.andP;  Dramatically boosting theperformance of the 486 are enhancements to the local bus speed, the additionof a memory cache, and the close coupling of the cache to the instructionprefetch queue.andM;The local processor bus is the interface between the 486 and the outsideworld.andP;  Under normal operation the bus performs, as do the 286 and 386, with2 clock cycles for every bus cycle.andP;  When a read requies more than one buscycle, however, the 486 can enter burst mode.andM;Under burst mode the 486 starts the bus cycle with the standard 2-cycle read,but subsequent reads are performed with only 1 clock cycle.andP;  For example,  A386 would take at least 16 clock cycles to read 32 bytes of data, whereas the486 using burst mode could take as few as 9 clock cycles.andP;  Since the cache isfilled by reading 16-byte blocks of data, burst mode has a major impact onthe 486's performance.andM;INTERNAL CACHEandM;The 8K internal cache is organized in a four-way set associative fashion,each set consisting of four lines of 16 bytes.andP;  The cache is used in allmemory reads whether the read is a data read or an instruction fetch.andP;  The486 cahces only memory reads; I/O reads are not cached.andP;  (For more on the 486cache, refer to the sidebar &quot;An 80486 Cache Primer.&quot;)andM;Caching can be controlled by disabling the cache entirely, disabling it on amemory-page level or using external hardware--at the bus-cycle level.andO;External hardware can control the cache on a cycle-by-cycle basis usingcontrol lines on the 486.andP;  This allows system designers to tune the 486'scache to achieve maximum performance.andM;If the bus is currently busy, memory writes are cached in one of four specialwrite buffers.andP;  This write buffering allows the 486 to continue with the nextinstruction regardless of the state of the local bus.andP;  Since the writebuffers delay the writing of data to memory, the buffers can cause memoryreads to occur before a write, even if the write were caused by a previousinstruction.andM;Since the 486 can rearrange memory reads and writes, it would appear thatproblems could arise if the reordered instructions were working with the sameaddress in memory.andP;  Thankfully, the 486 detects occurrences such as this andprevents problems by not allowing reordering in this case.andM;I/O writes are handled differently from memory writes.andP;  Single I/O writes arenot buffered, because of the problems this might cause with I/O devices.andO;Multiple I/O writes are buffered but are always written in the same order asthe instructions occurred.andM;Device recovery time between I/O accesses must be handled differently withthe 486 than in previous versions of the 80x86 series.andP;  Programmers normallyinsert a jump instruction between I/O writes, allowing time for the I/Odevice to recover.andP;  On a 486 this method will not work, because the prefetchtime may be dramatically reduced by the cache.andP;  On a 486, Intel recommendsthat a read to a noncachable location should be inserted between I/O cyclesto ensure device recovery time.andM;Another enhancement to the local processor bus is the addition of paritygeneration and checking for external data.andP;  Most PC compatibles use parity tocheck for memory errors.andP;  Before the 486, hardware on the motherboardgenerated and checked the parity bits.andP;  With the 486's integrated paritylogic, the external parity logic can be eliminated.andM;When data is written, the 486 provides a parity bit for each byte of the databus.andP;  The parity bit is stored along with the data byte in system RAM.andP;  Whendata is read, parity is checked for each of the valid data bytes.andP;  If anerror is detected, the 486 simply sets an external pin; it is theresponsibility of the system to act on the error.andP;  The parity logic is usedto provide error checking for system RAM, not as an internal check of the486.andM;NEW INSTRUCTIONSandM;Only six new instructions have been added to the 486 beyond the instructionset of the 386.andP;  The new instructions areandM;* Byte SwapandM;* Exchange and AddandM;* Compare and ExchangeandM;* Invalidate Data CacheandM;* Write Back and Invalidate Data CacheandM;* Invalidate Translation Lookaside Buffer (TLB) EntryandM;The Exchange and Add (XADD) and Compare and Exchange (CMPXCHG) instructionscombine the Exchange (XCHG) instruction with two of the most populararithmetic instructions, ADD and CMP.andM;The Byte Swap instruction aids in converting long data from the big-endian tothe little-endian formats.andP;  Intel processors store data larger than 1 bytewith the lower-order byte in the numerically lower address; this is known aslittle-endian format.andP;  Motorola processors such as the 68000 family storedata in the big-endian format, with the lower-order byte in the higheraddress.andP;  While the Exchange (XCHG) instruction is useful for converting wordvalues, the Byte Swap (BSWAP) instruction has been added on the 486 forconversion of double-word values.andM;The remaining three instructions are for cache manipulations and are notnormally used by applications.andP;  The Invalidate Data Cache (INVD) instructionresets the cache.andP;  The Write Back and Invalidate Data Cache (WBINVD)instruction performs the same cache reset as the INVD instruction but alsoinstructs any external cache to write to memory any write-cached lines.andP;  TheInvalidate TLB Entry (INVLPG) instruction resets an entry in the page-tableTranslation Lookaside Buffer.andM;REGISTER SETandM;The true scale of the 80486 can be appreciated from a look at Figure 1, whereall the functions of three major top-of-the-line Intel chips have beencombined into one colossal processing unit: the 80486.andP;  In addition to theregisters needed for 386/387 compatibility, additional registers have beenadded for testing the cache.andM;The registers of the 486 can be divided into three sets: the basearchitecture registers, the system-level registers, and the floating-pointregisters.andP;  The ase architecture and floating-point registers are used byapplication programs, while the system-level registers are used by theoperating system to control the memory management hardware, task switching,and internal cache.andM;The base architecture registers are identical to the registers on the 386.andO;All registers are 32 bits wide but can be accessed as 16- and 8-bit registersfor backward compatibility.andP;  The two additional segment registers added tothe architecture with the 386--FS and GS--are included in the 486 as well.andM;The system-level registers consist of the control registers CR0 through CR3and the segmentation base registers.andP;  While the control registers arebackward-compatible with the 386, a number of new bits have been defined tocontrol the new hardware included in the 486 processor.andP;  (For a detaileddescription of the new control register bits, read the sidebar &quot;ControlRegister Bit Assignments: 486 Versus 386.&quot;)andM;The floating-point registers are identical to the registers of the 80387.andO;Eight 80-bit-wide data registers can be either directly addressed orconfigured as a stack.andP;  Each data register holds a 64-bit significand, a15-bit exponent, and a sign bit.andM;The status word contains flags reflecting the status of the floating-pointunit.andP;  The format of the status word, which contains the condition code bitsfrom the last floating-point operation, is similar to that of the 387'sstatus word.andP;  As on the 387, the instruction and data pointers are used todetermine the cause of floating-point error exceptions.andM;486 I/O DESCRIPTIONandM;The 486's hardware interface is similar to the 386's but is notpin-compatible.andP;  New control lines have been added for cache control,memory-page control, parity generation, and burst-cycle control.andP;  Theco-processor interface seen on earlier 80x86 processors has also beenremoved.andM;Figure 2 shows how the 486's hardware interface can be divided into sectionsdenoting different functions, which don't necessarily correspond with thephysical layout of the chip.andP;  As you can see, the address bus and bus controllines comprise the majority of the lines.andP;  Note also that the address buslines are bidirectional, to accommodate the cache's need for &quot;bus snooping.&quot;andM;Intel's commitment to compatibility is shown by the company's addition of aspecial line to control the Address bit 20 (A20) line.andP;  The larger addressspace of the 286 and 386 has an undesired effect on software written for the8088's 1MB address space.andP;  Many software packages, including some versions ofDOS, take advantage of the fact that, on the 8088, addressing past the 1MBlimit simply wraps around to the lowest 64K of RAM.andM;To provide compatibility, 286 and 386 computers have special hardwareexternal to the processor to allow the wrapping of addresses.andP;  Since the 486has an internal cache, external hardware would not work.andP;  Therefore, the 486includes a line to disable the A20 line internally.andP;  This internal wrappingof the address makes it possible for the cache to interpret wrapped addressescorrectly.andM;The 486 differs from all previous 80x86 processors by specifying that theclock input must be the same speed as the processor.andP;  In other words, while a25-MHz (megahertz, or millions of times per second) 80386 needed a 50-MHzclock, a 25-MHz 486 needs a 25-MHz clock.andP;  This may seem unimportant, but itcan have an impact on the user.andP;  Here's why:andM;In order to achieve PC at compatibility, many clones will slow down the clockof the computer any time the ISA (AT-compatible) bus is accessed.andP;  Many olderISA cards cannot respond quickly enough for today's high clock speeds.andO;Slowing the clock speed when using the ISA bus allows older cards to operateas if they were in a slower system.andM;On a 486, changing the clock speed while the computer is running is notpossible, because of the clock circuitry internal to the 486.andP;  Whilemore-complicated methods of slowing bus cycles can be used, 486 systemscannot provide the tried-and-true method of slowing the clock speed forcompatibility.andM;Some older software can also be affected by 486 systems' inability to slowdown the processor.andP;  In some programs, timing loops dependent on the speed ofthe processor are used to measure time.andP;  Since the 486 runs much faster thanprevious 80x86 chips, the offending programs can become unusable.andO;Fortunately, few if any programs today use such antiquated techniques astiming loops; a quick check of older software, however, is advisable beforemoving to a 486.andM;It is the 486 for everyone?andP;  In a word, no.andP;  While the improvements in speedare impressive, there are no extensions to the 80x86 architecture that can'tbe found in a 386-chip system.andP;  But if speed is the only consideration, the486 is clearly your best route to the fast lane.andM;Already rumors abound concerning the 80586.andP;  And if the past is any gauge,the PC industry can surely look forward in anticipation to the next Intel80x86 processor.andP;  But with more than one million transistors packed into onechip, let's take a breather and appreciate what cannot be overstated--thatthe 80486 is an incredible achievement of integration, speed, and power.andM;Douglas Boling is a contributing editor of PC Magazine.andO;</TEXT></DOC>
<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF207-849-100  </DOCNO><DOCID>07 849 100.andM;</DOCID><JOURNAL>Hewlett-Packard Journal  Oct 1989 v40 n5 p34(3)* Full Text COPYRIGHT Hewlett Packard 1989.andM;</JOURNAL><TITLE>Design considerations in a fast hopping voltage-controlledoscillator. (the VCO design in the Hewlett-Packard HP 8645A AgileSignal Generator)</TITLE><AUTHOR>McJunkin, Barton L.; Hoover, David M.andM;</AUTHOR><SUMMARY>The Hewlett-Packard HP 8645A Agile Signal Generator's fast hoppingmode enables switching between frequencies in less than 15microseconds with a one-part-per-million accuracy.andP;  The HP 8645A'svoltage-control oscillator (VCO) features: 515MHz to 1030MHzoutput, fractional-N phase-locked loop (PLL) and/orfrequency-locked loop (FLL, based on a delay line discriminator)stability control, pretune digital-to-analog converter (DAC),phase shifter, FLL DAC, and PLL DAC.andP;  The fast hopping mode of theHP 8645A requires the PLL to be opened and discriminator controlof frequency accuracy in addition to reducing oscillator phasenoise.andP;  The values of the three DACs and the phase shifter must belearned by the system in order to enter the fast hopping mode.andO;The learn sequence, power amplifier, phase shifter, delay line,wideband feedback loop, and VCO pretune circuit are described.andM;</SUMMARY><DESCRIPT>Company:   Hewlett-Packard Co. (products).andO;Ticker:    HWP.andO;Product:   HP 8645A Agile Signal Generator (Signal processor) (design andconstruction).andO;Topic:     OscillatorsDigital Signal ProcessingTest EquipmentSystem Design.andO;Feature:   illustrationchart.andO;Caption:   Block diagram of the voltage-controlled oscillator. (chart)andM;</DESCRIPT><TEXT>Design Considerations in a Fast Hopping Voltage-Controlled OscillatorandM;IN ITS FAST HOPPING MODE of operation, the HP 8645A Agile Signal Generatorcan switch to a new frequency in less than 15 microseconds with an accuracyof one part per million or better.andP;  This article describes the fast hoppingVCO block diagram and the five major technical challenges that had to be metto build the fast hopping VCO.andM;System ArchitectureandM;The HP 8645A uses a 515-to-1030-MHz oscillator whose stability is controlledby a fractional-N phase-locked loop (PLL), by a frequency-locked loop (FLL)based on a delay line discriminator, or by both the PLL and the FLL.andP;  Fig.andP;  1is a block diagram of the system.andM;The frequency-to-voltage conversion characteristic of the discriminator isinverted by placing the discriminator in a feedback path around the VCO.andP;  Thestabilized VCO now has the voltage-to-frequency characteristics of theinverted discriminator.andP;  For fast switching speed, the feedback loop must bewideband and high-gain without degrading the stability of the discriminator.andM;The ideal model for the FLL loop gain is a single integrator with aunity-gain crossover frequency of 1 MHz.andP;  Because of the relatively flat gainand excess phase shift of the discriminator, the gain margin of the looprequired more attention than the phase margin.andM;As explained in the box on page 30, the frequency-to-voltage conversioncharacteristic of the delay line discriminator is a repetitive function ofthe form:andM;[V.sub.out] = [V.sub.peak]Sin(([omega] - [[omega].sub.0])[tau]),andM;where [V.sub.peak] is the peak voltage from the phase detector, [omega] isthe input angular frequency (radians/second), and [tau] is the time delay ofthe line (seconds).andP;  Although each input frequency results in only one outputvoltage, the inverse is not true.andP;  Each output voltage can indicate amultitude of frequencies.andP;  The inverted response of thediscriminator-stabilized VCO is single-valued only over a small range of([omega] - [[omega].sub.0])[tau] andless; [+ or -]90 degrees at the FLL phasedetector.andP;  This means that the VCO must be pretuned to witin 1/4[tau] Hz ofthe final frequency before the discriminator will stabilize the VCO to thecorrect frequency.andP;  To ensure that no transient condition can result in theFLL's locking the VCO to the wrong frequency, the FLL is designed to have apulling range less than 1/4[tau] Hz.andP;  The pulling range is limited to thisvalue by a diode limiter on the FLL VCO control line.andM;The standard signal detector operation of the instrument uses thefractional-N loop to phase-lock the VCO to the reference signal and thediscriminator to reduce the phase noise of the oscillator.andM;Learn SequenceandM;Before the system enters the fast hopping mode, it must learn the correctvalues for the pretune DAC (digital-to-analog converter), phase shifter, FLLDAC, and PLL DAC.andP;  The learn sequence is as follows.andM;The fractional-N loop phase-locks the VCO to the desired frequency.andP;  The tuneline offset is used to optimize the pretune value.andP;  The phase shifter is usedto null the FLL phase detector within [+ or -]6 degrees of quadrature.andP;  TheFLL DAC is used to cancel the phase detector offset at the input of thelow-noise amplifier.andP;  The PLL DAC is used to replace the PLL tune line withan equivalent dc voltage.andP;  This procedure is followed for each frequency thatis hopped to.andP;  The DAC values are then saved in internal memory to be calledback when the instrument hops to that frequency.andM;In the fast hopping mode, the PLL is opened and the discriminator controlsthe frequency accuracy of the signal generator in addition to reducing thephase noise of the oscillator.andP;  Since the discriminator controls thefrequency accuracy of the signal generator, it is necessary to optimize thestability of the discriminator for best performance.andP;  The three components ofthe discriminator that have the greatest effect on frequency stability arethe power amplifier, the phase shifter, and the delay line.andP;  Besides thediscriminator, two other components can cause considerable frequency error:the feedback loop and the VCO pretune circuit.andM;Power AmplifierandM;The power amplifier drives the input of the discriminator with a leveled RFsignal.andP;  Automatic level control (ALC) maintains the power amplifier outputat six volts peak into the backmatch resistor.andP;  This high power level isnecessary for low-noise, high-sensitivity operation.andM;Absolute accuracy of the power amplifier ALC loop is not as important asswitching speed and stability.andP;  The ALC loop has a minimum bandwith of 500kHz and must settle to within 0.012% of the final level within 15microseconds.andP;  This is the kind of stability that is necessary to keep theAM-to-]Phi]M conversion of the phase detector to acceptable levels.andP;  Sincethe AM-to-[Phi]M rejection of the phase detector is only 10 dB worst-case,0.012% AM can cause 0.1 ppm of frequency error in the FLL.andM;The extreme stability specification for the AM level requires a very accuratelevel detector.andP;  The detector is a peak-to-peak Schottky diode detector withan output level of -12V dc.andP;  Because of the high output level, temperaturecompensation of the Schottky diodes was not necessary.andM;The detector output is compared to a stable reference voltage and the errorsignal is integrated and applied to the modulator at the input to the poweramplifier.andP;  The modulator is a limiter amplifier with a variable bias.andP;  Themodulator has 15 dB of linear range with the output varying from 5 to 20 dBm.andM;The final ALC loop bandwidth varies from 500 kHz to 2 MHz across the500-MHz-to-1040-MHz frequency band.andP;  Since the bias loop of the limiter isused to control the modulator, and since the power amplifier is nearlimiting, the bias loops for both the limiter amplifier and the poweramplifier are wideband loops.andP;  To reduce the overall detector error signal,the power amplifier bias circuit uses an integrator in the bias loop for highdc gain.andM;Phase ShifterandM;The main design goal for the phase shifter was to produce no more than 0.2ppm of error in the stabilized VCO from t = 5 microseconds to t = 10 minutes.andO;This requires phase stability within andless;0.0012 degree.andP;  Other design goals werelow loss, good input/output match, low phase noise, good phase stability withtemperature, monotonicity of phase shift with frequency, fast switching (andless;5[mu]s for andless;0.0012[degree] stability), and excellent long-term phasestability.andM;Two specifications drove the choice of implementation: phase noise andswitching speed.andP;  A varactor phase shifter could not satisfy both conditions.andO;With a switching speed specification of 5 microseconds, sufficient filteringfor phase noise was not possible.andP;  The topology that was chosen is atransmission line structure with double-pole double-throw pin switches.andP;  Fivebinary-weighted phase shift elements have phase shifts of 90[degrees],45[degrees], 22.5[degrees], 11.25[degrees], and 5.6[degrees] at 500 MHz.andO;Because of the transmission line design, the minimum phase resolution at 1000MHz is 11.25[degrees].andM;The initial switch design used discrete pin diodes and simple drivercircuits.andP;  A large phase drift occurred when the current was switched fromone diode to another.andP;  The drift was caused by the heating of the pin diodes,which affected the RF resistance and forward bias voltage.andP;  The initial phasedrift was approximately 0.5[degree] from t = 5 [mu]s to t = 10 s.andM;Dual monolithic pin diodes are now used in the DPDT switches.andP;  Since one orthe other of the diodes is forward biased, the total power dissipation in thediode chip is constant.andP;  Also, the driver circuits were replaced with stablecurrent sources.andP;  The constant bias improves the long-term stability.andP;  Thesechanges reduced the phase drift from t = 5 [mu]s to several minutes tosomething on the order of 0.02[degree].andM;The remaining phase drift was difficult to track down.andP;  It was finally tracedto shifts in the dielectric constant of the printed circuit board materialcaused by localized heating.andP;  The heating was caused by both bias and RFpower dissipation.andP;  The shifts in dielectric constant caused changes in thegroup delay of the transmission lines.andP;  Placing the design onto a Teflonboard allowed the phase shifter to meet its short-term phase stabilityspecification.andM;Even with Teflon as a dielectric material, a few degrees change in ambienttemperature caused a long-term phase stability error.andP;  The phase shifter wassplit into two parts to improve the stability.andP;  The two most-significant bitswere placed in the discriminator leg with the delay line, and the threeleast-significant bits were placed in the other leg.andP;  This improved thelong-term stability by a factor of 20 to 50.andM;Delay LineandM;Two specifications affected the choice of the delay line length of 70nanoseconds: phase noise pedestal and FM deviation.andP;  A 1-MHz loop bandwidthis necessary to maintain a typical phase noise pedestal of -145 dBc.andP;  At 1MHz, the excess phase shift added to the open-loop gain of the discriminatorby the delay line has to be small enough not to reduce the loop phase marginunacceptably.andP;  Also, a peak FM deviation of 1.76 MHz was required.andP;  To ensurelinear operation, this needs to be less than half the pulling range of theFLL.andP;  A 70-ns delay line meets both requirements.andP;  It adds only 25[degrees]of excess phase shift at 1 MHz, and it results in a pulling range of 1/(4 x70 ns) Hz, which is more than twice the required FM deviation.andP;  Theinstantaneous gain of the FLL changes only 3 dB over the FM range.andM;The coaxial delay line is ovenized to shield the coax from temperaturefluctuations resulting from ambient temperature changes and instrumentturn-on.andP;  The electrical length of solid-Teflon-dielectric semirigid coaxialcable is very sensitive to temperatures below 25[degrees]C.andP;  At 70[degrees]C,the sensitivity reaches a value of zero.andP;  At first, the plan was to raise thetemperature of the delay line to 70[degrees]C.andP;  However, heat losscalculations showed that continous power consumption in the coax heater couldbe as high as 20 watts at low ambient temperatures.andP;  A temperature of45[degrees]C was decided upon as a good compromise.andP;  At ambient temperaturesbelow 45[degrees]C, the coax temperature is held at 45[degrees]C.andP;  As theambient temperatures goes above 45[degrees]C, the heater shuts off.andP;  Thus, athigh ambient temperatures, the stability of the delay line is dependent onthe insulation of the oven and the reduced sensitivity of the delay line totemperatures above 45[degrees]C.andM;Wideband Feedback LoopandM;The wideband feedback loop includes the low-noise amplifier, the summingamplifier, and the loop integrator.andP;  The design of all three blocks involvedlow-noise, wideband techniques, but special attention was paid to temperaturestability and saturation recovery time.andP;  Because of the variedspecifications, all of the amplifiers in the feedback loop use discreteoperational amplifiers.andM;The best amplifier design for temperature stability uses a monolithicdifferential pair with no emitter degeneration as the input stage.andP;  Evensmall values of emitter resistance can degrade the temperature coefficient ofthe input offset voltage by a factor of 10.andP;  Because of the low-noiserequirements of the low-noise amplifier, the differential pair in thiscircuit uses two discrete transistors that are thermally coupled.andM;During a switching transient, the high-gain secondary stages in theamplifiers are likely to saturate or enter cutoff.andP;  Reverse-biased Schottkydiodes are placed across the collector-to-base junctions of those transistorsto reduce saturation recovery time.andP;  This technique works well with fastswitching transistors that have a low [V.sub.ce] saturation voltage.andP;  Many RFand microwave transistors with high [V.sub.ce] saturation voltages come outof saturation with large thermal transients, so they are not recommended forfast switching amplifiers.andM;Many switches are used in the wideband feedback circuitry to protect theamplifiers from saturating when the FLL is not in use.andP;  Also, since eachamplifier stage has high dc gain, the stages are separated from each other tokeep offset voltages from one stage from saturating another.andP;  These circuitscan be switched on and off without introducing errors caused by saturationtransients.andM;VCO Pretune CircuitandM;The VCO pretune circuit must tune the oscillator to within 1 MHz of the finalfrequency in 3.5 microseconds.andP;  After that time, no switching transients fromthe pretune circuit should be large enough to affect the center frequencyaccuracy of the stabilized VCO.andP;  The pretune circuit also needs sufficientfiltering to avoid degrading the noise of the FLL.andM;The pretune filter is a simple RC low-pass filter with a speed-up switch toshort the resistor during the 3.5-[mu]s switching time.andP;  After the 3.5-[mu]sswitching time, the switch is open.andP;  The time constant of the RC filter isone millisecond.andP;  The reason for the extremely large time constant comparedto the instrument switching speed of 15 microseconds is the shape of the loopgain of the FLL.andP;  The one-pole design of the loop means that the stabilizedVCO is more sensitive to the rate of change or slope of the VCO pretunetransients than to the peak value of the transients.andP;  The loop has sufficientgain at low frequencies to cancel a large VCO pretune transient with a timeconstant of one millisecond.andM;The design approach for the fast pretune circuit was to ensure that the onlytransients generated have time constants much larger or much smaller than the15-[mu]s instrument switching speed.andP;  Fast-time-constant transients settleout before t = 15 [mu]s.andP;  Slow-time-constant transients change so slowly thatthe loop gain of the FLL cancels the errors without generating a large errorfrequency.andP;  Transients with time constants between 12 [mu]s and 15 [mu]scause considerable frequency error at t = 15 [mu]s.andP;  Dielectric absorption ina polypropylene pretune capacitor had considerable transient energy with atime constant of 12 to 15 [mu]s, so a specially designed Teflon-dielectricpretune capacitor was chosen instead.andP;  The dielectric absorption at 12 [mu]sis specified at 0.004%.andP;  This very tight dielectric absorption specificationguarantees less than 0.2 ppm center frequency error as a result of VCOpretune transients.andM;AcknowledgmentsandM;The authors would like to recognize Don Borowski for contributions to allfacets of the fast hopping VCO design, and Brian Watkins, the firmwaredesigner for the fast hopping VCO.andP;  Many thanks to others that listened tosome real blue-sky theories without batting an eye.andO;</TEXT></DOC>
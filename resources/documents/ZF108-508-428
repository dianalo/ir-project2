<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF108-508-428  </DOCNO><DOCID>08 508 428.andM;</DOCID><JOURNAL>PC Magazine  June 12 1990 v9 n11 p367(3)* Full Text COPYRIGHT Ziff-Davis Publishing Co. 1990.andM;</JOURNAL><TITLE>Windows. (programming in Microsoft Windows)(Column) (tutorial)</TITLE><AUTHOR>Hall, William S.andM;</AUTHOR><SUMMARY>The Microsoft Windows graphical interface has many quirks thatcause problems with terminate and stay resident (TSR) programsbecause TSRs install 'hooks' into the operating system that canconflict with Windows itself.andP;  Windows users should avoid usingTSRs if they are not necessary and should load TSRs before runningWindows, avoiding them while Windows is on the screen.andP;  Anotherunusual feature of Windows is the Multiple Document Interface(MDI) user interface style, under which menus can float free ofwindows and the top-level window acts as a desktop to a collectionof document windows.andM;</SUMMARY><DESCRIPT>Product:   Microsoft Windows (Graphical user interface) (usage).andO;Topic:     Graphical User InterfaceSoftware DesignMenusOperating EnvironmentsTutorialWindowing.andM;</DESCRIPT><TEXT>TSR PROGRAMS AND WINDOWS Terminate-and-stay-resident programs (TSRs), such asSideKick, have become important adjuncts for many DOS users.andP;  Yet, in orderto function simultaneously with other programs, a TSR must install hooks intothe operating system.andP;  Typically these include keyboard, timer, and otherhardware interrupts.andP;  And, when a TSR is used, its output usually includespail or all of the screen being used by another program; in the process, thecurrent mode of the display may be changed.andP;  The situation can becomefrenetic when several TSRs are installed; more often than not, they don'tplay together very well.andM;Microsoft Windows adds yet another layer of complexity to the situation,because it wants to own all the resources of the machine and shares them onlygrudgingly.andP;  Joan Vu of Fullerton, California, expresses a typical situationwhen she writesandM;I want to be able to use various TSR programs when running under Windows/386.andO;I can load a TSR and then run Windows/386 with no problem.andP;  But for somereason I can't call up a TSR by using its hotkey.andP;  What can I do to get myTSRs working?andM;Ms.andP;  Vu's experience is not far from my own and that of many many others.andO;Whenever I use the enhanced keyboard on a PC, my first step is to install aTSR called CAP-CON, written by Patrick Swayne of the Heath Users' Group, tointerchange the misplaced Ctrl and CapsLock keys from their current unusablepositions.andP;  (I have never been able to fathom why IBM could design such agreat keyboard for its Selectric typewriters and such bad ones for PCs.andO;Worst of all, all other manufacturers follow the leader.) Yet when I runWindows, I find that I once again need a deformed hand in order to use theleft Ctrl key.andP;  It is as if CAPCON did not exist.andM;Another problem occurs when a TSR does not correctly restore the state of thesystem after its use.andP;  From time to time, I need a screen-capture TSR programto save Windows displays.andP;  It works fine in Window's/286.andP;  But when I try tosave a screen in Windows/386, the colors become substantially altered, andmouse movements begin to show up as screen writes along the bottom edge.andP;  Itdoes not matter whether I run WIN86 or WIN386.andM;So, it is difficult to predict your success with TSRs.andP;  However, I can passon some of the thoughts I've accumulated to give you a basis forexperimentation.andP;  The rules are a bit different for Windows/286 andWindows/386.andM;The basic principle applicable to all versions of Windows is simple: do notuse TSRs if you don't really need them.andP;  Many of the features found inpopular pop-up programs are provided in Windows desktop applications, and youshould consider using these instead of pop-ups.andP;  TSRS, some of which arequite large, also take up memory that cannot be managed by Windows.andP;  Windowsprograms, on the other hand, use memory in a way that helps optimize thespace available.andM;Of course, if you're like many of us, you don't use Windows all the time, andyou still need your favorite TSR when in DOS.andP;  Hence, the second rule: loadthe TSR before running Windows but do not use it while Windows is on thescreen.andM;Still, you may need the TSR while actually in Windows.andP;  The situation issomewhat analogous to what I was told in flying school about spinning anairplane certified for a one-turn spin.andP;  Once you pass one rotation, youbecome a test pilot.andP;  With possibly less disastrous consequences, try theTSR.andP;  If it works, fine; if not, you can take up the matter with the TSR'sauthor or try to find a suitable alternative.andP;  As Windows becomes more andmore respectable, software publishers are finding it increasingly necessaryto ensure a degree of Windows compatibility.andM;If you use Windows/386 not only to run other Windows programs but as acontrol program too, you have other possibilities.andP;  After running WIN386.EXE,execute a full-screen command shell by double-clicking on the COMMANDF.PIFfile, and then run your TSR.andP;  If you have enough memory, you can run each ofyour TSRs in different shells.andP;  Each TSR will then be available in itsrespective shell.andP;  For the most part, TSRs loaded in this fashion should runwithout any trouble.andP;  Because each is running under its own DOS shell, noneof these TSRs will be usable under Windows itself.andP;  However, TSRs that don'twork properly when installed before Windows is run will probably work in theshell.andP;  Note that TSRs loaded in this manner will go away when you close yourWindows/386 session.andM;Finally, you may want to experiment with some of the features found in theWindowsl386 WIN.INI file if a TSR requires the use of a keystroke reserved byWindows or if your TSR allows you to select the keystroke sequence needed toinvoke it.andP;  Use Notepad (the desktop text editor provided with Windows) toopen the WIN .INI file-or simply double click on WIN .INI and find thefollowing lines: altescape=on altenter=on altspace=on alttab=onaltprintscn=onandM;The AltEscape, AltEnter, and similar entries allow you to disableWindows/386's use of these special Alt-key sequences.andP;  Normally they shouldall be enabled (set to on), in which case these sequences are used byWindows/386 and are not seen by other applications.andP;  If you need to run anapplication that relies on one of these sequences, you may set that entry tooff so that Windows/386 will ignore that key sequence and pass it on toapplications.andP;  For example, altspace=off frees up the Alt-Spacebarcombination for your use with a TSR.andP;  If your TSR allows you to select yourkeystrokes, use one of the Alt options listed.andM;If you have some additional suggestions about TSRS, either of a generalnature or relating to specific products, let me know so that I can share themwith our readers.andP;  THE MULTIPLE-DOCUMENT INTERFACE I have discovered a bug inMicrosoft Excel (or perhaps Windows itself).andP;  I once found myself without amouse and had to use Windows' keyboard accelerators to get around.andP;  Idiscovered that when I use the keyboard, I can sometimes create floatingmenus (though perhaps disembodied menus is the better term).andP;  That is, I canmake a menu that floats free of any window appear on the desktop.andP;  Nothinghappens to the application-it still functions properly-but it is ratherdisconcerting.andP;  Perhaps you can shed some light on the mystery or report thebug to Microsoft.andM;William DunlapandM;Newport Beach, CaliforniaandM;You haven't discovered a bug by any means.andP;  What you've uncovered is one ofthe quirks of the Multiple Document Interface, a user interface style thatwill become more and more important to Windows applications.andM;Consider the screen shown in Figure 1.andP;  Note the location of the CHARTwindow.andP;  CHART is a child window of the Excel main window and cannot be movedoutside of Excel's window.andP;  However, although you can't see most of the CHARTwindow, it is still on the screen, only the part that falls outside the Excelwindow is invisible.andM;If the CHART window were to remain in place and the Excel main window were tobe reduced in size, the location of the CHART window would remain unchanged.andO;Though you cannot access it with the mouse, MDI lets you send keystrokes tothe CHART window even when it is invisible.andP;  In Figure 2 I've done just that.andO;Note that the menu appears in exactly the same location it did in Figure 1.andO;Disconcerting perhaps, but definitely not a bug in the software.andM;If you have ever seen Excel, you will have noticed that each spreadsheet,macro, or chart on the screen is actually a window that, except for the lackof a menu, has many of the characteristics of the main window itself.andP;  Eachhas a title bar, system button, size button, scroll bars, and thick borders.andO;In fact, the whole picture is one of a desktop within a desktop, and Excelwas the first major Windows application to use this motif, now called theMultiple Document Interface, or MDI.andP;  Other applications, such as FutureSoft's DynaComm are also using MDI.andP;  Destined to play an expanded roll inWindows, it is worthwhile to look at MDI from a user's perspective.andM;MDI is described in the Application Style Guide, Chapter 13, which is a partof the Windows Software Development Kit.andP;  A very nice article by Kevin Welch(which, although directed primarily at developers, is also a must-read fortechnical program managers and PC support specialists) can be found beginningon page 45 of the March 1989 issue of Microsoft Systems Journal.andP;  Welch hasalso provided an MDI library, now in the public domain and complete withsource, that can serve as a basis for an MDI application.andP;  His company,Eikon, uses an enhanced version, and you may be able to negotiate itspurchase for your own company's program development.andM;Let's begin by imagining a Windows screen containing a number ofapplications.andP;  Think of the screen as a desktop.andP;  Using a standard set of keycommands (Alt-Tab, Alt-Esc, and so on) or the pointing device, you can moveto any program and use, minimize, maximize, restore, resize, or close it.andP;  Ina certain sense, you can regard each application's main window as a child ofthe desktop (although, technically speaking, the main window has no parent).andM;In an MDI application, its top-level window acts as a desktop to a collectionof document windows contained within the main window.andP;  Each such window is achild window, and consequently, no part extends outside the applicationitself.andP;  More precisely, we say each document (or MDI) window is clipped toits parent.andP;  Each MDI window may contain different data or a different viewof the same data.andP;  Using Excel as an example, one document might be aspreadsheet, and another could be a chart of the same information.andP;  In a wordprocessor, each window may display the contents of different files.andP;  In acommunications program, each window might be connected to a different COMport.andP;  MDI MAIN WINDOW Even experienced Windows users can be a bit baffledwhen confronted with an MDI application.andP;  However, the desktop window itselfprovides no real surprises.andP;  The title bar usually contains the name of theapplication, and the system menu (the button to the left of the title bar) isequipped with the standard commands and Alt-function-key (Alt-Fx)accelerators to restore, move, size, minimize, maximize, and close thewindow.andM;In addition, the desktop contains a menu, and if several different kinds ofdocument windows are visible, you will notice that as you focus on each one,the contents of the menu bar may change.andP;  For example, some of the operationsthat are of interest to a spreadsheet may not be entirely relevant to itsaccompanying chart.andP;  In a multilingual editing program, if you move fromediting a file in English to one in French, it may be appropriate to alterthe menu's language as well.andM;Helping the user manage each of the documents is the Window pull-down menuitem, which is the last one on the menu bar except for possibly the Helpcommand.andP;  Typically, the commands on the menu include function groups toarrange the windows, hide and unhide them, and list them.andM;Because screen space is limited, some provision is really necessary to helpyou optimize the arrangement of the child windows.andP;  The usual choices are tocascade (as is done by Cardfile) or tile them.andP;  When they're tiled, each ofthe windows may be quite small, but this makes it easy to find the one youwant.andM;The currently active window (the one with the active title bar), can behidden by the Hide command.andP;  To get it back, choose Unhide.andP;  A list of hiddenwindows is presented, from which you can select the one  t to make visible.andM;Finally, each MDI window is either listed in the menu itself or a list box isactivated to help you find the rest of them.andP;  At the very least, each isidentified by a sequence number that acts as a mnemonic.andP;  In this way, youcan bring any window to the top, even if you cannot find it in a cluttereddesktop.andP;  The Window menu also provides a complete keyboard interface tomanaging the windows.andP;  Hence a mouse (although convenient) is not necessary.andO;THE MDI CHILD WINDOW At first glance, a document window appears to be thesame as the desktop.andP;  The title bar contains the name of the document beingviewed, and if active, the title bar is the same color as the main window.andO;In particular, if the application gains or loses the input focus, the activechild's title bar follows that of the parent's.andM;However, whereas the main window will have both a main and a control menu,you will notice that an MDI window has only the latter.andP;  This menu can beactivated with the mouse or with the Alt-Minus keyboard command.andP;  When itpops down, you will see the next big difference: although the menu selectionsare the same, the Alt-Fx accelerator keys have been replaced by Ctrl-Fx keys.andO;And usually the Minimize command is grayed.andP;  It is also not inconceivablethat an application may have an con for a class of document windows and lowthe window to be minimized.andP;  In such a case, the icon would appear in thelower part of the application's main window, and additional commands may benecessary in the Window menu to manage the icons.andM;When an MDI window is maximized, another interesting event occurs.andP;  As wouldbe expected, the window expands to fill the main's client area.andP;  The titlebar is stripped from the window and the title is added to the the main titlebar.andP;  The main menu is redrawn to add the child's control menu as theleftmost item.andP;  In this way, an MDI window can occupy the same area as thedesktop.andP;  In fact, if the desktop itself is then maximized, the MDI windowfollows, and if another document is selected from the list, it is also shownmaximized.andP;  this way, a document window can utilize the maximum availablescreen space.andP;  some early realizations of MDI, the title was not removed.andP;  Irecall that some program managers had objected to MDI on basis of this&quot;limitation.&quot; However, in proper MDI implementation such is not case.andP;  MOVINGTHROUGH DOCUMENT WINDOWS Every well-written Windows program pros two ways ofaccomplishing a task--with a pointing device or by means of the keyboard MDIis no different.andP;  To select next document window use Ctrl-F6, to shiftbackward use Shift-Ctrl-F6.andP;  Similarly, to move among objects within a givendocument window the commands F6 and Shift-F6.andP;  Given the right windowcoordinates for the main and a child window, you can arrive at a situationhere a keyboard accelerator will bring up floating window.andM;The Multiple Document Interface is today an accepted program interfacestandard for Windows that is just now being realized by some applications.andO;Until recently, however, it has been somewhat difficult to implement fully inthe current version of Windows.andP;  However, libraries and tools have beendeveloped and made available developers, and it is expected that MDI will bea principal feature of many new Windows programs.andP;  OPENING WINDOWS Share yourexperiences with the Windows environment.andP;  We'll pay you $50 for any tips weprint.andP;  Please send your letter on a disk along with a printout.andP;  Mail yourcontributions to Windows, PC Magazine, One Park Avenue, New York, NY 10016,or upload them to PC MagNet (see the &quot;By Modem&quot; sidebar in the Utilitiescolumn).andP;  *andO;</TEXT></DOC>
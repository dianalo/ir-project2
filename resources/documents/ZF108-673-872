<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF108-673-872  </DOCNO><DOCID>08 673 872.andM;</DOCID><JOURNAL>PC Magazine  August 1990 v9 n14 p461(2)* Full Text COPYRIGHT Ziff-Davis Publishing Co. 1990.andM;</JOURNAL><TITLE>The working word. (word processing) (column)</TITLE><AUTHOR>Stark, Craig L.andO;AttFile:   PCMAG\V09N14\BAR.WPM;2 Program:  BAR.WPM  Generic menu macro.andM;</AUTHOR><SUMMARY>A WordPerfect 5.0 macro that lets users create point-and-shootmenus is presented.andP;  One number, assigned to a specific variable,lets the macro keep track of any light bar movement.andP;  A specialroutine puts a menu box on the screen while a nested IF statementuses the initial variable assignment to paint the top choice inreverse video.andP;  This macro is generic but is well thought out.andO;WordPerfect 5.1 limits the number of on-screen fonts to 32, butreducing the size of the .ALL printer driver can let users addmore fonts.andM;</SUMMARY><DESCRIPT>Company:   WordPerfect Corp. (products).andO;Product:   WordPerfect 5.0 (Word processing software) (usage).andO;Topic:     Word Processing SoftwareMacrosTutorial.andO;Feature:   illustrationprogram.andO;Caption:   BAR.WPM. (program)Downloading extra soft fonts in Wordperfect 5.1. (program)andM;</DESCRIPT><TEXT>The need to shift among several word processors when working on this columnhas made me much more sympathetic to light bar menu systems.andP;  Unless you usea given software package so regularly that you don't consciously have to tryand recall its command keystroke combinations, a point-and-shoot approach,albeit indirect and theoretically inefficient, may actually save time-andcertainly frustration !andP;  A user-modifiable start in this direction forWordPerfect 5.0 users has been  provided by Richard Anderson and by frequentcontributor Jordan Hodgson.andM;LIGHT BAR MENUSandM;The WordPerfect 5.0 macro language can be used to create moving light barmenus.andP;  The generic macro structure that creates such a menu is shown inFigure 1; to use it you must specify the action to be performed by eachchoice.andM;A quick run through the macro structure will reveal how it works.andP;  The numberassigned to {VAR 1} enables the macro to keep track of any light bar movementyou make.andP;  A menu box is then put on the screen, and a nested {IF} statementuses the initial variable assignment to paint the top choice in reversevideo.andP;  Note that spaces-which show up as centered dots in the macroeditor-have been added to the wording of shorter choices to keep all bars ofuniform length, and that the wording must be rewritten when the painting isdone.andM;After the  IF) statement, a  CHAR) command with an empty message enforces asingle keystroke pause without altering the menu box.andP;  You now have threeoptions: press the first letter of any option to implement it directly; pressEnter to choose the highlighted item; or move the bar with the Up or DownArrow keys.andP;  If you choose the third option, the first and second optionsalways remain available, because the macro continues to loop back to the {IF}structure and the value of {VAR 1} is constantly updated.andM;The single response key that you choose is tested by the ensuing {CASE}statement.andP;  Provision is made for both upper- and lowercase letters, and ifan appropriate letter is pressed, execution goes directly to the actionselection routines at the bottom of the macro.andP;  If a key not included in the{CASE} tests is pressed, execution falls through to the lines following the{CASE} statement.andP;  A beep is sounded, and an error message is posted on thebottom screen row.andP;  After two seconds, the message is erased by the statement{PROMPT} {Del to EOL}~, and {Go}getkey loop~ enables a new try.andM;If you hit Enter, execution jumps to {LABEL}implement~, where a {CASE} testuses the current value of {VAR 1} to pick out the proper label.andM;An Up or Down Arrow diverts to the dec or the inc label, where the value of{VAR 1} is lowered or raised by one.andP;  The repaint routine next rewrites themenu box wording without reverse video to eliminate the current light bar.andO;Execution loops back up to the {IF} complex, and the new value of {VAR 1}causes the proper item to be highlighted.andM;The three available choices are represented by the {VAR 1} values 1, 2, and3.andP;  Note that the {IF} structure also tests for 0 and 4.andP;  The value 0 allowsyou to press the Up Arrow key to move directly from the top to the bottommenu line, while 4 lets you go from the bottom to the top line with the DownArrow key.andP;  Thus, for example, when the top item is highlighted after themacro is first run, an Up Arrow changes {VAR 1} to 0, via the dec label, sothat the {IF} test causes the bottom item to be painted.andP;  The value of {VAR1} is then reset to 3.andP;  If you now press Enter, this value will cause the{CASE} testing in {LABEL}implement~ to select the correct action.andP;  When youhit F1 to exit the menu, the opening {ON CANCEL} diverts to {LABEL}cancel~ toclear the menu from the screen.andM;Richard AndersonandM;Oakland, CaliforniaandM;Jordan V. HodgsonandM;Torrance, CaliforniaandM;As Mssrs.andP;  Anderson and Hodgson indicated, this is a generic macro, not afinished product.andP;  It is, however, a well-thought-out starting point.andP;  Youmay want to add more choices, give them more-appropriate names, and, ofcourse, you must add the necessary command keystrokes to the [action]sections of the macro.andP;  Only a single-level menu is presented-nothing likethe full-blown treatment implemented in WordPerfect 5.1-but WP power usersshould be able to extend the technique considerably.andP;  Naturally, when you'vedeveloped your own version of BAR.WPM you will also want to make it callableby means of a single-key macro.andM;MORE FONTS IN 5.1andM;You can encounter a font limit when using WordPerfect 5.1.andP;  The maximumnumber of fonts that can be selected using either the + or the * key is 32,regardless of how much printer memory is installed.andP;  While the WordPerfect5.1 manual warns of this limitation, it is a serious matter for HP LaserJetII owners with 1.5MB or more memory who are used to downloading more than 32soft fonts in WordPerfect 5.0.andM;Fortunately, as demonstrated step by step in Figure 2, there is a solutionthat will allow HP LaserJet Series II-and possibly other laser printer-userswho upgrade to WordPerfect, Version 5.1, to bypass the 32-font limit anddownload as many soft fonts as their printer's memory will allow.andM;Paul CrutchfieldandM;Spokane, WashingtonandM;Anyone who has struggled with the need to reduce the size of his .ALL printerdriver file in WordPerfect 5.1 in order to keep his Bitstream font generatingprogram happy has probably already developed either a love or a haterelationship with WP's PTR.EXE.andP;  I find the whole &quot;automatic&quot; printerinstallation procedure in WP-to say nothing of modifying the drivers withPTR-a frustrating nuisance.andP;  Perhaps when the documentation for PTR 5.1 isready it will be easier to understand what's going on.andP;  In any event,however, if you use a lot of fonts and can fit more than 32 into yourLaserJet II, Mr. Crutchfield's solution will do the job.andM;TIPS FROM WORKING WORDSMITHSandM;Tell fellow users about your latest word processing tips, and we'll pay you$50 for any tips we print.andP;  Please send your letter on a disk along with aprintout.andP;  Mail your contributions to The Working Word, PC Magazine, One ParkAvenue, New York, NY 10016, or upload them to PC MagNet (see the &quot;By Modem&quot;sidebar in the Utilities column).andP;  [FIGURES OMITTED]</TEXT></DOC>
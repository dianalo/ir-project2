<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF108-714-912  </DOCNO><DOCID>08 714 912.andM;</DOCID><JOURNAL>Data Based Advisor  June 1990 v8 n6 p72(8)* Full Text COPYRIGHT Data Based Solutions 1990.andM;</JOURNAL><TITLE>Quadbase SQL: the DBF/SQL connection that works. (Software Review)(structured query language) (evaluation)</TITLE><AUTHOR>Gutierrez, Dan D.andM;</AUTHOR><SUMMARY>Quadbase Systems is marketing a new professional development toolcalled Quadbase SQL.andP;  This structured query language (SQL) is astep above the industry standard version.andP;  Quadbase's productallows C or Clipper programmers to use SQL on standard dBASEdatabases and index files.andP;  The package fills a void in the SQLmarket.andP;  The interfaces are simple to integrate into anapplication, and the SQL engine furnishes a sturdy foundation forSQL productivity.andP;  Performance could be a bit speedier, errorchecking could be improved, and the manual could be better.andP;  Anexcellent product, otherwise.andP;  List price is $795.andM;</SUMMARY><DESCRIPT>Company:   Quadbase Systems Inc. (products).andO;Product:   dBASE (Data base management system) (product enhancement)Quadbase-SQL (Data base management system).andO;Topic:     EvaluationStructured Query LanguageProgram Development Tools.andO;Feature:   illustrationprogram.andO;Caption:   Sample program listings. (program)andM;</DESCRIPT><TEXT>Would you prefer accessing dBASE databases with the industry standard, SQL?andO;Quadbase Systems, the folks who showed us that DBASE IV's SQL doesn't alwayswork the way it should, now offers Quadbase SQL.andP;  This package lets C orClipper programmers use SQL on standard dBASE databases and index files.andO;(Communication Horizons' RaSQL library for Clipper lets you use SQL withNovell's NetWare SQL, but doesn't directly access DBFs.)andM;Why would you want to use SQL from either C or Clipper? Part of the answerlies in power and ease of use.andP;  SQL's rapidly becoming a standard in how weview and manipulate databases.andP;  It cuts across both hardware and softwarelines.andP;  If you work with SQL, you're aiming in the right direction to takeadvantage of database server technology.andP;  Now here's the DBF connection:Quadbase SQL gives you non-procedural access to dBASE files.andP;  You can accessdata across multiple dBASE files without setting indexes or relations orworrying about your pointers.andM;Back to the beginning.andP;  The basis of Quadbase SQL is the same SQL enginedriving dQUERY, another of Quadbase's products, which I'll explore shortly.andO;A &quot;SQL engine&quot; is the portion of a relational database manager that acceptsand interprets SQL commands.andM;Quadbase SQL, which claims to be a full implementation of the ANSI SQL-86level 2 standard, provides for three levels of SQL access.andP;  First, at thehighest level, you can use embedded SQL commands directly in C source code.andO;A preprocessor in Quadbase SQL takes this code and translates it into anequivalent native C code version that you can then compile with the MicrosoftC compiler.andP;  Second, you can directly call C functions in the Quadbase SQLlibraries.andP;  The first method will be much easier for database programmerswith only a slim knowledge of C. The second method may appeal to the moreexperienced C programmers because it provides more control, albeit at theexpense of more work.andP;  If you're already a C programmer, the Quadbase SQLaccess routines are as easy to use as any other toolbox.andP;  I found usingembedded SQL commands easier than making direct C calls to the engine.andP;  (Forthis review, I concentrate on the embedded SQL method.)andM;Third, you can send commands to the SQL engine with Clipper UDFs in a specialQuadbase SQL library.andM;Quadbase SQL also comes with two bonuses.andM;You get the ability to embed what Quadbase calls &quot;display system&quot; commands.andO;These basically implement dBASE language screen commands like CLEAR ALL, @...andP;  SAY ...andP;  GET (with the full range of PICTURE and RANGE clauses), @...andO;SAY ...andP;  TO for box drawing, READ, etc.andP;  DBASE programmers trying to make thetransition to C may find these useful in easing the effort.andP;  In addition, thepackage includes a toolbox that lets you embed commands to create cascadedpop-up menu structures, user dialog windows (such as the one for SELLINK, aQuadbase SQL utility), browse screens, and interfaces to the dQUERY reportwriter.andP;  You can directly call the C functions that implement the displaysystem and toolbox features.andM;When you buy Quadbase SQL, You automatically get dQUERY, an interactive, SQLquery processor (see Manju Bewtra's review in the November 1988 issue).andO;dQUERY lets you interactively test the SQL commands you intend embed in yourC or Clipper code even before you write the code.andP;  This dramatically cutsdown debugging time, especially if a large percentage of the application'scode is SQL.andP;  Experimenting with the SQL commands inside dQUERY can give youa high level of confidence that plugging these same commands into yourapplication will obtain the results you expect.andM;To demonstrate Quadbase SQL, we'll look at a typical business problem andbuild a couple of query programs.andP;  This will illustrate the structure of a Cand Clipper program using the SQL engine interface.andP;  Along the way, I'lloffer examples of the display system and toolbox commands.andM;What you getandM;The product comes on 5 1/4-inch disks-three for Quadbase SQL and three fordQUERY.andP;  Although they're separate products, Quadbase advises you to installdQUERY before installing Quadbase SQL.andP;  The embedded SQL command preprocessorESQL aborts if you don't, complaining that theandM;Quadbase environment has not been defined.&quot; An important DOS environmentvariable, required by Quadbase SQL, is set during the installation of dQUERY.andO;The dQUERY installation inserts the command QUADBASE=C:\QUADBASE (or yourspecific path if you deviate from the default) in the AUTOEXEC.BAT to avoidthis problem, but if you don't look at the dQUERY manual first, you'd be leftscratching your head.andP;  Interestingly, Quadbase SQL doesn't include aninstallation disk.andP;  You've got to use the dQUERY install disk, although the&quot;Installation Guide&quot; in the manual doesn't mention this.andM;Currently, Quadbase supports the Microsoft C 5.x and Clipper Summer '87compilers.andP;  I mention this now, because you must also make sure the MicrosoftC compiler is installed properly for using either the C or Clipper QuadbaseSQL interfaces.andP;  According to the company, other C compilers will soon besupported.andP;  In fact, Quadbase has everything working with Turbo C 1.5internally and is now testing 2.0.andM;The total hard disk requirements for the combined Quadbase SQL and dQUERYinstallation is around 2.3M.andP;  You can reclaim some space after the fact bydeleting files that deal only with dQUERY if you decide that dQUERY isn'tyour cup of tea.andM;You'll find several sample programs on the disk  to guide you along as youattempt to code your Quadbase SQL programs.andP;  You can immediately compile andexecute them to understand how they work.andP;  You're also given sample databasesto be used by the programs.andM;FeaturesandM;First and foremost, Quadbase SQL is an access method for C and Clipperprogrammers who need to use SQL to manipulate dBASE databases.andP;  It does thisby providing library routines that act as an interface to the QuadbaseRelational Database Manager, a true database manager in its own right.andP;  ThisRDBMS is the prime ingredient in dQUERY.andP;  The embedded commands you pass tothe SQL engine are of two varieties: executable and declarative.andP;  Within theexecutable group there are three classes of commands: data manipulation(DML), data definition (DDL), and data control (DCL).andM;The Quadbase SQL engine supports referential integrity.andP;  This ensuresconsistency after certain update operations.andP;  For example, you want a user todelete a customer record if there are outstanding transaction records forthat customer.andP;  Quad-base SQL solves this problem by allowing you to specifyacceptable operations and what compensating operations should be performed.andO;For example, you can specify that deleting a customer record will have acascading&quot; effect, deleting all transaction records too.andP;  Or, you may wish torestrict&quot; the deletion to the case where there are no matching records.andP;  Theappropriate actions are specified by extensions to the SQL CREATE TABLEstatement, using the PRIMARY KEY and FOREIGN KEY clauses.andM;All embedded SQL commands must begin with the EXEC SQL prefix.andP;  This enablesthe preprocessor, ESQL, to easily identify them when it converts the SQLcommands to native C code.andM;All DBASE field types, including memo fields, are supported.andM;The C program in Listing 1 is a modification of one of several included onthe Quadbase SQL disks.andP;  In it I implement a simple query screen to displaymovie record information for a video store information system, an applicationI use as a class project for a DBASE programming course I teach at UCLA.andP;  Theuser enters a movie number and the result includes the movie name and thecurrent quantity on hand.andM;The program begins with the BEGIN DECLARE SECTION, which allows you to definehost variables.andP;  This is a C variable preceded by a colon that is used topass data between the host language and the SQL engine.andP;  A host variable canbe either simple, representing a single value, or complex, representing awhole database structure.andP;  SQL commands can reference host variables as I'llshow.andP;  In this example, I define a table called MOVIE.andP;  This table isactually a DBASE database named MOVIE.DBF with the structure seen in Fig.andP;  1.andO;Fig.andP;  1 also includes two additional databases, TXN.DBF and CUSTOMER.DBF,which I'll use in later examples.andP;  The BASED ON clause defines a complex hostvariable that maps the entire structure for MOVIE.andP;  For example, the hostvariables: movie.item-no, movie.descr, etc.andP;  are created.andM;Figure 1-The database structures for our sample Quadbase SOL applicationsandM;Structure for database: C:movie.dbfandM;Number of data records:             8andM;Date of last update        :  1/08/90andM;Field   Field Name     Type          Width     DecandM;1  ITEM_NO        Character         5andM;2  DESCR          Character        30andM;3  QTY            Numeric           2andM;4  RENT_PR        Numeric           5       2andM;5  PURCH_PR       Numeric           6       2andM;6  SUPP_NO        Character         4andM;7  TOTALINV       Numeric           2andM;** Total **                            55andM;Structure for database: C:txn.dbfandM;Number of data records:        18andM;Date of last update     :01/08/90andM;Field   Field Name  Type        Width   DecandM;1  TYPE        Character       1andM;2  CUST_NO     Character       7andM;3  DATE_OUT    Date            8andM;4  DATE_IN     Date            8andM;5  ITEM NO     Character       5andM;6  QTY         Numeric         3andM;7  RATE        Numeric         5     2andM;8  TOTAL ANT   Numeric         7     2andM;Total **                         45andM;Structure for database: C:customer.dbfandM;Number of data records:        7andM;Date of last update     :  1/08/90andM;Field   Field Name  Type        Width    DecandM;1  CUST_NO     Character       7andM;2  NAME        Character       20andM;3  ADDR        Character       30andM;4  CITY        Character       15andM;5  ST          Character       2andM;6  ZIP         Character       10andM;7  PHONE       Character       12andM;8  CR_TYPE     Character        1andM;9  CR_NO       Character       20andM;10 EXP_DATE     Date             8andM;11 B_DATE        Date            8andM;** Total **                      134andM;Next, you use the INCLUDE SQLCA declarative to include the SQL communicationarea where feedback information, such as warning and error codes, is returnedto the program from the SQL engine.andM;Our example continues by setting up a loop to repeatedly ask for movienumbers.andP;  To do the prompting, we use the display system features such as thefamiliar DBASE command, CLEAR ALL.andP;  (Quadbase SQL's CLEAR ALL will clear thescreen, release all pending GETs and place the cursor at the home position,whereas dBASE's CLEAR ALL closes databases and releases memvars).andP;  With alldisplay system embedded commands we need the prefix EXEC DS.andP;  We can also use@ ...andP;  SAY ...andP;  GET commands to prompt the user for the required entry.andO;Notice the use of the host variable, :item_no, in the GET clause.andP;  Finally, aREAD is needed just as in dBASE to initiate the entry.andM;You open the MOVIE table with the USE TABLE MOVIE command.andP;  Next, the SQLSELECT command is performed.andP;  Here, all fields are selected with the , thequalifying field values are read into the host variable:movie, and the WHEREclause specifies the criteria based on the equality of values in the fieldMOVIE.ITEM_NO and the host variable :item-no.andP;  Last, the query results aredisplayed using the standard C PRINTF() function from the host variablecomponents, namely movie.item_no, movie.descr, and movie.rate.andM;If you saw the native C source code after the ESQL preprocessor translation,you'd see that the SQL commands would still be present but surrounded by the#if/#endifbrackets that comment them out.andP;  To eliminate the SQL commandsentirely, there's an optional command line switch for ESQL.andM;The steps you must take to obtain a stand-alone EYE file is as follows: Runthe EC file containing the embedded SQL commands through the ESQLpreprocessor.andP;  The resulting C file is used as input to the QBMSC batch file,which invokes the Microsoft C compiler with all the appropriate command lineswitches for successful compiling.andP;  Then you bring up the SELLINK selectivelink builder.andP;  This is a dialog box that lets you &quot;check off' what portionsof the library are required in a single module and only those that'll belinked into the final EXE.andP;  This selective linking results in smaller EXEs,since only those features you want will be included.andP;  SELLINK generates abatch file and LINK command file to create the EXE.andM;Listing 2 shows another sample program, this time using two tables and theconcept of a &quot;cursor.&quot; A cursor is SQL's way of transforming its set-orientedmode of operation to a more sequential way of processing records.andP;  Here weimplement a customer query that accepts a customer number and displays allmovies rented out to that customer.andP;  A transaction type &quot;O&quot; (&quot;rented out&quot;)distinguishes such records from &quot;returned&quot; transactions.andM;The program begins in a similar manner as before.andP;  In the SELECT statementfor the customer table, we see the DBASE UPPER function that performs anupper case character translation on the host variable :prompt_cust_no.andO;Quadbase SQL C programmers can use many familiar DBASE language functions.andM;Next, the program defines a cursor named display-movie that's based on theTXN table.andP;  In order to qualify, the field txn.cust_no must equal theCUSTOMER table field customer.cust_no and the txn.type must be &quot;O.&quot; The OPENstatement activates the cursor and FETCH is used to access the first recordwithin the active set.andP;  The loop with another FETCH is used to sequentiallycycle through all the records in the set.andM;The Clipper interfaceandM;Quadbase SQL also offers Clipper access to its SQL engine.andP;  Basically, theinterface is a set of user-defined functions (UDFs) that are callable from aClipper application.andP;  These UDFs reside in a special library that you specifyduring link time when generating the final EXE file.andM;Here are the UDFs included:andM;DQSEND - Send commands to the SQL engineandM;DQHV     Initialize a host variableandM;DQRFC - Set up a character receive fieldandM;DQRFNI - Set up a numeric receive fieldandM;DQRFDS - Set up a date receive fieldandM;DQRFL - Set up a logical receive fieldandM;DQRFNL -   Set up a numeric long receive fieldandM;DQRFND -   Set up a numeric double receiveandM;fieldandM;DQREAD -   Read a recordandM;DQISRCOK   - Check return codeandM;DQDELETE   - Delete current recordandM;DQUF - Set up an update fieldandM;DQCANCEL - Abort queryandM;DQEXIT - Clean up and exit programandM;Using Quadbase SQL from Clipper has some limitations you won't find in the Cinterface.andP;  First, Clipper's NTX index file format is supported for retrievalonly.andP;  If you'll be adding records or updating key fields in existingrecords, then you must stick to the DBASE standard NDX format.andP;  Also, due tothe large size of both the Quadbase SQL and Clipper runtime libraries, you'relimited to using only the non-catalog mode DML commands.andM;Listing 3 shows a simple Clipper/Quadbase SQL program to retrieve all therecords in the TXN table for a particular customer who has a movie rented out(transaction type &quot;O&quot;).andP;  This query is a simplified version of the C-basedembedded SQL version shown in Listing 2.andM;In this example, as in the C version, you interface with the SQL engine viafunction calls (remember, this is ultimately what happens after running theESQL preprocessor).andP;  The primary function is DQSEND, which you use to passSQL commands to the engine.andP;  There are a handful of other functions availableto support DQSEND.andP;  As with C, you have the ability to define and manipulatehost language variables, in this case Clipper memvars, to &quot;communicate&quot; withthe engine.andP;  Here the memory variable MCUST_NO_E contains a user prompt andis passed to the engine as part of the WHERE clause of the SELECT statement.andM;When using the Clipper interface you must also install the Microsoft Ccompiler on your hard disk according to Clipper's requirements.andP;  For example,you can't accept the MSC 5.1 setup answer &quot;No&quot; for including the AlternateMath library.andP;  Clipper needs this library, LLIBCA.LIB, as does Quadbase SQL(after all, the Quadbase SQL Clipper UDFs are written in C).andP;  Unfortunately,the Quadbase SQL manual doesn't specifically point this out; it only makes apassing reference to the fact that this library is required when linking aClipper application that makes Quadbase SQL calls.andP;  If you install MicrosoftC using the defaults for building a combined large memory model library,you'll have an abundance of unresolved external references.andP;  This points outan unmentioned prerequisite for using Quadbase SQL with Clipper: You shouldalready be intimately familiar with the C language interface to Clipper.andO;Once that's under your belt, gaining SQL access to standard DBF files frominside Clipper is effortless.andM;PerformanceandM;I found no surprises in my speed tests of Quadbase SQL.andP;  You've probablyheard that, in general, SQL engines are notoriously slow compared torecord-oriented systems.andP;  IBM encountered reluctance from its mainframe usersas it pushed DB2 in favor of IMS several years ago, a reaction partly due todecreases in performance.andP;  Table 1 shows the results of two simpleperformance tests with Quadbase SQL against several other databasecontenders.andP;  I called the database used in the tests TRADES.DBF.andP;  It had 22fields of character and numeric types and a record length of 118 bytes.andP;  Itheld 28,827 records and was around 3.4M in size.andM;I ran the tests using a Dell System 220 286 running at 20MHz, with 1M of RAMand a 40M hard disk.andP;  In the first test, I indexed on the character field,SYMBOL (length 10).andP;  In DBASE, the command to index is:andM;INDEX ON SYMBOL TO TRADESandM;In SQL the command was: CREATE INDEX trades ON TRADES (SYMBOL);andM;Quadbase SQL actually generates a DBASE format NDX file here.andP;  In the Clippertest, I used the NTX index format.andM;In the second test, I performed a global replace to update a numeric fieldnamed HIGH with HIGH * 1.05.andP;  In dBASE the command was:andM;REPLACE ALL HIGH WITH HIGH 1.05andM;In SQL the command was:andM;UPDATE TRADES SET HIGH = HIGH * 1.05;andM;These timing tests are obviously not exhaustive, but they do give a flavor ofwhat to expect.andP;  Although it's difficult to draw hard conclusions from theresults, if Quadbase SQL performs this slowly in simple tests, one wondershow it would do with a series of complex SQL subqueries.andM;Table 1-Timing tests in minutes:secondsandM;INDEX              REPLACEandM;FoxPro 1.0              :44                    :58andM;dBASE III PLUS 1.1     3:42                   9:20andM;Quadbase SQL 1.0       3:35                  11:45andM;dBASE IV 1.0           1:28                   2:09andM;Clipper Summer  87     2:03                   2:20andM;Problem areas and little touchesandM;If there's one thing Quadbase SQL definitely lacks, it's informative errormessages.andP;  Throughout my testing, I encountered a variety of them, and mostweren't very informative.andP;  Usually I could figure out what I'd done wrong,but in several cases it took a call to technical support to get an answer.andO;To make matters worse, the documentation doesn't include a table or appendixwith all possible error messages.andP;  This can make debugging a realhit-and-miss effort.andM;While I'm on the subject, the user's manual also has problems.andP;  For example,the installation guide could be expanded a bit.andP;  The section describing theSELLINK selective linker needs a cross-reference section telling the userwhich box to check based on what functions were used in the application.andP;  Atable defining the dBASE functions you can use in Quadbase SQL commands issorely lacking in the manual.andP;  Finally, it desperately needs a bigger index.andM;On the other hand, the user's manual is organized just the way you'd hope:installation, embedded access, C function access, Clipper interface, etc.andO;Also, examples abound.andP;  Last, the SQL primer section of the manual is notonly excellent but also very useful for customers who know they want to getinto SQL but don't know where to start.andM;I found Quadbase's technical support staff quite helpful.andP;  I called them manytimes to ask questions and to report problems in the manual.andP;  Each time I wasmet with enthusiasm and genuine concern.andP;  I always received immediate, expertassistance.andM;My conclusionsandM;I consider Quadbase SQL one of those excellent products that fills a void inthe SQL market.andP;  It requires Turbo C compatibility, some improvements in themanual, better error checking (or a list of errors), and a bit of speed-up inperformance.andM;The Quadbase SQL interfaces are easy to integrate into an application, andthe SQL engine provides a solid base  to become productive with SQL.andP;  Whatcould be easier than extending the C language with embedded SQL commands andClipper with UDFs? If your applications require SQL and you understand how touse C, Quadbase SQL and dQUERY provide a very powerful one-two punch.andP;  ThecostandM;Quadbase SQL, including dQUERY, costs $795.andP;  The company also offers a demo(1,000 records maximum) version for $99, which you can use as a credit if youpurchase the real system.andP;  Quadbase Systems, Inc. is located at 790 LucerneDrive, Suite 51, Sunnyvale, Calif.andP;  94086, (408) 738-6989.andM;Dan D. Gutierrez is President of The AMULET Consulting Group, a LosAngeles-based microcomputer consulting firm specializing in DBASE languageprogramming.andP;  in addition, Dan teaches DBASE programming for UCLA Extension.andO;He can be contacted on the Data Based Advisor Readers Exchange BBS, (619)270-2042, at (213) 479-4877, or on CompuServe (73317,646).andO;</TEXT></DOC>
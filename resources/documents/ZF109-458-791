<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF109-458-791  </DOCNO><DOCID>09 458 791.andM;</DOCID><JOURNAL>PC-Computing  Oct 1990 v3 n10 p160(8)* Full Text COPYRIGHT Ziff-Davis Publishing Co. 1990.andM;</JOURNAL><TITLE>Discover 1-2-3's database dimension. (using database capabilitiesin Lotus 1-2-3) (tutorial)</TITLE><AUTHOR>Gasteiger, Daniel.andM;</AUTHOR><SUMMARY>Aguide to using the database capabilities built into the Lotus1-2-3 spreadsheet package is presented.andP;  A 1-2-3 databaseresembles a 1-2-3 worksheet but places its information in aspecific format.andP;  1-2-3 can sort records, find records by labelusing Criterion ranges or wildcard commands, and search forrecords by formula values.andP;  Special commands let users extractparticular records or sort using multiple criteria.andP;  Techniquesfor sorting, searching and deleting records are discussed.andP;  Thenew 1-2-3 3.0 and 1-2-3/G versions of the Lotus package addspecial features such as three-dimensional tables and can use'computed columns' in their Output ranges.andM;</SUMMARY><DESCRIPT>Company:   Lotus Development Corp. (products).andO;Ticker:    LOTS.andO;Product:   Lotus 1-2-3 (Spreadsheet software) (usage).andO;Topic:     TutorialSpreadsheetsSoftware packagesData base management systems.andM;</DESCRIPT><TEXT>Here's a short quiz.andP;  The world's most popular PC database is:andM;(a) dBASEandM;(b) ParadoxandM;(c) R:BaseandM;(d) None of the above.andM;The answer is (d), none of the above.andP;  At last count, more than 6 millioncopies of Lotus 1-2-3 had been sold-far more than any of the databases listedhere.andP;  And many 1-2-3 users needn't go further than their nearest worksheetto find a capable, easy-to-use database.andM;No, you won't get fancy relational features or other high-end tools in a1-2-3 database.andP;  But you will get some big advantages:andM;1.andP;  You can search and extract records quickly from data in RAM.andM;2.andP;  You don't have to leave the familiar 1-2-3 interface.andM;3.andP;  You can easily build spreadsheet reports based upon 1-2-3 databaseinformation.andM;Why not work with what you've got? In many cases, you'll find that 1-2-3 isall the database you need.andM;A REGULATION 1-2-3 DATABASEandM;At its simplest, a database is any list of information.andP;  A 1-2-3 databaselooks much like a 1-2-3 worksheet, with the information falling into aspecific format: At the top of the database is a row containing field names,each record falls within a single row of the worksheet, and each field fallswithin a single column (see the illustration at right).andM;Our sample database is a five-field employee database with seven records.andO;The top row is the field header containing field names.andP;  Each remaining rowcontains a record with a given employee's last name, first name, date ofhire, department and salary.andP;  Each record can have an entry in any or allfields.andM;When setting up a 1-2-3 database, be sure to enter dates using the @Datefunction.andP;  If you enter the dates as labels (as many 1-2-3 users do), 1-2-3won't be able to search and sort on those fields.andP;  The dates in our Date ofHire field were entered using @Date; cells C11..C17 were formatted with the/Range Format Date 1 command.andM;By the way, be careful how you go about clearing the contents of a cell.andP;  Onepopular method of &quot;erasing&quot; a cell is to position the cell pointer in it,press the spacebar and press Enter.andP;  Don't do it.andP;  This makes the cell appearblank, but creates a space character, which your computer doesn't distinguishfrom visible characters.andP;  To your machine, you might just as well havepressed the S key and Enter.andM;Use the /Range Erase command to erase a cell.andP;  To clear a single cellquickly, position the cell pointer in it, then select /Range Erase and pressEnter.andP;  The process seems like a lot of keystrokes, but if you issue thecommands simply by typing /RE, you'll be able to blank the cell as quickly asif you had done it with a space.andM;Most of 1-2-3's database capabilities are under the /Data menu.andP;  Followingare procedures for sorting, searching, extracting and deleting records from a1-2-3 database.andM;SORT RECORDSandM;One database feature that almost anyone can use immediately is a command tosort records into alphabetical or numerical order.andM;Start by specifying the data you wish to sort, that is, the Data Range.andP;  Dothis by selecting /Data Sort Data-Range and indicating which records are tobe sorted.andP;  For our example, we'll sort the entire database, range A11..E17.andO;(Don't include the field name header when sorting records.) In fact, only inrare cases would you want the range to be anything other than the entiredatabase.andP;  If we specified range A11..A17 (we are sorting by last name, afterall), 1-2-3 would rearrange only the last names, and they would no longer bematched with their corresponding records.andM;Now you must tell 1-2-3 which field you wish to alphabetize-in other words,you must specify the &quot;key field.&quot; For our sort, the last-name field is thekey field.andP;  Select Primary-Key from the Sort menu and indicate cell All;there's no need to indicate the entire column of entries.andP;  The program popsup a question: &quot;A or D?&quot; Specify whether you wish to sort in ascending ordescending order.andM;For alphabetizing, sort in ascending order, from A to Z. If you're sorting ona currency field, you're more likely to need descending order, so the recordsappear in order of decreasing value.andP;  After you select A or D and pressEnter, the Sort menu will reappear.andP;  Select Go; 1-2-3 rearranges the recordsand returns to Ready mode.andM;Once you specify a data range in a 1-2-3 database, it remains in effect untilyou change it.andP;  For subsequent sorts of the same database, therefore, you cango straight to the key fields.andM;You can specify a secondary key field in addition to the primary key.andP;  Wecould, for instance, sort the employee records in our sample database bydepartment, with the highest-paid employees at the top of each departmentlist.andP;  The primary key would be the department, sorted in ascending order(alphabetically); the secondary key would be the salary field, sorted indescending order.andP;  Given these two keys, the program would arrange therecords with the development department on top, the marketing departmentsecond and the sales department last.andP;  Within each department group, theemployees would fall in order from highest to lowest salary.andM;FIND RECORDS BY LABELandM;Sorting worksheet data is convenient, but it's just a start.andP;  Other /Datamenu commands let you search a database for specific information, copyselected records or portions of records into a table in a separate area ofthe worksheet and delete unwanted records.andP;  You control each of theseprocedures through the Criterion range (see the opening illustration).andM;A Criterion range is an area of your worksheet that 1-2-3 refers to when itprocesses queries against the database; it's similar to a regular database'squery-by-example facility.andP;  First, choose a blank range in your worksheet forthe Criterion range.andP;  Put that range either below or to the right of your1-2-3 database so that it's open-ended at the bottom and can hold as manyrecords as necessary.andM;In the first row of the range you've set aside, enter field names from yourdatabase-spell them exactly as they appear in your database header.andP;  Youdon't need to include the names of any fields you won't be checking.andP;  It'swise, however, to include all the fields in your database so that you caneasily change the field on which you're keying a search.andM;In the rows following the field names, enter expressions describing therecords you wish to find, extract or delete.andM;For a simple find operation-say, to look for all records with a certain lastname-simply type the label to be matched below the field name in theCriterion range (it's OK to leave the other fields blank); for instance, typeYu under the field name Last in cell A21.andM;The first step in a find operation is identifying the Input range-the rangeof data that 1-2-3 will search.andP;  The Input range must include all thedatabase records as well as the field name header.andP;  For our example, weselect the /Data Query Input command and indicate the range A10..E17.andM;Select Criterion from the Query menu, and highlight the field name and thelabel or value you're looking for.andP;  In our example, we'll make A20..E21 theCriterion range.andP;  Select Find, and 1-2-3 goes into the database to retrievethe first matching record.andM;In recent releases of 1-2-3 (starting with 2.0), you can edit any part of acurrently &quot;found&quot; record.andP;  Put the cursor on the field you wish to change,using the right and left arrow keys to navigate.andP;  Typing a new entry andpressing Enter replaces the entry in the current field.andP;  You can also edit anexisting entry by pressing the F2 Edit key and making changes as you would inspreadsheet edit mode.andM;If more than one record in your database matches the label you're lookingfor, you can move between them with the up and down arrow keys.andP;  When you'vefinished examining or editing the found records, press Enter to end the /DataQuery Find operation.andM;Criterion Wildcards: If you put a label in the criterion cell, the programwill match any identical label in the corresponding database field.andO;Sometimes, though, your needs won't be that specific.andP;  To broaden yoursearch, you can use wildcards in Criterion ranges that contain labels.andM;Wildcards in 1-2-3 are similar to those used in DOS and in many otherapplications.andP;  Use an asterisk (*) to match a sequence of characters of anylength-for example, the criterion F* matches the entries Fred, Finderman andFarnsworth.andP;  The question mark (?) matches any single character in a labelfield, so the criterion b??k matches the labels book, bark and beak.andP;  Thethird label wildcard is the tilde (~).andP;  If it precedes a criterion label, itmeans &quot;Match any label but this one.&quot; For example, the criterion ~ dev in theDepartment field of our example matches the entries Mark, Devel and Sales.andM;You can combine wildcards to create even more specific conditions fordatabase finds.andP;  For example, the criterion ~ dev* tells the program, &quot;Selectall records that don't begin with Dev.&quot;andM;SEARCH BY VALUEandM;If you're looking for records on the basis of values rather than labels, usecriterion formulas.andP;  In most cases, a criterion formula identifies acondition that a value must meet before 1-2-3 considers it a match.andO;Criterion formulas can find values greater than, less than or equal to acertain amount, and they can be joined with the logical operators And, Or andNot.andM;In our employee database, we'll use a criterion formula to search foreveryone whose salary is greater than $30,000.andM;As with the other Criterion ranges, the point is to enter the condition youwant to match into the cell below the field name you want searched.andP;  So,putting +E11[greater than] 30000 into cell E21 will find employees withsalaries above $30,000.andM;The formula literally means &quot;The value in cell E11 is greater than 30,000.&quot;andO;Select /Data Query Find, and 1-2-3 highlights the first record in thedatabase that meets that condition.andP;  Use the up and down arrow keys to reachother matching records.andP;  Once again, you can edit found records.andM;When you issue the Find command, 1-2-3 evaluates the criterion formula forthe current cell-in this case, for E11.andP;  If the statement is true, theformula returns 1; if the statement is false, it returns 0.andP;  In the meantime,1-2-3 evaluates the formula for the cell directly below the referencedformula, E12.andP;  If the statement +E12[greater than] 30000 returns 1, thesecond database record is also a match.andP;  The Find command works its way downthe column, substituting each value it finds into the criterion formula toestablish which entries make the expression true and which do not.andP;  The trueexpressions are marked as matching records.andM;To use logical operators And, Or and Not with criterion formulas, simply jointhe formulas with #AND#, #OR# or #NOT#.andP;  The following formula in E21 findsrecords of employees who earn between $30,000 and  60,000: +E11[greater than]30000#AND#E11[less than]60000.andP;  The logical operator #AND# means that, for arecord to match, it must satisfy both the first expression, +E11[greaterthan]30000, and the second expression, +E11[less than]60000.andP;  #OR# lets youfind records that satisfy one or both criteria; #NOT# finds records thatsatisfy the first criterion but not the second.andM;There's no limit to the types of criterion formulas you can create.andP;  Acriterion formula can resolve numerical equations, perform stringmanipulations and even call on special worksheet-related functions such as@ROWS and @VLOOKUP The rules for creating a criterion formula are simple:andM;1.andP;  The formula should always refer to the first data cell within theappropriate database field.andM;2.andP;  The formula should resolve to 0 or ERR (which in a Find operation isequivalent to 0) for non-matching records and to 1 for matching records.andM;MULTIPLE CRITERIAandM;Sometimes a single criterion formula isn't enough to pinpoint the databaserecords you wish to find.andP;  For example, suppose you want to find employeeswho were hired before 1985 and make more than  50,000.andP;  A single formulacould find records that meet one of the criteria, and you could scan thoserecords for the ones that meet the second.andP;  But it's more efficient to usetwo formulas.andM;The first formula, to find employees hired before 1985, would be +C11[lessthan]@DATE(85,1,1), entered into cell C21, meaning, &quot;Select all records witha date of hire before January 1, 1985.&quot; The second formula, to find employeeswho make more than $50,000, would be +E11[greater than]50000 in cell E21.andO;Lotus 1-2-3 considers both formulas as it searches the database for matchingrecords during a Query Find operation.andM;Suppose the problem were stated a little differently.andP;  What if you need tolocate all employees who were hired before 1985 or who are making less than$25,000? For these criteria, you need to expand the Criterion range by onerow.andP;  The formula +C11[less than]@DATE(85,1,1) remains in cell C21.andP;  Move thecell pointer to cell E22, not to E21, and enter +E11[less than]25000.andP;  Thisselects records of all employees who make less than $25,000.andM;The program will use both criteria only if you expand the Criterion range toinclude the entry in row 22.andP;  Do this by selecting /Data Query Criterion,pressing the down arrow key and pressing Enter.andP;  Then select Find; 1-2-3finds all records that meet either of the criteria you've set.andP;  Press Enterand select Quit when you've finished browsing the found records.andM;Once you've expanded a Criterion range to create this either-or condition, becareful how you use the Data Query commands.andP;  Suppose you want to do adatabase query that relies on a single criterion after expanding the rangefrom two to three rows.andP;  Erasing the formulas in the third row of theCriterion range and entering your new criterion in the second row won't findthe desired records; you'll still have a blank criterion record in the thirdrow, which will match every database record.andP;  If you wish to use only one rowof criterion cells, you must use the /Data Query Criterion command again toshrink the range back to two rows.andM;EXTRACT RECORDSandM;Finding records within the database is useful, but sometimes you want to usethe found information elsewhere in the spreadsheet.andP;  The /Data Query Extractcommand creates a subset of your database that meets the conditions youspecify.andM;The Extract command copies records, or specific held entries, from thedatabase to an output area that you establish in the worksheet.andP;  Tell 1-2-3which fields to copy by entering field headers in the first row of the Outputrange (see the opening illustration).andP;  Then establish selection criteria inthe Criterion range.andP;  Properly devised, an Output range can be the key tomaking reports from your 1-2-3 database.andM;Create an area for your Output range that is large enough to accommodate therecords you extract without overlapping your Criterion or Inputranges-placing the Output range to the right of or below the Criterion rangeis a good idea.andP;  The field names at the top of the Output range needn't be inthe same order as those in the database, nor do you need to use all thefields.andP;  In fact, you can insert blank columns among the field headers in anOutput range.andP;  The only restriction is that you can't use any field name morethan once within the same Output range.andM;To extract complete records-that is, to make a subsidiary database-simply useall the field names within the Output range.andM;To extract the records found in the previous example, first set the Outputrange by issuing the /Data Query Output command and indicating A30..E37 asthe Output range (it's a good idea to make the Output range as large as thedatabase itself, so it will always be large enough to hold the extractedrecords).andP;  Select Extract from the Data Query menu to copy all files meetingthose criteria into the Output range.andM;Each time you select/Data Query Extract, 1-2-3 erases any data left in theOutput range from before and copies records that match the current criteria.andO;If more records match the criteria than can fit in the Output range, 1-2-3will display the error message &quot;Too many records for Output range.&quot; Press Escto clear the error, then increase the number of rows in the Output range andreissue the /Data Query Extract command.andM;Avoid the &quot;range full&quot; error message by assigning an Output range thatcontains as many rows as there are records in your database.andP;  You can alsoassign a single row-that is, just the field name header-as the Output range,and 1-2-3 will use as many rows as needed to store extracted records.andP;  Forexample, rather than assign A30..E37 as the Output range for this exercise,you could have assigned A30..E30.andM;When you use single-row Output ranges, make absolutely certain that there isno data below the range you've chosen.andP;  As stated earlier, when you select/Data Query Extract, 1-2-3 erases the entire output area before copying thematching records from the database.andP;  With a single-row Output range, 1-2-3considers all rows beneath the range to be the output area; any data storedthere will vanish from the worksheet when you select /Data Query Extract.andM;Survey Database Categories Sometimes it's important to get a quick overviewof the categories of information in a database.andP;  This can be difficult in adatabase that contains several hundred or several thousand records.andO;Fortunately, the /Data Query Unique command can cut through the clutter.andM;It works just as the Extract command does, except that it eliminatesduplicate entries from those it copies from the database.andP;  The Query Uniquecommand won't find duplicate records in our sample database-each record isunique.andP;  But what if it had several hundred records-how could we uncover allthe labels in the Dept field?andM;The trick is to extract entries from only the Dept field.andP;  To see how theUnique command clarifies the contents of the database, erase the criteriafrom the Criterion.andP;  range.andP;  Then, create a new Output range.andP;  In this case,enter the label Dept into A30.andM;Next, select /Data Query Output, and indicate A30 as the Output range.andO;Finally, select Unique from the Query menu and hit Enter.andP;  The resulting listbeginning in A31 reveals that the database contains four labels in the Deptfield: Mark, Devel, Dev and Sales.andM;DELETE UNWANTED RECORDSandM;Sometimes you want to remove records that meet certain conditions.andP;  Perhapsan employee has left the company, or you've discontinued a product line andwant to drop all listings related to it from your inventory database.andP;  The/Data Query Delete command can handle the task for you.andM;After you establish selection criteria, select /Data Query Delete.andP;  A menuappears, asking you to confirm that you want to delete the records.andP;  If youselect Delete, 1-2-3 removes the entries from the database and eliminates theblank rows.andP;  The Input range setting changes to reflect the reduced size ofthe database.andM;While 1-2-3 forces you to consider whether you really want to delete matchingdatabase records, it doesn't preview the records for you.andP;  Get in the habitof testing criteria for the Delete command by first issuing a /Data QueryFind command and scanning the doomed records.andP;  Otherwise, you may end uplosing records you'd rather keep.andM;To eliminate records of employees in the Development group from our sampledatabase, enter the label dev* into cell D21 of the Criterion range.andP;  Makesure the range is only two rows deep by selecting /Data Query Criterion;adjust the range if necessary to A20..E21.andP;  Select the Find command.andM;The program highlights the first matching record; use the up and down arrowkeys to reach all matching records.andP;  Once you've confirmed that you wish todelete them, press Return to complete the Find command.andP;  Then select Delete,and select Delete from the confirmation menu.andP;  When you return to theworksheet, you'll find the Development department entries eliminated and thedatabase reduced in size.andM;FOR RELEASE 3 AND 1-2-3/GandM;While everything described in this article works in all releases of 1-2-3(even Release 1A), there are differences (and advantages) to working in 1-2-3Release 3 and 1-2-3/G.andM;For example, a 3-D worksheet may include several tables in the database Inputrange.andP;  A table in a 3-D worksheet is equivalent to a database: a rangewithin a single sheet that contains field headers and records.andP;  When youissue /Data Query Extract, you can create &quot;join formulas&quot; in the Criterionrange that combine information from fields of both tables in the Outputrange.andM;Release 3 and 1-2-3/G let you use computed columns&quot; in your Output ranges;they use a formula rather than a label as a field header.andP;  Using the sampledatabase, you might enter the formula +SALARY*1.055 as a field header in anOutput range.andP;  When you select /Data Query Extract, 1-2-3 copies each recordthat matches the criteria you've established.andP;  It multiplies each extractedsalary by 1.055 and enters the result in the computed output column.andM;Many more database features are unique to 1-2-3 Release 3 and 1-2-3/ G.andO;Performing queries across worksheet files is one; accessing disk-based ornetwork-based databases with file formats other than worksheets is another.andM;Daniel Gasteiger is a contributing editor to PC/Computing.andO;</TEXT></DOC>
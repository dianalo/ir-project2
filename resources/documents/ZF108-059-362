<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF108-059-362  </DOCNO><DOCID>08 059 362.andM;</DOCID><JOURNAL>PC Magazine  Jan 30 1990 v9 n2 p301(6)* Full Text COPYRIGHT Ziff-Davis Publishing Co. 1990.andM;</JOURNAL><TITLE>Spreadsheets. (second part of a technical discussion of Lotus1-2-3 3.0) (column)</TITLE><AUTHOR>Stinson, Craig.andM;</AUTHOR><SUMMARY>Lotus 1-2-3 3.0 includes significantly enhance databasefunctionality.andP;  The most-far-reaching addition to the databasefunction is /Data external.andP;  This command lets the user createconnections between 1-2-3 spreadsheets and files managed by dBaseor other true database programs.andP;  The user may then handle thedatabase as if it were a regular 1-2-3 data table.andP;  Using /DataExternal requires the installation of a driver for the externaldatabase program.andP;  Lotus 1-2-3 3.0 is not a good choice for userswho wish to create boardroom presentations.andP;  Lotus 1-2-3/G, whichis due to be shipped in mid 1990, may be a better choice.andP;  Thosealready using a group of release 2.0 add-ins may also lose morethan they gain by moving to release 3.0.andM;</SUMMARY><DESCRIPT>Product:   Lotus 1-2-3 3.0 (Spreadsheet software) (computer programs).andO;Topic:     TutorialSpreadsheetsData bases.andO;Feature:   illustrationtable.andO;Caption:   A sample table-definition file. (table)A sample personnel table. (table)Refining an analysis using nonaggregate fields. (table)andM;</DESCRIPT><TEXT>Spreadsheets Last issue, we began discussing Lotus 1-2-3, Release 3.andP;  I'dlike to conclude that discussion in this installment.andM;CONNECT TO EXTERNAL DATABASESandM;Release 3 doesn't merely add a third dimension to 1-2-3.andP;  Its databasecapabilities have also been significantly enhanced.andM;/Data External is perhaps the most far-reaching but certainly not the onlymajor addition to the database wing of 1-2-3.andP;  This command allows you toestablish live connections between 1-2-3 worksheets and files managed underdBASE or other true database products.andP;  Once you have established theconnection between the worksheet and an external database, you can interactwith that database as though it were an ordinary 1-2-3 data table.andM;To use /Data External you must install a driver for your external databaseprogram.andP;  Lotus supplies a sample driver, named SAMPLE, for dBASE III.andP;  Itworks only with dBASE III, not with II or IV, and it does not implement allthe features inherent in /Data External.andP;  But it will get you acquainted withthe new possibilities.andP;  (By the time you read this, third-party drivers forother programs may be available.)andM;Typically, the first thing you'll do with Data External is establish a linkwith an external table via/Data External Use.andP;  This procedure assigns a rangename alias to the external table.andP;  Thereafter, you can use the assigned rangename as the input argument for any database statistical function or the inputrange for /Data Query Find, /Data Query Extract, or /Data Query Unique.andP;  Ifyour driver allows (the SAMPLE driver does not), you can also send a commandto the database program using /Data External Other Command, or you can updateexternal records with /Data Query Modify Replace or /Data Query ModifyInsert.andM;To establish a link to an external table, enter /Data External Use.andP;  Thensupply 1-2-3 with the name of the database driver, a &quot;database name,&quot; a tablename, and the range name you want to assign as alias for the external table.andO;1-2-3 will prompt and present default values for each item.andP;  If a password isattached to the table, the external database driver will prompt you for thepassword.andM;The database name is not the title of your external DBMS program; it's thefull path of the subdirectory containing the table to which you want toconnect.andP;  Release 3's terminology assumes that you keep all related tables ina common subdirectory and that the collection of tables in that directoryconstitutes a &quot;database.&quot;andP;  If you prefer to see what you're working with (andyou have enough RAM), you can easily bring all records from an external tableinto memory.andM;To do this, use /Data External Use to set up the external link.andP;  Then use/Data External List Fields to generate a table in 1-2-3 that defines theexternal table.andP;  For a simple payroll history file (we'll call itPAYHISTORY), such a table might look like the one shown in Figure 1.andM;The first three columns in this table report the field name, the data type,and the width of each field.andP;  (For numeric fields, the numbers before andafter the comma are the width of the field to the left and right of thedecimal point.)andP;  The last three columns report alternate field headings(Federal Income Tax or FIT, for instance), field descriptions, andfield-creation strings.andP;  The last three are not used by the SAMPLE driver,but your external driver may use them.andM;Once you have the field headings listed, you can use /Range Transpose to linethem up horizontally.andP;  Set up a criteria range with the horizontally arrayedheadings and a blank row below them, as well as an output range with anothercopy of the headings.andP;  Then use /Data Query Extract to create an internaltable consisting of all records contained in the external table.andM;If your database driver permits, you can reverse this process and therebycreate a new table on-disk for use in an external DBMS program.andP;  With thisreverse process you can also copy records from 1-2-3 to that table.andP;  Theprocedure for doing this involves creating a table-definition table (similarto the one shown above for PAYHISTORY) and using the /Data External Createcommand.andM;ENHANCEMENTS TO /DATA QUERYandM;The /Data Query branch of the menu tree has been strengthened in severalways.andP;  First, there's a new /Data Query Modify command that lets you update(append or amend) records in an input range after you have performed anextract.andP;  This is particularly valuable when the input range is an externaldatabase table or an &quot;inactive&quot; 1-2-3 table (one that's not currently inmemory).andM;/Data Query Modify has four subcommands: Extract, Insert, Replace, andCancel.andP;  /Data Query Modify Extract works just like /Data Query Extract,except that when you use /DQME, 1-2-3 remembers the positions of theextracted records in the input table.andM;/Data Query Modify Replace copies records from the output range (presumablyafter you have modified them) back to the input range.andP;  /Data Query ModifyInsert gives you a way to add new records to an input range.andP;  The commandappends records from the output range to the end of the input table.andP;  &quot;Outputrange&quot; is sort of a misnomer in this situation because the records that getappended to the input range are presumably new data; they don't have to bethe result of a /Data Query Modify Extract.andM;/Data Query Modify Cancel causes /Data Query Modify to abort the modifyoperation without making any changes in the input table.andM;The other modifications in /Data Query have to do with the way queries areformulated; the effect of these changes is the creation of a system that'smore powerful and easier to use.andM;/Data Query Input now accepts multiple input ranges, enabling you to performExtracts and Finds on two or more tables simultaneously.andP;  When you want tospecify more than one input range, use/Data Query Input and type a comma (orthe current argument separator) after each input range.andP;  If you are planningto use queries that involve common field names in two or more tables, youmust assign names to each input range.andM;Criteria specification is now both easier and more powerful.andP;  To extract asubset of records based on a simple comparison of a field value to aconstant, you're no longer required to write a formula involving a dummyvalue from the first record of the database (though you may if you wish).andP;  Toget all LASTNAMEs greater than S, for example, you don't have to say +B2andgt;&quot;S&quot;.andO;It's enough to enter the label 'andgt;S under the heading LASTNAME.andM;In order to specify a range of values in a designated field, you can nowrepeat the field heading in the criteria range.andP;  For example, the followingcriteria rangeandM;LASTNAME LASTNAME andgt;S andless;TandM;will get you all surnames starting with S and no others.andP;  (In fact, if youtake this &quot;label&quot; approach, you have to repeat the heading to get ANDedcomparisons; an #AND# embedded in the label will be evaluated as text.)andM;When you do write formulas in a criteria range, you can now reference thefield names instead of first-record addresses.andP;  Release 3 creates implicitnames for each field heading.andM;A criterion formula can now include database statistical functions.andP;  Suchfunctions can reference either the same database being queried by thecriteria range or any other active, inactive, or external database.andP;  So, forexample, to extract records with salary values greater than the averagesalary for the database, you can write the criterion formula.andM;SALARY+Salaryandgt;@davg(PERSONNEL, &quot;SALARY&quot;,SELECTALL)andM;where PERSONNEL is the input range, &quot;SALARY&quot; is a reference to the salaryfield (remember, database functions can now use field names in quotes inplace of column offsets), and SELECTALL is a separate criteria range thatselects all records in PERSONNEL.andM;When you're working with two or more input tables that share some commonfield names, your criteria field headings must include the table names aswell as the field names.andP;  Use a period to separate the table name from thefield name.andP;  For example,andM;PAYHISTORY.EMPID PERSONNEL.EMPIDandM;You can perform a join operation, combining two tables on a common field tocreate a third table, by writing the criteria formulaandM;+PAYHISTORY.EMPID=PERSONNEL.EMPIDandM;orandM;+C2=F2andM;where C2 and F2 are the first-record addresses for the two EMPID fields.andM;Your output range can now include two kinds of computed fields: simplecomputed fields and aggregate fields.andP;  Here are some sample simple computedfields as they might appear in your output range:andM;+SALES*COMMISSION +SALES*.085 +SALES*$COMMISSIONandM;In the firs of these, SALES and COMMISSION are both names of fields in theinput table.andP;  In the second, SALES is an input field, and the formulamultiplies the SALES value for each extracted record by the constant .085.andO;In the third example, SALES is again an input field and $COMMISSION is anabsolute reference to a named cell outside the table.andM;Simple computed fields can use any arithmetic operators and any functionsother than @AVG, @COUNT, @MIN, @MAX, and @SUM (and their @D equivalents).andO;The formula itselt is the output field heading, so you probably want toformat it as text.andM;Aggregate fields are much more powerful than simple computed fields.andP;  Theyuse statistical functions (@AVG, @COUNT, @MIN, @MAX, and @SUM) to computeformulas based on groups of selected records.andP;  For example, suppose you areworking with a personnel table like the one shown in Figure 2.andP;  The followingoutput range gives you an idea of what you can do with aggregate formulas.andM;The records extracted to this ouput range might look like this:andM;For each location in the input table, the aggregate formulas in columns B andC compute average age and salary.andP;  You could include more &quot;nonaggregate&quot;field headings in this output range to break down the analysis further, asshown in Figure 3.andP;  And you could use a criteria range to filter the records,so that the aggregate formulas would be run against only a subset.andP;  Forexample, by puttingandM;A 1 PROFITSHARING 2 NoandM;in your criteria range, you could generate average age and salary figures forjust the non-profit-sharing employees, broken down by location.andM;OTHER DATABASE ENHANCEMENTSandM;With Release 3 you can now specify up to 255 key columns for sorting databaserecords.andP;  The /Data Sort menue doesn't actually include commands for each ofthose keys.andP;  Instead it has the usual Primary-Key ad Secondary-Key plus a newoption called Extra-Key.andP;  The Extra-Key command knows exactly how many keysyou've already specified, so if you've already named 13, it willautomatically prompt you for key number 14.andM;The /Data Table facility has been extended into the third dimension.andP;  The new/Data Table 3 command sequence in Release 3 does sensitivity analysis basedon three input variables.andP;  The result is a series of rectangular tables laidback to back on successive worksheets, with each worksheet's table testingthe third input against the first two.andM;Let's create a three-way table.andP;  Suppose you want to test the future value ofa regular series of monthly deposits, given various deposit amounts, interestrates, and terms.andP;  For the sake of simplicity, we'll assume the interest ratewill be variable 1, with values of 9%, 10%, and 11%; the deposit amounts willbe variable 2, with amounts of $100, $200, and $300; and the term will bevariable 3, with amounts of 20, 30, and 40 years.andM;To set up the table, you would start by putting variable 1 in a column andvariable 2 in a row, exactly as though you were setting up a two-way table,like this:andM;Leaving the upper-left corner cell of the table blank for the time being, youwould use /Worksheet Insert Sheet After 2 to insert two new blank sheetsbehind this one, and then copy this fledgling table into each of the newsheets.andP;  Then you would line up the values for your third variable in thecorner cell of each sheet, so the first sheet would have 20 in the upper-leftcorner, the second 30, the third 40.andM;With your variables in place, then, you would choose three cells outside thetable to serve as inputs for the three variables.andP;  And in a fourthcell--anywhere outside the table--you would write your @FV formula.andP;  If yourthree input cells were B1, B2, and B3 (representing interest rate, monthlydeposit amount, and term in years), your formula would readandM;@FV(B2,B1/12,B3*12)andM;Tn you use the /Data Table 3 command and supply the table location, theformula location, and the location of each input variable.andP;  1-2-3 does therest.andM;NEW GRAPHING FEATURESandM;Release 3 offers a host of new graphing services, including new graph types,many more customization options, the ability to use two y-axes, the abilityto print graphs without leaving 1-2-3, the ability to see a graph and itsunderlying worksheet data simultaneously, optional logarithmic scaling, andseveral welcome convenience features.andP;  These changes still don't bring 1-2-3up to parity with Microsoft Excel as a charting machine (nor will theythreaten Lotus's own GraphWriter and Freelance products); nevertheless, theyadd up to significant if not dramatic improvement.andM;The new graph types are high-low-close-open, mixed line and bar, area, andpie-bar.andP;  The HLCO graphs can be split to show daily market volumes as wellas prices.andP;  The pie-bar is implemented as a customization instead of aseparate type; use /Graph Type Features 100% to generate this kind of graph.andM;You can also rotate any graph except a pie, so that bars, for example, extendoutward from the y-axis instead of upward from x.andP;  To do this, use /GraphType Features Horizontal.andM;The text options inclue two new footnote lines (annotation below the graph)but still no floating, or unattached, text.andP;  Any text on the graph can now bekeyed to worksheet labels (and 1-2-3 maintains the references even if youmove the labels); and for any text, you may choose from eight color values,eight font values, and eight size values--all subject, of course, to thelimitations of your hardware.andM;For compatibility with a wider range of third-party software, you can nowsave graphics images in either .CGM (graphic metafile) or .PIC (standard1-2-3) format.andP;  Use /Worksheet Global Default Graph to set the default filetype, or just supply the extension of your choice when you save.andM;There are several new conveniences under /Graph.andP;  For instances, press F10from anywhere in the /Graph menu tree and you'll immediately see the effectof a customizing change without having to wander back up the tree to use theView command.andM;You can even press F10 from the worksheet without having first defined anydata ranges.andP;  Release 3 refers to this as &quot;automatic graphing.&quot;andP;  For example,if your cell pointer is located in a block of graphable data and all thegraphing data ranges are clear (that is, you've just used the menu sequence/Graph Reset Graph or you're working in a file with no define graphs), 1-2-3responds to F10 by plotting whatever lies around the cell pointer.andP;  It drawseach column as a separate data series (unless you change the default torowwise using /Worksheet Global Default Graph Rowwise), and it uses anadjacent column of labels as category text.andM;Obviously, automatic graphing works fine under some circumstances and not sofine under others.andP;  You'll need to experiment to get a feel for what it ando.andP;  (You can read the details in the Reference manual to learn how Release 3makes its &quot;automatic&quot; decisions, but going to that kind of trouble sort ofdefeats the purpose of this feature.)andM;/Graph Group lets you asign two or more data series as a single block.andP;  Aswith automatic graphing, 1-2-3 charts by columns or by rows, depending on howyou've set /Worksheet Global Default Graph.andM;/Worksheet Window Graph divides the screen into windows vertically, givingthe right side over to the current graph, as seen in Figure 4.andP;  As withordinary worksheet windowing, you control the width of this graph window bythe position of your cel pointer when you use /WWG.andP;  (This feature does notwork on some display adapters.)andM;Finally, with Release 3 you can print graphs without leaving the program andcalling PrintGraph.andP;  (See last issue's Spreadsheets column for moreinformation on printing.)andM;NEW WORKSHEET FUNCTIONSandM;The function library has been modestly expanded, so let's review it briefly:andM;* @COORD(worksheet, column, row, absolute) creates a cell address from itsarguments.andM;* @DGET (input, field, criteria) extracts a value from a database table.andP;  Thecriteria argument must be a valid criteria range, but the field argument--inthis as well as all other database functions--can be either a column offsetor a field name enclosed in quotes.andP;  The @DGET arguments must generate asingle unique value or else the function returns ERR.andM;* @DQUERY sends a command to an external database management program,provided you have installed a driver for that program.andP;  (See the discussionon connecting to external databases, above.)andM;* @DSTS, @DVARS, @STDS, and @VARS calculate sample standard deviations andvariances.andP;  Previous versions of 1-2-3 offered only the population functions.andM;* @D360 (start date, end date) returns the number of days elapsed between itsarguments, based on an artificial year of 12 30-day months.andM;* @INFO(attribute) returns one of the following: the current directory, thecurrent mode, the number of files in memory, the cell-pointer location at thestart of a 1-2-3 session, the current recalc mode, the amount of memory nowavailable, the total amount of memory available to 1-2-3 (including memory inuse), the name of the operating system, the version number of the operatingsystem, the return code generated by the most recent operating system commandmade during the current 1-2-3 session, or the release number of the 1-2-3product being used.andM;* @ISRANGE(string) returns a 1 if its argument is defined range name and a 0if it is not.andM;* @SHEETS(range) returns the number of worksheets encompassed by itsargument.andM;* @SUMPRODUCT(list) takes as its argument two or more ranges of equal sizeand shape.andP;  The function mutiplies together the first value in each range,the second value in each range, and so on--then returns the total of theproducts.andM;* @TODAY retruns @INT@NOW).andP;  The function has been reinstated in Release 3,after having been dropped from Release 2.andM;* @VDB(cost, salvage, life, start period, end period, [depreciation factor][switch]) lets you fine-tune a double-declining-balance decreciation scheduleand make the schedule switch to straight line when the straight-linecalculation becomes greater than the declining-balance calculation.andM;FORMATTING OPTIONSandM;Release 3 offers several handy new options on both the/Worksheet GlobalFormat and /Range Format menus.andP;  One of them, automatic formating, has thepotential to change significantly the way you enter data in 1-2-3.andP;  Withautomatic formatting in effect, if you enter a value that mimics a date,time, currency, percent, fixed, or scientific format, 1-2-3 displays thevalue in that format.andM;For example, if you enter 11/16/89, you no longer get .0077247191; if youenter 4:15 PM, you get the appropriate time value formatted as D7 (T2).andP;  Ifyou enter $1,000,000.00, you get C2 format--and so on.andM;Perhaps best of all, if you start with a number and follow with text (as in&quot;123 North Elm Street&quot;), you get a label.andP;  And if you enter an invalidformula, you also get a label (as you do in some other spreadsheet programs).andM;Two caveats apply to the use of automatic formatting.andP;  First, if you want anumber less than 1,000 to be recognized as a comma format, you have to enterone or more leading zeros and a comma.andP;  Second, if you change the currencysymbol to a multiple-character or multibyte value that appears before thenumber, automatic formatting no longer works with currency entries.andP;  (The oneexception to this is the U.S.andP;  dollar symbol followed by a space character;this combination is still recognized).andM;Other new formatting options include the ability to have all entries treatedas labels, to have negative values appear in red (or high intensity), to haveall values--positive or negative--enclosed in parentheses, and to have alabel of your choice substituted automatically for any entries that evaluateto zero.andM;OTHER EVERYDAY CONVENIENCESandM;Release 3 also offers a few other conveniences to simplify data entry andediting, worksheet reorganization, and error handling.andP;  Cell entries can nowhold up to 512 characters--twice as many as in earlier versions.andP;  And whenyou edit a long entry, the control panel expands downward; you no longer haveto put up with horizontal scrolling.andM;You can enter function names from a list instead of typing them.andP;  Press @followed by F3 to get a horizontal list; press F3 a second time to make thelist fullscreen.andP;  Unfortunately, you still have to remember the functionsyntax.andP;  You can also use this technique with macro keywords.andP;  Type {followedby F3 to get a list of available verbs.andM;There is no longer any need to create date column headings by hand or macro;you can use/Data Fill instead.andP;  To specify a step value in days, type aninteger followed by a d; to specify a skip in months, follow the number withan m, and so on.andP;  The step value unit can be seconds, minutes, hours, days,weeks, months, quarters, or years.andM;Formulas and range names can now be annotated.andP;  To add a comment to aformula, follow it with a semicolon and the comment.andP;  To annotate a rangename, use /Range Name Note Create, select the range name from the ensuinglist, and type your comment.andP;  You can use/Range Name Note Table to generate atrhee-column list of range names, their addresses, and their descriptivecomments.andM;A formula that references an undefined range now returns ERR.andP;  This gives youmore flexibility in the way you work; you can resolve the references later.andO;You can reference nonexistent filenames as well as undefined ranges.andP;  Tospecify a nonexistent file, type double opening and closing angle brackets(andless;andless;andgt;andgt;) with nothing in between.andP;  These references, of course, also returnERR.andM;Named references now remain on the edit line when you press F2.andP;  Earlierversions substituted the original cell addresses for the names when you wentto edit a formula.andP;  Release 3 does not, however, automatically substitutenames for cell addresses in formulas entered after the cell addresses havebeen defined.andP;  For example, if you define C10..N10 as TOTALS, all existingreferences to C10..N10 are changed to TOTALS, but all subsequent referencesto that range are not changed.andP;  The program assumes that if you reference analready named range by its cell addresses, you know what you're doing.andP;  (Butyou can apply the name later if you change your mind; just go into EDIT mode,put the cursor on the reference, and press F3.)andM;If you delete one of the end-point cells of a range, 1-2-3 now contracts therange and adjusts all formulas appropriately.andP;  Earlier versions convert workto mush under these circumstances.andP;  (If you use/Move to overwrite a range endpoint, however, the range still becomes undefined--as it does in previousversions.)andM;Finally, 1-2-3 is not a little friendlier in its handling of command errors.andO;Instead of bouncing you out to the worksheet when you clear the errorindicator, it now leaves you in EDIT mode and gives you a chance to makeamends.andM;IS AN UPGRADE IN YOUR FUTURE?andM;Now for the $64,000 question: Should you upgrade?andP;  The answer, of course,is--it deppends.andP;  Provided the hardware requirement is not insuperable, I'dseriously consider it if I needed the convenience of doing consolidations via3-D worksheets or if I required a tool for analyzing large external datafiles.andP;  Both Excel and Quattro Pro are also a lot more adept at worksheetconsolidation than Release 2.x, but neither of those programs offersmultipage 3-D.andP;  And in spite of everything Borland has done to ensure Lotuscompatibility, I think the user with deeply ingrained 1-2-3 habits will finda transition to Release 3 a marginally lower learning hurdle than atransition to Quattro Pro.andM;However, if your main concern is generating boardroom presentations, youshould stay away from Release 3--at least until Lotus gets Allways into thepicture.andP;  While you're waiting, take a good hard look at Excel and QuattroPro, both of which paint circles around 1-2-3, with or without Allways.andP;  (Youmight also want to check out 1-2-3/G, which ought to be available bymidyear.)andM;And if you're already using a suite of Release 2 add-ins, you may lose morethan you gain by moving to Release 3, since those add-ins won't run.andO;Presumably the most successful Release 2 add-ins will appear in Release 3versions before long and vendors will offer inexpensive upgrade options.andP;  Butif you're an add-in junkie there's no reason to move until they do.andM;SEND US YOUR HINTS, TIPS, ANDandM;QUESTIONSandM;Share your latest spreadsheet discovery through Spreadsheets.andP;  We'll pay $50or more for tips we print, plus an extra $25 if you submit your letteron-disk.andP;  If you do, please include a printed copy.andP;  Mail contributions toSpreadsheets, PC Magazine, One Park Avenue, New York, NY 10016, or uploadthem to PC MagNet (see the &quot;By Modem&quot; sidebar in the Utilities column).andO;</TEXT></DOC>
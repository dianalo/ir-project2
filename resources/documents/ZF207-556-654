<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF207-556-654  </DOCNO><DOCID>07 556 654.andM;</DOCID><JOURNAL>PC User  April 26 1989 n105 p115(2)* Full Text COPYRIGHT EMAP Business and Computer Publications1989.andM;</JOURNAL><TITLE>World of 1-2-3. (tutorial) (column)andM;</TITLE><SUMMARY>A number of spreadsheet techniques are demonstrated in conjunctionwith the creation of a Lotus 1-2-3 worksheet dealing specificallywith VAT analysis.andP;  When using spreadsheets, it is important tosave several copies in case one gets lost or corrupted, check tobe sure that all the necessary files have been created, create amaster spreadsheet, write a file consolidation macro and executethe macro.andP;  Each of these steps is discussed in detail.andM;</SUMMARY><DESCRIPT>Company:   Lotus Development Corp. (products).andO;Ticker:    LOTS.andO;Product:   Lotus 1-2-3 (Spreadsheet software) (usage).andO;Topic:     SpreadsheetsApplicationsTutorial.andM;</DESCRIPT><TEXT>Last time we used a VAT analysis spreadsheet as an example to illustrateseveral spreadsheet techniques.andP;  These included the @IF statements and aquick to blank out all die values in the current spreadsheet.andM;This time we're going to carry on using the VAT spreadsheet example topractise Me combine macro techniques.andM;Step 1 The Story So FarandM;The spreadsheet below shows our VAT analysis as we left it last time.andP;  ColumnC is a list of values.andP;  The @[F formula used in column D is shown at the topof the screen and the formula in column E simply  subtracts the value in Dfrom die value in C.andM;The tows are @SUM formulas that add up the appropriate columns.andM;Step 2 Saving Several CopiesandM;Last time we saved the March figures away in a file called VAT.andP;  For ourexercise we need six copies of the spreadsheet to represent the January to June figures.andM;Save away your six copies using the following useful naming convention.andP;  Calleach file VAT89 and follow that with the month number.andM;Then we'll use the same figures for each month in our exercise.andP;  It's up toyou whether you want to edit the label in Al to die appropriate month names.andO;We'll only be dealing with die first six months, but because there are 12months in the year, use a leading zero ahead of the month number.andP;  So theJanuary sheet will be caned VAT8901, February will be VAT8902 and so on.andM;Using this naming technique when using dates in file names is useful becauseall the appropriate files will be grouped together when  1-2-3  resents uswith a sorted file listing.andM;Step 3 Check your FilesandM;Make sure that you've created afl the files necessary for this exercise byissuing the following command:andM;/File List WorksheetandM;A full screen listing of your files will be shown, similar to the this:andM;As you move the cursor across your file names the date and time of the lastsave, as well as the file size, will be displayed at die top.andM;Step 4 Creating a Master SpreadsheetandM;We now need to create a master spreadsheet that will hold both the macro forour consolidation and the final figures that we obtain.andP;  This time edit dielabel in Al to read:andM;VAT Anadysis for 1989january to JuneandM;We will also need to remove the existing values from this spreadsheet to makesure that our results are correct.andP;  You can use the File Combine Subtracttechnique discussed last time, or the following erase command:andM;T/Range Erase c5..c11andM;The screen below shows the file as it was being saved away under the nameVAT891-6:andM;Step 5 File Consolidation MacroandM;As usual when you are creating a macro it's a good idea to run through thekeystrokes and note them down before you start typing into the spreadsheet.andM;For clarity here I've chosen to place my macro in B16.andP;  Often it's worthplacing them below and to the right of your spreadsheet figures  area.andP;  Thismeans that even if you decide to insert or delete rows and columns of figuresyou will not disturb your macros.andP;  In A16 put in the macro name of \C.andP;  Youwill need to precede the backslash  \) with an apostrophe ') otherwise 1-2-3will assume you are entering a repeating label.andM;The name adds some documentation to our macro and helps us to range namemacros quickly, as we will see later.andM;The first fine of our macro in B16 is {home}.andP;  When we execute the macro thiswill send the cursor to cell A1, which is important if our file combine is towork correctly.andM;Step 6 Line 2 of the MacroandM;This fine will execute a File Combine Add Entire-file of our first twospreadsheets.andP;  Enter the following macro keystrokes into cell B17:'/fcaeVAT8901  /faceVAT8902~andM;The apostrophe tells 1-2-3 that it shouldn't actually execute the menucommands as they are typed.andP;  The spreadsheet should now look like this:andM;Opinions differ on the use of lower and upper case in macro code.andP;  l' haveused lower case for menu commands and upper case for the file names.andP;  I wouldalso use upper case for die range names.andP;  You should choose a convention thatsuits you best, but as you can see in our example, it's useful to be able todistinguish the menu commands  from the files or ranges that are being workedon.andM;Step 7 Completing the MacroandM;It is now a simple matter to use the Copy command to create the other twofines of our macro which are similar to the second fine.andP;  You can then usethe F2 Edit command to change the file names.andP;  The screen below shows thethird macro fine complete for March and April and file fourth fine beingedited for May and June: Step 8 Naming the MacroandM;We have put the label \C into our worksheet to be short for Consolidation.andO;We will now use die Range Name Labels command to name the macro.andM;Move to cell A1 6andM;/Range Name Labels Right and press ReturnandM;If we have many labels we would have highlighted them all before pressingreturn.andP;  The screen below is showing this point:andM;Step 9 Executing the ConsolidationandM;We can now carry out our consolidation of aH six files with a singekeystroke: Alt-C.andP;  In our example some of the final values are too large, sothose cells show a series of asterisks (...... ) instead of a value.andM;The final screen shows columns C and E widened.andP;  Now save it.andM;Step 10 Other RefinementsandM;You may like to experiment and add furthier refinements to the macro.andP;  Oneusefull refinement would be to add a Range Erase command at the beginning tomake sure that the worksheet is always empty of values before theconsolidation is run.andM;You may also like to see the effect that the Windows and Panels macrokeywords have on the screen display as the macro is executed.andM;in a future article we will look at how String Arithmetic and FOR loops canhelp us write less repetetive macros.andO;</TEXT></DOC>
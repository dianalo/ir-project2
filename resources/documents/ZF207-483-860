<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF207-483-860  </DOCNO><DOCID>07 483 860.andM;</DOCID><JOURNAL>Lotus  August 1989 v5 n8 p44(4)* Full Text COPYRIGHT Lotus Publishing Corporation 1989.andM;</JOURNAL><TITLE>When one cell depends on another. (cell referencing in Lotus 1-2-3and Symphony)</TITLE><AUTHOR>Nelson, Stephen L.andM;</AUTHOR><SUMMARY>The basic use of cell referencing in Lotus 1-2-3 and Symphony isdiscussed.andP;  Cell references separate the spreadsheet raw data fromthe formulas so that the software can do more operations than justcalculate formulas.andP;  A cell address may be relative, absolute ormixed.andP;  A relative address consists of a column and a row number.andO;When a cell with a relative cell reference is copied, thereference changes.andP;  On the other hand, an absolute cell referencewill not change when the cell containing it is copied.andP;  The mixedcell reference combines absolute and relative references to userspecifications.andP;  Instructions on assigning names to cell rangesand using the ABS key are also included.andP;  Common problems anderrors associated with assigning cell references are discussed aswell.andM;</SUMMARY><DESCRIPT>Product:   Lotus 1-2-3 (Spreadsheet software) (usage)Symphony (Integrated software) (usage).andO;Topic:     SpreadsheetsTutorial.andM;</DESCRIPT><TEXT>When One Cell Depends on Another The flexibility of 1-2-3 and Symphony stemsfrom the many ways they let you use worksheet data.andP;  In fact, without theability to link one piece of data to another, a spreadsheet would be littlemore than an expensive, albeit fast, calculator.andM;To exploit the full range of cell references, you should understand the manyways you can tap data stored in worksheet cells and ranges.andP;  You'll also wantto heed some warnings about the ways in which cell references go bad.andM;THE ABC'S OF CELL REFERENCESandM;Suppose you and a friend just completed a four-day road trip through theSouthwest.andP;  Along the way, you recorded the number of miles you drove and howmuch gasoline you used each day.andP;  Now that you're home, you want to create aworksheet that calculates total miles, total gallons, average miles pergallon, and daily average gas expense.andM;Range Al..C5 of figure 1 contains the trip data.andP;  To build the small model,set the global column width to 10: Press slash, select Worksheet GlobalColumn-Width, and enter 10.andP;  In Symphony press MENU, select Settings Width,enter 10, and select Quit.andP;  Enter the labels shown across row 1 and downcolumn A of figure 1.andP;  Select/Range Label Right (in Symphony, MENU RangeLabel-Alignment Right) and specify range B1..E1 to right-align the labels.andO;Now enter the trip data shown in range B2..C5.andP;  Select/Range Format Fixed (inSymphony, MENU Format Fixed), press Return to accept two decimal places, andspecify range C2..C5.andP;  Now you're ready to perform the calculations.andM;You might use the &quot;computer as calcutor&quot; approach.andP;  For example, to calculatethe total miles driven, you could enter the formula +223+194+309+348 in cellD7.andP;  Likewise, the formula +15+14.5+21+27 entered in cell D8 calculates thetotal gallons used.andP;  Finally, the formula (223+194+309+348)/(15+14.5+21+27)entered in cell d9 calculates the average miles per gallon.andM;These formulas produce correct results.andP;  But what if the raw data changes?andO;Then you must edit each formula to generate update results.andP;  That points outthe advantage of using cell references in formulas: As the data changes, theresults generated by the formulas also change.andM;When you write an addition formula made up of cell references, you're nottetting 1-2-3 and Symphony to add together specific values.andP;  RAther, youinstruct the program to add together the contents of specific cells.andP;  A cellreference is made up of a column metter and a row number.andM;Enter formulas using cell references in your model.andP;  To understand this,enter the simple addition formula +B2+B3+B4+B5 in cell D7 to calculate totalmiles.andP;  Enter the formula +C2+C3+C4+C5 in cell D8 to calculate total gallons.andO;Then, if you wish, select the Fixed format with tho decimal places for cellD8.andM;When you use cell references, you separate the raw data--here the miles andgallons--from the formulas.andP;  Doing so provides two benefits.andP;  First, formulasare updated to reflect changes in data.andP;  for example, suppose you review yourgas receipts and find that on Tuesday you purchased 15, not 14.5, gallons ofgas.andP;  Just change the contents of cell C3, which contains Tuesday's gallonsfigure, and the formula in cell D8 is automatically updated.andP;  the secondbenefit of cell references is that you can use the data in as many formulasas you want.andM;Formulas made up of cell references operate like links in a chain.andP;  Often, areferenced cell doesn't contain data but references other cells, which maycontain still other cell references.andP;  For example, you need a formula thatcalculates average miles per gallon.andP;  Since cells D7 and D8 already calculatethe total miles and gallons, use them in your calculation of average milesper gallon.andP;  Enter the formula +D7/D8 in cell D9.andP;  Then, for that cell,select the Fixed format with two decimal places.andM;Now you have a small linked chain of formulas and cell references.andP;  Changethe raw--for example, change the 15 in cell C3 back to 14.5--and the formulasare automatically updated.andM;IT'S ALL RELATIVEandM;Cell references do more than provide a way of tapping into the contents ofworksheet cells.andP;  They play a vital role when you copy a formula containingthem from one cell to another.andM;Thet three types of cell references are relative, absolute, and mixed.andP;  Thesevarieties are distinguished from each other by how they react when you copycells containing them from one location to another on the spreadsheet.andP;  Sinceyou used relative cell references in the formulas you just created, we'llexamine that type now.andP;  You'll learn about the other two types in thefollowing sections.andM;A relative cell address, as you just saw, is made up of a column letter androw number.andP;  But what distinguishes a relative cell reference from anabsolute or mixed cell reference is that when you copy a cell containing arelative cell reference, the reference changes.andP;  The sounds more confusingthan it really is, so let's take a moment to look at how 1-2-3 and Symphony&quot;think&quot; about cell references.andM;Cell D7 of figure 1 should now contain the formula +B2+B3+B4+B5.andP;  1-2-3 andSymphony determine which cells to add together by first determining thelocations of those cells relative to the cell containing the formula.andP;  Hereyou entered the formula in column D and referred to cells in column B, whichis two columns to the left of column D.andP;  You entered the formula in row 7 andreferred to cells in rows 2,3,4, and 5.andP;  Both 1-2-3 and Symphony determinethat these cells are 5 (calculated as row 7 minus row 2), 4 (7-3), 3 (7-4),and 2 (7-5) rows above the row containing the formula.andP;  To 1-2-3 andSymphony, the formula +B2+B3+B4+B5 in cell D7 is really saying &quot;add togetherthe cells that are two columns to the left and 5,4,3, and 2 rows up from thecell containing the formula.&quot;andP;  No matter where you copy cell D7, the formulawill always seek out the cells in those locations and add them together.andO;That's how relative cell references work.andM;To illustrate this concept, let's return to the motor-trip worksheet.andO;Suppose you want to calculate the daily miles per gallon.andP;  Enter the formula+B2/C2 in cell D2.andP;  Because you entered the formula in cell D2, the formulauses the cell reference B2 to identify the cell that's two columns to theleft in the same row, and it uses the cell reference C2 to identify the cellthat's one column to the left in the same row.andM;Copy the formula in cell D2 to range D3..D5 and you'll see the magic.andO;Select/Copy (in Symphony, MENU Copy) and specify cell D2 as the From rangeand range D3..D5 as the To range.andP;  Because the cell references are relative,what you just copied is a formula that says &quot;divide the contents of the cellthat's two columns to the left in this same row by the contents of the celltht's one column to the left in this same row.&quot;andP;  Once you've copied theformula, move the pointer down column D and watch how the formula thatappears on the status line changes.andP;  What starts out as +B2/C2 becomes+B3/C3, +B4/C4, and +B5/C5.andP;  Select the Fixed format with two decimal placesfor range D2..D5.andM;THE ABSOLUTE TRUTHandM;Unlike a relative cell reference, an absolute cell reference does notautomatically change when you copy the cell containing it to another locationon the spreadsheet.andP;  To make an absolute cell reference, you precede both thecolumn letter and row number with a dollar sign--for example, $A$1.andP;  Then, nomatter where you copy the cell containing this reference, it will alwaysrefer to cell A1.andM;Consider an example that requires an absolute cell reference.andP;  Suppose youknow that the average price per gallon of gas was $1.12.andP;  Enter that value incell D10 and then select/Range Format Currency (in Symphony, MENU FormatCurrency), press Return to accept two decimal places, and specify cell D10.andO;Now you want to calculate the average daily cost for gas.andP;  To do so, you needto multiply the average price per gallon by the number of gallons for eachday of your trip.andP;  Here the average price per gallon remains constant, sothat cell reference is absolute.andP;   The number of gallons, shown in column C,changes each day.andP;  Therefore, that cell reference is relative.andM;To calculate the cost of Monday's gas, enter the formula +$D$110*C2 in cellE2.andP;  To format range E2..E5 for currency, select /Range Format Currency (inSymphony, MENU Format Currency 2), press Return to accept two decimal places,and specify range E2..E5.andP;  Copy cell E2 to range E3..E5.andP;  Move the pointerdown column E and watch the formula change on the status line.andP;  You'll seethat the absolute reference to cell $D$10 always remains the same, while therow number in the relative cell reference in cell E2 increases by one as youmove the pointer down the column.andP;  Before moving on, save the worksheet;you'll need it later.andP;  Select /File Save (in Symphony, SERVICES File Save)and enter the file name FIG1.andM;A LITTLE OF EACHandM;A third type of cell reference is the mixed cell reference, which is partabsolute and part relative.andP;  The portion of the reference preceded by adollar sign is absolute, while the portion of the reference not preceded by adollar sign is relative.andP;  As you might expect, the part that is relativechanges when you copy the cell containing the reference, while the part thatis absolute always refers to the same column or row.andM;Suppose a cell reference is $A1.andP;  When you copy the cell containing this cellreference, only the row number changes.andP;  If the cell reference is A$1, onlythe columns letter changes when you copy the cell.andM;For example, let's say that before your trip, you evaluated the expense ofstaying at four motels.andP;  Each motel had a different daily rate, and youwanted to know how much it would cost for you to stay either two or four daysat each.andP;  Figure 2 contains a model that performs this analysis.andM;To built the model, clear your worksheet by selecting /Worksheet Erase Yes(in Symphony, SERVICES New Yes).andP;  Set the width of column A to 15: Move thecell pointer to any cell in column A, select /Worksheet Column Set-Width (inSymphony, MENU width Set), and enter 15.andP;  Enter the labels shown across row 1and down column A and the values shown in range C2..D2.andP;  Next, enter thevalues shown in range B3..B6.andP;  Select /Range Format Currency (in Symphony,MENU Format Currency), specify zero decimal places, and specify range B3..D6.andM;Now you're ready to write one formula that does the job.andP;  Start by thinkinghow you would calculate the price for two nights at the Cactusland Motel.andO;The formula in cell C3 would be +C2*B3.andP;  Now you need to figure out whichportions of the formula need to be absolute.andP;  When you copy the formula tocolumn D, you'll want the C2 to refer to D2.andP;  Therefore, the row numberremains absolute, while the column letter is relative.andP;  That cell referencebecomes C$2.andP;  However, when you copy the formula down columns C and D, youwant the row number in the cell reference B3 to change, while the columnletter remains constant.andP;  So that cell reference becomes $B3.andP;  The finalformula, which you enter in cell C3 and copy to range C3..D6, is + C$2*$B3.andM;RANGE NAMES AS REFERENCESandM;1-2-3 and Symphony allow you to assign names to cells and ranges.andP;  Doing somakes working with a spreadsheet more intuitive, since you're more likely toremember the name prices, for example, than you are to remember the rangeaddress A1..A100.andP;  Once you name a range, you can use that name as areference.andM;Retrieve the file named FIG1.andP;  Select /File Retrieve (in Symphony, SERVICESFile Retrieve) and specify FIG1.andP;  When you calculated daily average gasprices, you used the absolute cell reference $D$10 to refer to the averagegas price.andP;  This time, let's write an equivalent formula that uses a rangename instead of a cell reference.andM;To begin, name cell D10.andP;  Select /Range Name Create (in Symphony, MENU RangeName Create), enter the name gas, and specify cell D10.andP;  Now enter theformula +gas*C2 in cell F2 to calculate the daily average gas expense forMonday.andM;What about calculating the expense for Tuesday through Thursday? You mightthink that you can just copy cell F2 down the column.andP;  But if you do, youwon't get correct results.andP;  1-2-3 and Symphony automatically consider arange-name reference to be relative.andP;  Therefore, when you copy a formulacontaining a range name, the programs automatically adjust the range address,just as they adjust the cell address in a relative cell reference.andP;  To usethe formula you just created to calculate the average gas expense for Tuesdaythrough Thursday, retype the formula in cell F2, making the range-namereference absolute by preceding the name with a dollar sign.andP;  Then theformula in cell F2 will read +$gas*C2.andP;  Now you can copy cell F2 to rangeF3..F5, and you'll see that its results are identical to those returned bythe formula in column E, which used a cell reference.andM;ABS KEY SHORTHANDandM;When you need to enter an absolute or mixed cell reference, you can eithermanually type the dollar signs or let the ABS key (in 1-2-3, F4; in Symphony,F3) do the work for you.andP;  By pressing the ABS key, you can cycle through thefour possible cell references: relative, absolute, relative column andabsolute row, and absolute column and relative row.andP;  1-2-3 Release 3 has fouradditional combinations that handle worksheet references.andP;  In 1-2-3 the ABSkey works in Edit, Value, or Point modes.andP;  In Symphony it works only in Pointmode.andM;In 1-2-3's Edit mode, you can also use the ABS key to change the range-namereference from absolute to relative or from relative to absolute.andP;  Mixed cellreferences are not an option whith named ranges.andM;BAD REFERENCESandM;Now that you know how to write a cell reference, you need to know how theycan go wrong.andP;  Two problems can surface the exploding range and the circularreference.andP;  Let's take a look at each of them.andM;Like Christopher Columbus, you'll find it comforting to know that you won'tinadvertently sail off the edge of your worksheet world.andP;  In fact, aworksheet isn't flat; it's round.andP;  But comforting as this is, it presents theproblem of the exploding range.andP;  This occurs when you copy a single-cellreference that suddenly refers to a cell in the far reaches of yourspreadsheet.andP;  It also crops up when you copy a range-name reference thatsuddenly grows.andM;Let's look at an example.andP;  You'll see in figure 3 how one Copy command causesthe @SUM range to grow from 10 rows to approximately 8,000 rows.andP;  If any ofthe new rows include data, the results produced by the formula will becorrect according to 1-2-3 and Symphony, but they're probably not exactlywhat you want.andM;For example, the copied formula in cell C4 of figure 3 references only thelast two cells of range A1..A10 rather than the first nine.andP;  This is becausewhen you copy the formula up one row, cell A1 in the original formula can'tmove up a row.andP;  It's already at the top of the worksheet.andP;  Instead, cell A1loops down to the bottommost row of the worksheet, row 8192.andP;  The cellreference A10, on the other hand, can move up one row.andP;  Therefore, when youcopy the formula, it refers to cell A9.andM;The exploding range problem always occurs because you're using a relativecell reference when you need an absolute or mixed reference.andP;  In figure 3 theformula @SUM(A$1.A10) entered in cell C5 would give the desired sum of rangeA1..A9 when you copy it to cell C4.andM;Now consider the second problem: the circular reference.andP;  As the examples inthis article demonstrate, cell references in formulas act like links in achain.andP;  By their nature, formulas containing cell references set up certaindependencies within a spreadsheet.andP;  In the gas mileage model shown in figure1, the formula in cell D9 references cells D7 and D8.andP;  Cells D7 and D8reference cells B2 through B5 and C2 through C5, all of which contain rawdata.andP;  1-2-3 and Symphony determine that cells D7 and D8 are &quot;precedent&quot;Cells, meaning that the program calculates them before calculating cell D9.andM;When chain-linked formulas form a closed loop, they generate a circularreference.andP;  To illustrate, purposely create a circular reference in yourspreadsheet.andP;  Enter the reference +H1+1 in cell H2.andP;  Then enter the reference+H2+1 in cell H1.andP;  Now cell H1 equals cell H2, and each cell in the two-cellchain depends either directly or indirectly on itself for its calculatedvalue.andP;  When that condition occurs, the Circ indicator immediately appears atthe bottom of your screen.andM;Not all circular references are quite so simple, but fortunately, 1-2-3 andSymphony provide some assistance in identifying the offending cells.andP;  Inaddition to displaying the Circ indicator, the programs help you locate thecell containing the circular reference.andP;  Select /Worksheet Status (inSymphony, MENU Settings).andP;  This screen shows you the location of the circularreference that was identified during the last worksheet recalculation.andP;  Thisscreen won't tell you whether or not you have more than one circularreference.andP;  Instead, you'll have to correct one circular reference,recalculate the worksheet, and check this screen for other circularreferences.andM;Not every circular reference is bad.andP;  In fact, some spreadsheet problemsdictate that you generate one.andP;  For example, suppose you need to calculatebonuses that are equal to 10% of the company's after-tax income.andP;  You need toknow the after-tax income before you calculate the bonus.andP;  But because thebonuses are a tax-deductible expense, you need to calculate them before youcalculate the after-tax income.andP;  When you solve this sort of obviouslycircular algebraic problem, you allow circular references to exist in yourworksheet.andP;  Generally, however, you'll want to avoid them.andO;</TEXT></DOC>
<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF109-503-231  </DOCNO><DOCID>09 503 231.andM;</DOCID><JOURNAL>PC Magazine  Oct 30 1990 v9 n18 p395(5)* Full Text COPYRIGHT Ziff-Davis Publishing Co. 1990.andM;</JOURNAL><TITLE>A prescription for the operating system of the future. (PowerProgramming)</TITLE><AUTHOR>Duncan, Ray.andM;</AUTHOR><SUMMARY>The design of an idealized future operating system that wouldtruly meet the needs of users and programmers is discussed.andP;  Thebasic design and user interface of DOS have changed little sincethe introduction of DOS 2.0 with the IBM PC-XT in 1983, possiblybecause Microsoft's massive investment in OS/2 development isessentially a bet that OS/2 will one day replace DOS.andP;  OS/2 doesnot show signs of replacing DOS yet, and DOS needs majorimprovements in several areas.andP;  Installation and setup tend to beawkward and require a considerable understanding of the FDISK,FORMAT, SYS, COPY and SELECT commands.andP;  Users frequently have tomake cryptic entries in the CONFIG.SYS and AUTOEXEC.BAT files, thedetails of which should ideally be hidden from users.andP;  DOS 4.01'suser interface consists of the archaic COMMAND.COM interpreter, adirect descendant OF CP/M, and the somewhat independent DOS Shell,a pale imitation of a graphical interface.andP;  DOS also suffers fromprimitive device drivers, especially for graphics and serialcommunications.andP;  It should also follow the example of Windows 3.0in adapting itself to the capabilities of the host processor.andO;Different operating 'modes' could optimize DOS for today's fasterprocessors while retaining compatibility with the early chips thesystem was originally designed to run on.andP;  DOS should also bebetter documented and supported.andM;</SUMMARY><DESCRIPT>Topic:     Software DesignOperating SystemsFuture TechnologiesUser NeedsMS-DOS.andM;</DESCRIPT><TEXT>The evolution of IBM-compatible personal computer hardware over the last nineyears has been nothing short of awesome.andP;  During this time we've moved from4.77-MHz 8088-based machines with an 8-bit 1/0 bus and 64K of RAM on themother-board to 25-MHz 80486-based machines with cache and a numericcoprocessor built right into the CPU chip, a 32-bit 1/0 bus, and 8MB or moreof RAM on the mother-board.andM;We've gone from 160K 5.25-inch floppy disks to 3.5-inch 1.44MB microdisksalong with fixed disk arrays supporting gigabytes of fast storage.andP;  We'vegone from 640-by-200 2-color graphics to 640-by-color 480 16-graphics as thebase-line-and in the CAD, image processing, graphics design, and desktoppublishing worlds, graphics adapters with much higher resolution and 256 ormore colors are common.andM;However, it's sad to say that the prevalent operating system onIBM-compatible personal computers-DOS-has not kept pace with this forwardmarch of technology.andP;  Indeed, its basic design and user interface has hardlychanged since 1983, when DOS 2.0 was introduced with the IBM PC-XT.andP;  Therehave been minor cosmetic improvements since then, as well as scatteredtechnological enhancements such as support for larger fixed disk partitionsand networks.andP;  It seems safe to say that if a PC-XT DOS 2.0 user sat down ata Compaq Deskpro 486 running DOS 4.0, he probably wouldn't notice anydifferences except for an enormous increase in speed-even if you asked him tomake system-level adjustments in areas ordinarily reserved for the poweruser, such as CONFIG.SYS or AUTOEXEC.andP;  BAT.andM;The backwardness of DOS in 1990 presents us with one of life's moreinteresting contradictions.andP;  Owners of Microsoft's other products-such asWord, Excel, or any of the programming tools-can attest to Microsoft'sfrequent, clockworklike release of reasonably priced upgrades that deliversignificantly improved functionality, ease of use, and documentation.andP;  Unlikesome large software houses we could name, Microsoft's competitive strategyhas been to present its rivals with a constantly moving target, rather thanattempting to preserve its market share through courtroom shenanigans.andP;  Why,then, has Microsoft allowed DOS, one of the most incredible cash cows of alltime, to languish?andM;I'm not privy to the inner strategic councils in Redmond, but I think I canmake some pretty accurate guesses about why DOS remains today much as it wasin 1 983.andP;  First, by 1985 or thereabouts, Microsoft was already deployingmassive resources toward development of the protected-mode operating systemthat would eventually become OS/2-in effect, betting that OS/2 would displaceDOS in a relatively short time.andP;  Second, Microsoft became entangled in theJoint Development Agreement with IBM, and bartered away its complete controlover DOS's architecture and product life cycle.andP;  Third, Microsoft did notforesee the phenomenal impact that DOS Extenders would have in prolonging theuseful life of DOS.andP;  DOS Extenders have made it easy for software developersto sell true protected-mode applications-which can fully exploit the featuresand extended memory of the 80286, 80386, and 80486 processor--on ordinary DOSmedia through normal DOS distribution channels to any DOS user who owns a PCthat is based on an 80286 or later CPU.andM;In 1989, approximately 11 million new copies of DOS were shipped, and theinstalled base of DOS was estimated at 45 million.andP;  This means that, unlessthere is an almost unimaginably severe recession, or an almost equallyunimaginable drastic shift in end-user attitudes toward Unix and OS/2, theDOS installed base should be approaching 100 million by the end of 1995.andP;  Anysaturation of the U.S.andP;  market should be more than offset by the incredibleopportunities it has for growth in Europe and the Far East.andP;  That's a lot ofnew DOS users, and it means that it's not too late to make some radicalimprovements in this venerable operating system-if Microsoft is able to throwoff its OS/2 blinders and give DOS the respect and attention that itdeserves.andP;  Let's take a quick look at the areas in which DOS could use someserious surgery.andM;INSTALLATION AND SETUPandM;DOS's current facilities for installation provide some of the most strikingevidence of the sad neglect of DOS over the last five years.andP;  Whileinstallation programs for Microsoft's other products have become more andmore flexible, foolproof, and even entertaining, installation of DOS stilldepends on the user's understanding of FDISK, FORMAT, SYS, and COPY, oralternatively, on that appalling miscarriage of software design, the SELECTcommand.andP;  DOS users certainly deserve better treatment than this.andP;  Justbecause they proved they can struggle along with such primitive installationaids for the last nine years doesn't mean that the situation should beallowed to continue.andP;  What DOS needs and warrants is an intelligent andforgiving installation program akin to the SETUP of Microsoft Windows 3.0.andO;The program should run in a visual, full-screen, interactive mode withpull-down menus and all the other modem conveniences, support a mouse, abideby the CUA guidelines, and include detailed, context-sensitive, on-line help.andM;Naturally, the new installation program needs to be able to emplace a copy ofDOS on a completely clean fixed disk, offering the user all the possibleformatting and partitioning options while at the same time makingrecommendations that will lead to the most efficient use of disk space.andP;  Theprogram should also have the capability analyze the machine's installedmemory and other assets and assist the user in making intelligent choicesabout which device drivers to load, allocating memory for disk caches or RAMdisks, and so forth.andP;  The gory details regarding the contents of theCONFIG.SYS and AUTOEXEC.BAT files should be hidden from the user; instead,the user should be able to make non-cryptic choices from menus that willautomatically result in the generation of the correct CONFIG.SYS and AUTOEXEC.BAT directives.andP;  The setup program for Digital Research's DR DOS, Version 5,sets a good example here.andM;Even more importantly, the new installation program needs to be able tosafely and correctly install a new version of DOS on top of any existing OEMversion of DOS, searching out and replacing all instances of the various DOSutility programs that are present anywhere on the disk.andP;  PreexistingCONFIG.SYS or AUTOEXEC.BAT files should be carefully updated with anyadditional directives required by the new DOS version, rather than beingarbitrarily overwritten; clear-text explanations of the differences betweenthe &quot;old&quot; and &quot;new&quot; versions of the two files should be displayed for theuser's inspection and approval before final changes are made.andP;  Theinstallation program should also have the capability of changing the existingfixed disk partitioning &quot; in place, &quot; using its knowledge of the diskstructure to move files and rebuild directories as necessary.andM;Finally, the new installation program should copy itself into the DOSutilities directory so that it can be invoked repeatedly at the user'sdiscretion-to change system parameters, reallocate memory, or installadditional device drivers.andP;  And if a crash-prone DOS configuration should becreated, despite the best intentions of the user and the determined defensesof the installation program, there should always be an esc  hatch of lastresort: booting DOS with a specific, user-definable key combination shouldsignal DOS to ignore CONFIG.SYS and AUTOEXEC.BAT altogether.andM;THE USER INTERFACEandM;The user interface in DOS, Version 4, consists of two somewhat independentmodules.andP;  The first module is COMMAND .COM, an archaic command lineinterpreter whose repertoire of directives dates back to the very firstrelease of DOS.andP;  In many ways, COMMAND.COM is a direct descendant of CP/M,Digital Research's 1970s-vintage operating system for 8080- and Z-80-basedmicrocomputers.andP;  CP/M's command set was, in turn, modeled by CP/M's authorGary Kildall after DEC's operating systems for the PDP-8 and PDP-11.andM;I suppose that COMMAND.COM must be retained in order to keep the DOS hackershappy, but there's a great deal that can be done to make it more tolerable.andO;Popular COMMAND.COM enhancers or replacements such as CED, 4DOS, and CommandPlus maintain backward compatibility with COMMAND.COM but add many usefulcapabilities such as command-line history and recall, command completion,macros, synonyms, hooks for resident extensions, a complete batch programminglanguage, sorted directories, a safer but more powerful ERASE command, andregular expression handling.andP;  All these features, as well as on-line help andsyntax examples for every DOS command, should be integrated into DOS's ownCOMMAND.COM to atone for its stagnation over the last decade.andM;The second user interface module in the current versions of DOS is theso-called DOS Shell, which apparently was perpetrated at IBM Boca Raton aspart of the ill-fated DOS 4 project.andP;  The DOS Shell in its present form haslittle to recommend it; compared with popular third-party shells such as PCTools or Norton Command, it's not very attractive, not very powerful, and notvery easy to use.andP;  Furthermore, the DOS Shell is not a true graphical userinterface (GUI)-it's only a pale simulation of one for users who don't knowany better.andP;  This leaves DOS at a marked disadvantage compared with the otherthree operating systems that are widely used on microcomputers-Unix,Macintosh's System 6 and 7, and OS/2-all of which are shipped with a GUI as astandard element of the system.andM;The best solution to the deficits of the DOS Shell, in my humble opinion, isto discard the nasty little rascal without wasting any more time on it.andO;Microsoft already has a critically acclaimed GUI for DOSMicrosoft Windows3.0-at its fingertips, and this GUI should simply be bundled into DOS inplace of the DOS Shell as a standard part of the package.andP;  This woulddrastically simplify system installation and management for users, and wouldalso help to rapidly expand the market for Windows applications, which iswhere Microsoft stands to make its real money.andM;DOS FUNCTIONALITYandM;The two most important gaps in DOS functionality are its primitive video andserial communications drivers.andP;  Since the earliest days of DOS, applicationshave been forced to go directly to the hardware controllers for these twodevices in order to get adequate performance.andP;  ironically, Microsoft nowclaims that it's not worthwhile to improve DOS's video and communicationsfacilities because no application would use them anyway.andM;But I think Microsoft is wrong.andP;  Very few programmers actually prefer todelve into this sort of bit-banging, hardware-dependent programming.andP;  IfDOS's display and communications services were properly spiffed up(equivalent, say, to the video and serial communications subsystems in OS/21.0), most programmers would migrate their applications toward well-behaveduse of these operating system services over the next few product releases.andO;In the end, programmers' jobs would be simplified, application compatibilitywould be vastly improved, and multitasking DOS applications would become muchless of a hassle.andM;Given the enormous range of machines that DOS runs on-from 8088-basedlap-tops to 80486-based network servers-the next most important thing thatshould be done to improve DOS is to make it adapt itself to the capabilitiesof the host processor.andP;  As it happens, Windows 3.0 sets a sterling example inthis area.andP;  Windows 3.0 is capable of running in three modes: real mode on8086/88-based PCs, standard mode (which allows use of extended memory) on80286-based PCs, and enhanced mode (which includes virtual memory andpreemptive multitasking) on 80386- or 80486-based PCs.andP;  However, if DOS wereto follow Windows' lead, it wouldn't make much sense for the installationprogram to copy one monster version of DOS onto the hard disk that containedparallel sequences of machine code for each of the possible CPUs.andP;  Instead,the installation program should sense the CPU type and select the appropriatemodules from all the possible variants that would be present on the DOSdistribution disks.andM;At first glance, it's hard to see what could be done to further optimize DOSfor the lowest-level, 8086/88-based PCs.andP;  DOS's speed on 8086/88 machines hasnever been a problem, because it was originally written for those CPUs andmuch of its kernel is coded in carefully hand-tuned 8086/88 assemblylanguage.andP;  Similarly, DOS doesn't squander disk space; it's still quitepractical to boot and run DOS on a floppy-disk-only system.andP;  The problemsthat arise with DOS on 8086/88-based PCs are mainly related to its appetitefor RAM.andP;  As DOS has evolved, it has required an increasingly largepercentage of the precious memory below the 640K boundary-a trend that peakedout (luckily) in DOS 4.andP;  0, which had such a pudgy kernel that someapplications refused to run at all.andP;  But a little creative thinking yields atleast four ways in which DOS's demand for conventional memory could befurther mitigated on 8086/88-based PCs.andM;First, when expanded memory is available, most of the DOS kernel andCOMMAND.COM could be loaded into EMS and executed from the EMS pageframe--the necessary restructuring of DOS to make this possible has alreadybeen accomplished in ROMable DOS 3.22.andP;  DOS's internal tables and buffersshould also be moved to EMS automatically whenever expanded memory isavailable.andP;  Second, DOS should allow the user to create multiple namedconfigurations, each with a different CONFIG.SYS and AUTOEXEC.BAT, and selectone of these configurations from a menu at boot time.andP;  For example, a usermight have one configuration that loads a minimum set of device drivers foruse with a particularly memory-hungry application, while anotherconfiguration would load a complete set of network device drivers, and athird configuration would create a large RAM disk to speed up compilations.andO;DR DOS 5.0's ability to prompt the user during interpretation of CONFIG.SYSand bypass certain directives according to the user's response is a step inthe right direction, but doesn't go nearly far enough.andM;Third, 8086/88-based DOS should be &quot;subsettable&quot;-for instance, if a userknows that he will never run any programs that use the obsolete FCB filefunctions, he should be able to specify this at installation, so that asmaller DOS kernel can be loaded.andP;  An alternative route would be to put eachclass of DOS functions into dynamic link libraries and implement a dynamiclink loader in the DOS kernel.andP;  Of course, if Windows were integrated intoDOS as I've suggested, these sorts of capabilities would come &quot;free.&quot; Fourth,and this is perhaps a much longer-range objective, the DOS kernel's interfaceto device drivers should be extended so that drivers can be dynamicallyloaded and unloaded without the hassle of resetting the system.andP;  It wouldalso be nice if device drivers could be executed from expanded memory,although this process would require much more elaborate facilities forinterrupt handling than DOS currently supports.andP;  Again, if the Windowsdynamic link library and virtual memory facilities were consolidated into theDOS kernel, these features could be added to DOS in a fairly straightforwardmanner.andM;When we look at 80286-based PCs, we find that Microsoft has already done areasonably good job of enhancing DOS to take advantage of this CPU.andP;  On80286s, nearly all of the DOS 5.0 kernel can be loaded into the high-memoryarea (HMA) at segment FFFFH, reducing DOS's overhead in conventional memorybelow the 640K boundary to something less than 20K.andP;  If this capability wereto be combined with the dynamic linking, efficient use of expanded memory,and other new features already mentioned as desirable for the base (8086/88)version of DOS, we'd have a pretty decent 80286 operating system.andP;  But thereis one more thing that needs to be mentioned.andP;  Microsoft has beeninstrumental in the creation and standardization of the DOS Protected ModeInterface (DPMI), which provides extended memory allocation, mode switching,and interrupt management services for protected-mode DOS Extender-basedapplication programs.andP;  Microsoft needs to go the final mile and incorporatethe DPMI into DOS as a standard set of DOS services, whenever DOS is runningon a PC based on an 80286 or later processor.andM;But it is really the 80386 and 80486 CPUs that hold the key to DOS's future.andO;Microsoft already has the 80386/486 software technology in hand to transformDOS into a killer operating system, but has failed to deliver this technologyto end users because of its preoccupation with OS/2.andP;  In Windows 3, Microsoftdisplayed the capability to fully exploit the 80386 instruction set,preemptively multitask standard DOS applications in separate Virtual-86machines, supply applications with emulated EMS 4.0 memory, and providedemand-paged virtual memory on a DOS platform.andP;  And in OS/2 2.0, Microsoftdemonstrated the ability to run DOS applications and even ill-behaved TSRs inVirtual-86 machines under the control of an operating system that livesentirely outside the traditional DOS IMB address space.andP;  All these features,along with the DPMI and other capabilities already discussed for the 8086/88and 80286 machines should be subsumed into the DOS kernel when it's runningon an 80386 or 80486.andM;Imagine the implications of a DOS that took full advantage of the 80386 and80486 processors! A DOS kernel that was recoded in native 80386 assemblylanguage would be incredibly fast, because it could exploit the 80386/486's32-bit registers, unique instructions, and addressing modes.andP;  And the lidwould be off as far as adding features; since the 80386/486-specific DOSkernel could execute in extended memory, it could grow as large as thedesigners felt necessary.andP;  For example, the 100K or so of RAM that would berequired for DOS to support the OS/2 High Performance File System (HPFS)would be no problem at all.andP;  It would even be perfectly practical for all DOScommands--including CHKDSK and XCOPY-to be intrinsic; they wouldn't need tobe read into memory from disk each time they were used, so their invocationwould be instantaneous.andM;DOCUMENT THE UNDOCUMENTEDandM;Along with bringing the functionality of DOS up to 1990's standards,Microsoft needs to expose and document the functionality that is alreadypresent.andP;  For example, Microsoft has always been extremely reluctant todocument the DOS functions and internal flags that are crucial to the properoperation of terminate-and-stay-resident (TSR) programs, stating that thesefunctions must remain undocumented because they might change in futureversions of DOS.andP;  The truth is, of course, that so many important commercialproducts (including several of Microsoft's) depend on these undocumentedfunctions that they can never be allowed to change.andP;  Therefore, the mysteryfunctions and flags might as well be documented and supported like theremainder of the DOS programming interface.andM;Another aspect of DOS programming that has traditionally been steeped inmystery is the so-called redirector interface; only the largest networkvendors have been allowed access to this information.andP;  The redirectorinterface is the back door to the DOS file system and is roughly equivalentto the installable file system interface in OS/2.andP;  It allows modules thatsupport non-FAT storage volumes, such as CD-ROMs or network drives, to bespliced into DOS in such a way that applications can access files on thosevolumes in a &quot;transparent&quot; manner.andP;  Exposing the redirector interface wouldhelp to stabilize it (at present, each new version of DOS typically breakseveryone's network drivers) and would open the door to rapid evolution andinnovation in DOS file systems.andM;SUPPORT AND UPGRADESandM;Up until this year, Microsoft's position on end-user support and updates forDOS was adamant and unyielding: Microsoft didn't support nobody nohow.andO;Microsoft's policy was originally based on its perception of DOS as anon-retail product.andP;  During the earliest days of DOS, Microsoft never soldDOS directly to end-users; instead, it licensed MS-DOS Binary Adaptation Kits(BAKs) to manufacturers of personal computers-the so-called OriginalEquipment Manufacturers (OEMs).andP;  In theory, the OEMs assumed allresponsibility for customizing MS-DOS for their equipment, repackaging itwith appropriate documentation, selling it to their customers along with themachines, providing end-user support, and paying royalties on a per-copybasis back to Microsoft.andM;It's true that a few OEMs-notably Compaq, Zenith, and Toshiba-actually didmake an effort to optimize DOS for their hardware.andP;  But most didn't investany more effort in the operating system than to change the DOS sign-onmessage slightly to include their own company name, slap their logo on thebasic DOS documentation, and pocket the difference between the list price andMicrosoft's royalty plus printing and disk duplication costs.andO;Understandably, users found it a bit difficult to comprehend how Miciosoftcould claim that it was unable to answer questions about DOS.andP;  Microsoftaggravated this credibility gap by manufacturing a &quot;generic&quot; version of DOSin a gray box that turned up in the hundreds of copies at fly-by-nightcomputer dealers, swap meets, and flea markets.andM;In 1990, as part of its reawakening to the continued importance of DOS,Microsoft made a startling U-turn on its policies regarding end-user supportfor DOS.andP;  A 900 number wired to a building full of technical supportpersonnel was established, and in addition Microsoft began to accept directquestions about any OEM version of DOS.andP;  Considering the size of the DOSinstalled base, this was a courageous move on Microsoft's part, and I applaudits decision to finally accept proper responsibility for supporting its ownproduct.andP;  There are also rumors that the DOS 5.0 upgrade/update will be madeavailable directly from Microsoft to end-users by phone, mail order, orthrough normal software distribution channels.andP;  If this should truly come topass, it will be additional potent evidence that Microsoft has undergone afundamental shift in its attitude toward support of DOS.andM;But there is still much to be done.andP;  Over the long run, the proliferation ofMS-DOS into multiple, slightly dissimilar OEM versions has been a disserviceto its users.andP;  It has prevented many users from obtaining peoper technicalsupport or timely updates, forced users to purchase new copies of DOSunnecessarily when one machine was replaced by another, and it has insulatedMicrosoft from vital user feedback about its most widely used product.andP;  To mymind, the best way to solve these ongoing problems is to eliminate themiddlemen, at least to the extent that  this is feasible with systemssoftware.andM;My own prejudice is that DOS should be converted into a single, uniformretail product, similar to the way Windows is marketed today.andP;  The basicproduct would rely only on the existence of an IBM-compatible ROM BIOS andwould not perform any direct hardware accesses.andP;  All customizations for aparticular OEM's hardware would be handled  through the OEM's distribution ofspecial &quot;device support diskettes.&quot; These diskettes would containOEM-specific device drivers, utility programs, and setup information thatwould be recognized and merged into the DOS system by the installationprogram.andP;  If set up in this fashion, the integrity of DOS as a stable,predictable platform for applications would be guaranteed, while the abilityof the OEM to &quot;add value&quot; to DOS would also be preserved.andM;THE SUCCESSOR TO DOSandM;Nearly all of the elements of a worthy successor to DOS have already beendemonstrated in the beta test version of MS-DOS 5.0, other Microsoft productssuch as OS/2 2.0 and Windows 3.0, the DOS clones such as Digital Research'sDR DOS, Version 5, or third-party DOS tools and utilities.andP;  Creation of sucha super-DOS wouldn't require that Microsoft break any new technologicalground.andP;  But it would require that Microsoft reconcile itself to themarketplace's resistance to the size and complexity of OS/2, and commititself wholeheartedly to making DOS everything that it can be-regardless ofthe impact this might have on Microsoft's Joint Development Agreement withIBM or on OS/2 sales.andP;  Can Microsoft summon up the intestinal fortitude tomake such a decision? Perhaps we'll find out in DOS, Version 6 !andP;  THE IN-BOXandM;Please send your questions, comments, and suggestions to me at any of thefollowing e-mail addresses: PC MagNet: 72241,52andM;MCI Mail: rduncanandM;BIX:rduncan</TEXT></DOC>
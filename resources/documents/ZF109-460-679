<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF109-460-679  </DOCNO><DOCID>09 460 679.andM;</DOCID><JOURNAL>UNIX Review  Oct 1990 v8 n10 p56(5)* Full Text COPYRIGHT Miller Freeman Publications 1990.andM;</JOURNAL><TITLE>FATMEN: on files. (File and Tape Management: Experimental Needs, aproject of the European Laboratory for Particle Physics)</TITLE><AUTHOR>Shiers, J.D.andM;</AUTHOR><SUMMARY>The File and Tape Management: Experimental Needs (FATMEN) systemis designed to assist in the management of physics data stored onmany different types of media for the Large Electron Position ring(LEP) accelerator, run by CERN, the European Laboratory forParticle Physics.andP;  FATMEN appears to users as a huge, distributedUNIX file system where they can access data regardless of medium,location and operating system.andP;  The system is also used as acatalog, providing network-wide data access with asystem-independent interface to files on top of a native filesystem.andP;  FATMEN's layer model eases the porting to differentoperating systems.andP;  The four layers of the system are: the FATMENdistributed file catalog, the media management system, the tapestaging system and the operator/robot.andP;  Users can issue standardUNIX-like commands on the FATMEN catalog using the FATMEN Shell.andO;Other parts of the system are discussed in detail.andM;</SUMMARY><DESCRIPT>Topic:     Distributed SystemsData ManagementPhysicsFile ReorganizationUNIXCase StudyLaboratoriesOrganisation Europeenne pour la Recherche Nucleaire.andM;</DESCRIPT><TEXT>Each of the four projects at CERN's newst accelerator may record up to 10 TBof data each year for 20 years.andP;  FATMEN's design will act as a powerfulcatalog for that data, regardless of location, medium, or operating system.andM;The European Laboratory for Particle Physics is situated just outside Geneva,straddling the Franco-Swiss border.andP;  Still known by the French acronym CERN(for Conseil europeen pour la recherche nucleaire), the laboratory wasestablished in the early 1950s to conduct the business it still conductstoday: studying the fundamental building blocks of matter to understand howthe whole universe works.andM;On July 14, 1989-coincidentally the 200th anniversary of the FrenchRevolution-CERN's latest accelerator, LEP (Large Electron Position ring),came into o r -ion.andP;  This machine is housed in a 27-kilometer-long tunnel,buried as deep as 150 meters underground.andM;The LEP facility supports four large experiments: Aleph, Delphi, L3, andOPAL.andP;  From the design stage to final analysis, each experiment-acollaboration of a large team of scientists from many institutes-is scheduledto last some 20 years.andP;  OPAL, for example, comprises approximately 300physicists from 25 laboratories in ten countries.andP;  The experiments recorddata on IBM 3480 cartridges, each cartridge containing 200 MB of data.andP;  Some50,000 cartridges, or 10 TB, may be recorded per experiment each year.andP;  Inaddition, extra data will be generated in the form of copies and in theprocessing that is required to extract the physics information.andM;It was with this background that the FATMEN project was born.andP;  The team onFATMEN (File and Tape Management: Experimental Needs) was given the task ofwriting (or acquiring) software to assist in the management of the LEP datafor all the experiments' stages, from data acquisition to the final physicspapers.andM;To complicate matters, the team had to deal with multiple operating systems,network protocols, and physical locations.andP;  In addition, the data could bestored on many different types of media, although magnetic tape and diskswould be by far the most common.andM;It was clear that these differences should be completely hidden from theuser, who should be able to gain access to data in a manner independent oflocation, medium, and operating system.andP;  To help achieve these goals, theteam agreed to standardize command and filename conventions, based onUNIX-like syntax.andP;  With a few restrictions, the system was to appear muchlike a huge, distributed UNIX filesystem.andM;Although the FATMEN system was designed for the LEP experiments, it is ofmuch more general use.andP;  Several other experiments at CERN have also begun touse it, as well as collaborations at physics institutes throughout the world.andO;Indeed, there is no reason to use it only for physics data.andP;  It is alsouseful as a catalog for software-distribution tapes, or simply as a powerfulcatalog that can provide a system-independent interface to files on top ofthe native filesystem.andP;  For example, the FATMEN catalog allows users toassociate both textual and binary data with their files, so that they mightaccess disk and tape files in a consistent manner.andM;From a physicist's point of view, the following are the most importantfeatures of the FATMEN system:andM;* Access to data is via a meaningful name, termed the generic name.andM;* Data is accessed in a manner independent of operating system, medium, andlocation.andM;* A single generic name can point to a complete file, part of a file, ormultiple files.andM;* Multiple generic names (aliases) may be used to access a single file.andM;The Look and Feel of FATMEN.andP;  To the user, the FATMEN system looks much likea distributed UNIX filesystem.andP;  As such, the generic name follows UNIXfile-naming conventions, and UNIX-like commands may be issued to manipulatefiles.andP;  We chose the UNIX conventions because we did not wish to invent a newfile-naming and command syntax, and because we expect UNIX to becomeincreasingly important in computing for high-energy physics over the nextseveral years.andP;  Thus, the UNIX syntax will soon be familiar to most of ourusers, if it isn't already.andM;Although it's not the purpose of this article to discuss the merits of UNIXover other operating systems, we can say that standardizing on UNIX bringswith it two significant advantages.andP;  First, users have a wide choice ofvendors from which to choose, with many highly competitive offerings in termsof MIPS per dollar.andP;  Second, the support issues are dramatically reduced overour present environment of multiple, proprietary operating systems.andP;  Thechoice of UNIX was also well matched by existing data-management tools atCERN, one of which-the Zebra data-management system, described below-isextensively used by the FATMEN system.andM;The FATMEN Model.andP;  The FATMEN system was designed using a layer model.andP;  Sincewe knew that we would have to deal with many different operating systems, andoften could not impose a solution on a collaborating laboratory, we made thesystem highly modular.andP;  At any level, a package or protocol can be easilyreplaced by another.andP;  Among other benefits, this has made porting todifferent operating systems extremely easy.andM;There are four layers in the system:andM;* The FATMEN Distributed File Catalog,andM;* The Media Management System,andM;* The Tape Staging System, andandM;* The Operator/Robot.andM;In this model, the operator/robot layer is responsible for ensuring thatunloadable media is mounted upon request.andM;The staging/setup layer is responsible for interfacing to theoperating-system-specific mount command and, in the case of staging, ensuringthat the data is copied to disk or tape, depending on whether a read or writeoperation is requested.andP;  All tape access through the FATMEN system impliesstaging.andP;  We believe this to be a much more efficient use of hardware,particularly in our environment where a dataset is frequently re-accessedseveral times in a relatively short period (1-2 days), or several jobs arerequired to write a complete dataset.andP;  The stage/setup layer also interfacesto the media-management system, to obtain details such as the location andtype of the required medium.andM;The media-management system is used to manage all unloadable media such astapes, optical platters, and the like.andP;  The system is based on a relationaldatabase (IBM's SQL/DS product) and is managed by a single service machine onan IBM mainframe.andP;  Plans are to migrate this system to Oracle and theninstall it on a stand-alone UNIX server later this year.andM;Commands are sent to the media-management system via a general-purposecommunications package, which was developed, along with the media-managementsystem itself, at the Rutherford Appleton Laboratories in the UK.andP;  A remoteinterface to this communications package over TCP/IP has been developed atCERN to enable networked systems to query the media-management system.andP;  Thissystem has much more functionality than is strictly required for the FATMENsystem, although its additional capabilities are used externally for themanagement of tape libraries, which contain several hundred thousand volumes.andM;The file-catalog layer forms the primary user interface to the FATMEN system.andO;This is described in more detail below.andP;  As stated above, very simpleinterfaces are defined between the different layers.andP;  It is assumed thatthese layers may be specific to the operating system or site.andP;  For example,the FATMEN system will interface to the media-management system used at thelocal site, and use the media-handling commands that are operating-systemspecific.andP;  A new system or site can be incorporated by writing a smallinterface to the defined standards.andM;For example, the stage/setup layer obtains the location and medium type of agiven volume from the media-management system.andP;  This information is thenpresented to the operator or robot, which is charged with ensuring that therequired volume is physically mounted.andP;  If a new device is added, it is onlythe stage/setup layer that has to be modified to allow access to the newmedium.andM;The FATMEN Shell.andP;  The FATMEN shell allows users to issue standard UNIX-likecommands on the FATMEN catalog.andP;  The shell carries on a dialog with the userthrough a package named KUIP (Kit for a User Interface Package).andP;  Originallydeveloped as part of a Physics Analysis Workstation (PAW) software package,KUIP supports a number of interface styles, such as alphanumeric, X Windows,graphics, and so forth.andP;  This allows users to enter commands either throughthe keyboard or via a point-and-click interface.andP;  The FATMEN shell can beextended by the user either through macros (scripts) or by writing additionalcommands in a high-level language.andM;The shell provides access to the features of the FATMEN system withoutrequiring the addition to users' programs of calls to the FATMEN library.andO;Users can inspect or manipulate the file catalog, edit the referenced filesusing their favorite text editor (assuming they are not in binary format), oraccess the files for subsequent processing by a FORTRAN program.andM;The FATMEN Callable Interface.andP;  For more complicated work, the FATMENcallable interface is recommended.andP;  This provides full access to all of thefeatures of the FATMEN system.andP;  Since the programming language most commonlyused by physicists is FORTRAN, this interface consists of a set ofFORTRAN-callable routines.andP;  The package currently consists of some 13,000lines of code, almost exclusively FORTRAN, with a small portion of C code forUNIX systems.andM;Routines exist to manipulate the catalog (add, modify, delete entries),access data, list entries, perform pattern matching (that is, to allow wildcards in filenames), allocate new tapes, and validate entries.andM;Users  can  access  data through either the callable interface or the shell.andO;For disk data, the FATMEN system will issue an assign command for thespecified FORTRAN unit and the disk dataset to which the FATMEN nametranslates.andP;  This dataset may be on a local disk or on a disk mounted viaNFS.andP;  For tape-resident files, the data is first copied to disk before theassign is performed.andP;  (Tape data can be accessed directly if required.) Onnon-UNIX systems, the command equivalent to an assign is issued, such as aFILEDEF command on VM/CMS or a DEFINE command on VAX/VMS systems.andM;Should the FATMEN filename point to more than one physical dataset, theFATMEN system will automatically choose the &quot;best&quot; copy.andP;  This decision,which can easily be modified or overridden by users, is based on a simplesearch order-namely (1) disk, (2) robotically-mounted tape, (3)manually-mounted tape.andP;  Typically, physicists will copy active data to diskor robotically-mounted tape and then have the FATMEN system automaticallychoose the most appropriate copy.andP;  As the FATMEN system also records the usecount and last access date of a file, this migration of data between mediatypes could be performed automatically by a utility.andM;The currently-installed version of FATMEN includes a basic implementation ofthis automatic migration, which proceeds as follows.andP;  For datasets accessedusing a specific option, FATMEN checks to see if a copy already exists in theautomated cartridge loader.andP;  If not, it allocates a free cartridge from apool reserved for that purpose and copies the data into the robot.andP;  As thecatalog is updated at the same time, subsequent accesses will automaticallychoose the robot copy.andP;  This facility, combined with a clean-up tool todelete old, infrequently-referenced datasets, ensures that only data which isactively referenced is maintained in the robot.andM;Remote data can be accessed through systems such as NFS or Digital's DFS asif it was local.andP;  The default search order currently places such datasetsafter local disk copies but before local robot copies.andP;  For example, should aremote dataset not be accessible via DFS or NFS and if it is on tape, aFATMEN fileserver process will be started.andP;  This server, again tailored todata access through FORTRAN, provides the basic I/O capabilities-such asread, write, open, close, inquire-and the possibility to issue a command tothe host operating system.andM;All that then remains to be done is to transmit the appropriate request (reada block of 8192 bytes), and return the corresponding data.andP;  Typically, CERNusers employ a machine-independent data format for storing data, though themost commonly used data-management package, ZEBRA, also supportsself-describing data with on-the-fly data conversion.andM;ZEBRA, the data-structure management package, was developed at CERN toovercome the lack of dynamic data-structure facilities in FORTRAN, thefavored computer language for high-energy physics.andP;  It implements the dynamiccreation and modification of data structures at execution time, and theirtransport to and from external media on the same or different computers,memory to memory, to disk, or over the network, at an insignificant cost interms of execution-time overheads.andM;ZEBRA manages any type of structure, but specifically supports linearstructures (lists) and trees.andP;  ZEBRA input/output is either by a sequentialor direct-access method.andP;  Two data representations, native (no dataconversion when transferred to/from the external medium) and exchange (aconversion to/from an interchange format), allow data to be transportedbetween computers of the same and of different architectures.andP;  Thedirect-access package RZ can be used to manage hierarchical databases.andP;  InFATMEN, this facility is exploited to store the catalog information in ahierarchical direct-access directory structure.andM;Data may be cataloged through the FATMEN shell or callable interface.andO;Typically, production programs would catalog any files created during a run.andO;The FATMEN system will fill in details such as the node name, operatingsystem, date and time, user name, and so on.andP;  The user may override thesefields or add additional user information, such as a comment anduser-specified file format.andM;The FATMEN Catalog Servers.andP;  The FATMEN File catalog is itself distributed.andO;The master copy is maintained at CERN, with local copies on other machines.andO;Although the catalog may be accessed over the network, this option isnormally used only for workstations.andP;  Larger systems that require access tothe catalog even in the event of network disturbances typically maintaintheir own copy.andP;  Each copy is maintained by a catalog server, which isresponsible for applying updates and broadcasting them to the other servers.andO;These copies of the catalog may contain a complete replica of the informationat CERN, or simply a subtree.andP;  In many cases, information on the raw data isonly kept at CERN.andM;When a user wishes to update the catalog, the update is sent to and processedby the nearest server (as defined by environmental variables).andP;  As thecatalogs are simply direct-access files, read access is possible even if theserver is blocked or busy.andP;  Updates, on the other hand, are asynchronous andwill be queued until the server is available.andM;To provide protection against loss of data, updates are also recorded in ajournal.andP;  In the case of hardware problems, the catalog can then be restoredfrom backup tape and the required updates reapplied.andM;Structure of the File Catalog.andP;  The key to the FATMEN system is a filecatalog, stored in a ZEBRA direct-access file.andP;  The file-catalog informationis also kept in an Oracle database on central IBM systems, although, again,this will be moved to a dedicated UNIX machine shortly.andP;  Users do notinteract directly with the Oracle database for a number of reasons.andP;  TheOracle copy is mainly kept for security purposes, but also to aid complicatedqueries, such as listing all files older than one month and larger than 100MB.andP;  Such queries are easily issued using SQL, which we had no wish toreinvent.andP;  In addition, we eventually expect several hundred thousand or evenmillions of file entries in the file catalog-and trusting all of thatinformation to a direct-access file seemed somewhat risky.andM;Current Status and Future Directions.andP;  The FATMEN system is currentlyinstalled at several sites in Europe.andP;  The number of these sites is expectedto grow rapidly over the coming months, as are the number of users requiringworkstation access to these facilities.andP;  In addition, a project has recentlybeen approved to distribute physics data to collaborating institutes viasatellite transmission.andP;  It is important that such data should also beaccessible through the FATMEN system.andM;In addition, we plan to integrate FATMEN with other applications at CERN,such as a code management system (CMZ) that's independent of the operatingsystem, and the Physics Analysis Workstation package mentioned earlier.andM;It is also clear that distributed computing will play an ever-increasing rolein high-energy physics.andP;  In such an environment, a distributed filesystemthat provides network-wide catalog and data access will be essential.andP;  Weexpect it to last, with constant evolution, until the start-up of the nextgeneration of experiments at the Large Hadron Collider (LHC), which will beinstalled in the same tunnel as LEP.andP;  Should this new project be approved andfunded soon, one might expect LHC to start operation toward the end of thisdecade.andP;  Although this project will bring with it many complications, atleast there is hope that only one operating system will be running by thattime.andM;By building on existing packages, we have developed a powerful distributedfilesystem in a short time.andP;  Clean interfaces between the various componentsof the system allow us to incorporate new systems or capabilities quickly.andO;The system is sufficiently powerful and flexible to last many years.andP;  Thereis hope that by the end of this time, mature, standardized mass-storagesystems will be available.andM;J.D.andP;  Shiers heads the Physics Analysis Section in the Applications SoftwareGroup, Computing and Networking Division, at CERN.andP;  This section isresponsible for a number of systems used in physics analysis, includingFATMEN, ZEBRA, and PAW, and is working to improve each of these systems foruse in a fully distributed, heterogeneous computing environment.andP;  Shiers tookhis physics degree at Imperial College in London and his PhD in particlephysics from Liverpool University, where he was affiliated with CERNExperiment NA5.andO;</TEXT></DOC>
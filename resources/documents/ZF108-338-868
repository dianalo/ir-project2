<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF108-338-868  </DOCNO><DOCID>08 338 868.andM;</DOCID><JOURNAL>PC-Computing  May 1990 v3 n5 p68(4)* Full Text COPYRIGHT Ziff-Davis Publishing Co. 1990.andM;</JOURNAL><TITLE>Spreadsheets. (guide to improving speed)(includes related articleon RAM drive overlays) (tutorial)</TITLE><AUTHOR>Falkner, Mike.andM;</AUTHOR><SUMMARY>A guide to improving the performance of popular spreadsheetpackages is presented.andP;  Quattro Pro and Excel can be used entirelyfrom RAM drives, enhancing the packages significantly butrequiring the user to buy several megabytes of expanded memory.andP;  Amath coprocessor significantly increases recalculation speed byoffloading 'number crunching' tasks from the CPU.andP;  Step by stepinstructions for 'fine tuning' Excel, Lotus 1-2-3, Quattro, andVP-Planner to maximize performance are given.andP;  Some changes can bemade at setup time, while others involve exploiting specificfunctions or formatting commands.andM;</SUMMARY><DESCRIPT>Topic:     SpreadsheetsSoftware packagesPerformance ImprovementTutorialMemory Management.andM;</DESCRIPT><TEXT>SPREADSHEET PACKAGES are the most obstinate when it comes to speedups.andO;Although spreadsheets were the first programs to use expanded memory,expanded memory was used for bigger spreadsheets, not faster ones.andO;Spreadsheets use few overlays, thus offering few opportunities to improvetheir performance through disk enhancements.andM;Excel and Quattro Pro can be significantly enhanced by running them entirelyfrom a RAM drive.andP;  By the time you've bought 5 or 6MB of expanded RAM to pullit off, however, you'd be better off looking for an accelerator or a newmotherboard.andM;For a significant increase in spreadsheet speed, you need a numericcoprocessor.andP;  The chip is designed to handle the type of number crunchingthat spreadsheets do while taking some of the processing burden off the mainmicroprocessor.andP;  Recalculating a 1,500-cell spreadsheet on an 8MHz 286 PCtypically takes 17 seconds without a math coprocessor, but only 11 secondswith one.andM;Another simple way to make your spreadsheets faster is to create macros foroperations that you perform regularly.andP;  Not only is it faster to executemacros than it is to type commands manually, but macros also eliminate typingmistakes that invariably seem to proliferate under the pressure of adeadline.andM;Take advantage of the ability to link worksheets-a feature available in newerversions of electronic spreadsheets-to get your spreadsheet work done sooner.andO;Break your big tasks into several smaller spreadsheets that use links to pullinformation out of one another only when it's needed.andP;  The smaller worksheetscalculate faster, and you can move through them easily without getting lost.andM;Microsoft EXCELandM;Files to use with RAM drive:andM;EXCEL-.- (program); *.FON (fonts);andM;WIN200.OVL, WIN200.BIN (WindowsandM;overlays).andM;Switches: None.andM;SETUPandM;Free as much memory as possibleandM;by removing memory-resident programsandM;and disabling network optionsandM;such as e-mail.andP;  If you have atandM;least 1MB of RAM, include theandM;line DEVICE = HIMEM.SYS as theandM;first line in your CONFIG.SYS file toandM;access memory above 640K.andP;  If youandM;add memory, use MEMSET.EXE toandM;obtain optimum configuration ofandM;memory.andM;In your CONFIG.SYS file, installandM;the Windows disk-caching deviceandM;driver, SMARTDRV.SYS, and add theandM;following line to use the disk cacheandM;with extended memory:andM;DEVICE=andM;C:\WINDOWS\SMARTDRV.SYSandM;384andM;(The 384 figure will vary dependingandM;on how much memoryandM;you have.) Add /A to the line if youandM;want Windows to use expandedandM;memory instead.andM;Once you move the files to theandM;RAM drive, edit WIN.INI to reflectandM;the changes.andP;  Assuming the RAMandM;drive is D:, change the extensionandM;statements to:andM;XLS=D:\EXCE^XLSandM;XLC=D:\EXCEL.^XLCandM;XLW=D:\EXCEL.EXE^XLWandM;XLM=D:\EXCEL.EXE^XLMandM;This will let Windows run theandM;RAM drive-based Excel applicationandM;whenever you double-click onandM;an xL? file.andM;FONTS IN RAM DRIVEandM;You must teff Windows where theandM;fonts are.andP;  Change the drive inandM;WIN.INI for each font.andP;  For example:andM;[FONTS]andM;HELV 8,10,12,14,18,24andM;(SET #3)=D:\HELVBandM;SYMBOL 8,10,12,14,18,24 (SETandM;#3)=D:\SYMBOLBandM;COURIER 8,10,12 (SET  3)=andM;D:\COURBandM;TMS RMN 8,10,12,14,18,24 (SETandM;#3)=D:\TMSRBandM;ROMAN (SET #1)=D:\ROMANandM;EXTENDED MEMORYandM;If you have a 386 PC with extendedandM;memory, use a utility such asandM;Quarterdeck's QEMM to convertandM;extended to expanded memory.andM;MISCELLANEOUSandM;Order &quot;Getting the Most fromandM;Your Hardware with MicrosoftandM;Excel&quot; for tips on specific hardwareandM;configurations.andP;  Order form isandM;included with Excel.andM;Lotus 1-2-3andM;Files to use with RAM drive:andM;Release 1 and 2, none.andM;Release 3, all except  .WK3.andP;  Release 3andM;uses overlays but expects them to beandM;in the same directory from which youandM;started 1-2-3.andP;  (See Setup.)andM;Switches: None.andM;SETUPandM;Release 3.andP;  Calculate the size of yourandM;worksheet in memory and allow anandM;additional 1MB for the programandM;code; this will prevent 1-2-3 fromandM;accessing the hard drive for overlays.andM;Set the Worksheet GlobalandM;Default Temp directory (/WGDT)andM;to a RAM drive for faster operations,andM;especially with large dataandM;-bases.andP;  If you don't have enoughandM;memory for a RAM drive, set theandM;Temp directory to an empty directoryandM;on your hard disk to avoidandM;disk fragmentation to your programandM;files.andM;You must copy all Release 3 filesandM;to a RAM drive to make it use theandM;RAM disk for overlays.andM;RECALCandM;All releases.andP;  Activate manual recalc.andM;In automatic recalc mode, theandM;spreadsheet recalculates every formulaandM;that needs recalculationandM;when you change a cell's contents.andM;In manual recalc mode, the softwareandM;doesn't update until you requestandM;it.andP;  Warning: don't assume theandM;values that appear in the worksheetandM;are correct while you're workingandM;with automatic recalculationandM;disabled.andM;There are a few tricks you canandM;use to avoid long waits while updatingandM;in manual recalc mode.andP;  IfandM;you know that a particular formulaandM;refers to recently updated cells,andM;you can reveal the formula's currentandM;value by moving the cellandM;pointer to the formula, pressing theandM;Edit key (F2), and then pressingandM;Enter.andP;  But if any of the cells onandM;which this formula relies do not reflectandM;their current values, the resultandM;of editing this cell may beandM;inaccurate.andM;To update a range of formulas,andM;copy the range onto itself.andP;  For example,andM;suppose that six formulas inandM;range B9..D10 refer to values inandM;range B1..D7.andP;  While in manual recalcandM;mode, you've altered some ofandM;the entries in range B1..D7 so thatandM;the formulas in B9..D10 are noandM;longer accurate.andP;  Press the slash keyandM;and select Copy.andP;  Indicate rangeandM;B9..D10 as the range to copy from,andM;and indicate cell B9 as the range toandM;copy to.andP;  You've updated the six-cellandM;range without recalculating theandM;entire spreadsheet.andM;Change formulas to numbers forandM;results of calculations that will noandM;longer change; position pointer onandM;cell, press F2, F9, and Enter.andM;Release 3.andP;  Write macros to takeandM;advantage of minimal natural orderandM;recalculation.andM;LINKINGandM;Releases 2.2 to 3.andP;  Link to severalandM;small files rather than a few largeandM;ones.andM;FILE FORMATandM;All releases.andP;  Name your most frequentlyandM;used file AUT0123, and 1-2andM;-3 will load it automatically eachandM;time you run the program.andM;Release 3.andP;  Save files in wK3 formatandM;so they can be loaded faster.andM;FUNCTIONSandM;Release 2.2.andP;  Use Enhanced StepandM;-Mode Debugger to improve applicationandM;development.andP;  Use LibraryandM;Manager to develop and maintainandM;commonly used macros.andM;Releases 2.2 to 3: Use RangeandM;Search/Replace to modify macros,andM;formulas, and text in many cells.andM;Release 3.andP;  Use aggregate columnandM;and row functions instead of DatabaseandM;@ functions to summarizeandM;subsets of records.andP;  Use Data QueryandM;Modify Extract (/DQME) and ReplaceandM;(/DQMR) instead of modifyingandM;records one by one.andP;  Use DatabaseandM;join to query multiple tables.andP;  UseandM;Data External to access more thanandM;8,192 records.andP;  Take advantage ofandM;the ability to have up to 512 charactersandM;in a cell to consolidate complexandM;formulas in macros andandM;templates.andM;UPGRADINGandM;Upgrading from Release 2.01 toandM;2.2 will increase the speed of 60andM;percent of the features.andM;WHAT TO AVOIDandM;Release 3.andP;  Leaving unused worksheetsandM;in memory.andP;  Using the /sandM;(System) command under lowandM;memory conditions because thatandM;removes overlays from memory.andM;QuattroandM;Files to use with RAM drive:andM;All or none.andP;  (Expanded memory isandM;used automatically for segments ofandM;code known as  objects,&quot; a more versatileandM;form of overlays.)andM;Switches: None.andM;SETUPandM;Use conventional RAM before usingandM;expanded memory.andP;  At the OptionsandM;Other Expanded Memory selection,andM;choose None or Format toandM;store less in EMS.andP;  Set the OptionsandM;Other Macro selection to Both toandM;suppress redrawing of windowsandM;and menus during macro execution.andM;Under Options Display mode,andM;use a text display mode rather thanandM;graphics.andP;  Set Failure Protection inandM;Transcript so that your actions areandM;written to disk less often or disableandM;it by setting Max History LengthandM;in Transcript to zero.andM;DISK SPACEandM;Quattro works faster if you reserveandM;plenty of hard disk space for it.andM;Delete old files or compressandM;spreadsheets by saving them with aandM;compression extension.andM;FORMATTINGandM;Convert formulas to values with theandM;Edit Values command if you don'tandM;expect their results to change.andM;Don't preformat large areas of theandM;spreadsheet.andP;  Set global formats toandM;the ones you use most often and useandM;the Style format command toandM;change only those blocks that differandM;from the global setting.andM;DISPLAYandM;Use 80-by-25 mode rather thanandM;80-by-43.andM;LINKINGandM;Break large spreadsheets into severalandM;smaller linked spreadsheetsandM;and load only one at a time.andM;FONTSandM;Each font takes about a minute toandM;generate.andP;  Generate fonts beforeandM;you need them, preferably whenandM;you install Quattro.andM;WHAT TO AVOIDandM;Conditional colors, which slowandM;displays.andM;VP-PlannerandM;Files to use with RAM drive:andM;VP-Planner, all files.andM;VP-Planner Plus, all files.andM;VP-Planner 3-D, overlay files are chosenandM;automatically (see Setup).andM;Switches: None.andM;SETUPandM;VP-Planner.- Use the WorksheetandM;Only menu option.andM;Planner 3-D: To use a RAMandM;drive for overlays, select WorksheetandM;Global Default Hardware Disk andandM;enter the letter of your RAM drive.andM;RECALCandM;Planner Plus 2.0 or later.andP;  Set recalculationandM;to natural, so that all recalculationandM;will be done in theandM;background.andM;Planner Plus 2.0 or later and 3-D.andM;-Remove all calc and recalc commandsandM;from your macros.andP;  In 3-DandM;you can use the search-and-replaceandM;feature to edit the macros.andM;FUNCTIONSandM;Planner Plus 2.0 or later andandM;3-D.- Turn off the undo featureandM;(Worksheet Global Default OtherandM;Undo 0).andM;PRINTINGandM;Use background printing.andP;  For allandM;versions you can select backgroundandM;printing for any one spreadsheet.andM;For Planner Plus 1.0 or later andandM;3-D, set background printing asandM;the default with Worksheet GlobalandM;Default Printer Other Background.andM;RAM Drive OverlaysandM;An underused DOS feature combined with program overlays  is a quickpick-me-up for sluggish software.andM;How Overlays WorkandM;1.andP;  A program with more code than can be contained in the available RAM loadsthe main section of its program code into RAM and reserves another area ofmemory for later use.andM;2.andP;  When the program needs to use other features that are not already in RAM,it reads a section of code called an overlay from the disk and loads it intothe area of memory it had reserved earlier.andP;  Typical overlays include a helpsystem, a spell-checker, a graphics editor, and printing utilities.andM;3.andP;  When the program needs to use a different overlay, it reads that sectionof code into the same area of reserved RAM, replacing the previous overlay.andM;A RAM drive is system memory that behaves like a very fast disk drive.andP;  Evenfolks who know about it rarely put a RAM drive to its best use.andM;Too often we use RAM drives only for small programs because the biggerprograms won't fit.andP;  Unfortunately, It's the big programs that tend to be theslow ones.andP;  But you don't need 5MB of RAM to Improve the speed of yourfavorite database or desktop publishing program.andP;  in many cases you can getby with a much smaller RAM drive that holds only the overlays that are usedby the software and that slow performance.andM;Many large applications are divided between one main section of code andseveral overlays, which contain routines that are swapped in and out ofmemory as needed.andP;  Some programs open configuration files and temporary areason the disk drive and update them as they work.andP;  While the processing thatgoes on inside your computer's microprocessor may be lightning-fast, everytime a program makes a trip to a mechanical disk drive for an overlay ortemporary file, everything comes to a haltandM;You can accelerate your software simply by copying the files the pro.andP;  gramaccesses most often to a RAM drive.andP;  The trick is in knowing which programfiles you need to put on the RAM drive.andP;  Check the accompanying lists ofspeedup tricks for the most popular programs to find out what overlays yoursoftware uses.andM;RAM DRIVE STRATEGIES Using overlays with a RAM drive requires more than justcopying files to IL You must develop a strategy that makes the most efficientuse of the RAM drive for particular programs.andP;  Plus, you need to set up DOSand your program so that the software knows where to find the overlays and sothat your data is protected in case of a power failure.andM;To make the most efficient use of your RAM drive, don't use it to run smallprograms that use no overlays and that you load only once a day.andP;  (Theexception to this rule is a small utility you use frequently or a DOS shell,such as Norton Commander or Central Point Software's PC Tools, that reloadsitself whenever you exit a program.)andM;You need to set up DOS and your program so that the software knows where tofind the overlays.andP;  This may be done in a setup procedure within the programitself or with a SET Statement in a batch file.andP;  Other programs require theiroverlays to be in the DOS PATH.andP;  And still other programs get the sameadvantages of a RAM disk by using expanded memory to hold overlays; theseprograms may require a  -switch on the command line when you load them totell them to use expanded memory.andP;  The accompanying speed tips note the useof any command switches.andP;  You should also check the installation proceduresin your software manuals.andM;WARNING Remember that RAM drives disappear when you turn off your PC.andP;  if youput a changing overlay file such as configuration information-on the RAMdrive, be sure to copy it back to your hard disk before you turn off yourmachine.andP;  For insurance, you can create a batch file that copies the overlaysto the RAM drive, executes the program, and copies the overlays back to yourmechanical disk when you exit the program.andM;For example, to get quicker results from PC-Write's spellchecker, you shouldput the dictionary in a RAM drive.andP;  To save any new words that you add to thedictionary, use the batch file below, which transfers PC-Write and its filesfrom drive C: to RAM drive D:.andP;  Running PC-Write's main program, ED, from theRAM drive lets it know where to find the spelling dictionary, WORDS.USE.) Thebatch file then loads PC-Write with a document name supplied at the DOScommand line through the replaceable parameter % 1 and copies the dictionaryback to the directory PCW on drive C: when you exit PC-Write.andM;COPY C:\PCW\*.* D:andM;D:andM;ED %1andM;COPY D:\WORDS.USE C:\PCWandM;C:andM;Generally it's not wise to work with data files on a RAM drive.andP;  if you losea configuration file that's in a RAM drive, it can be easily restored, butyou won't be able to recover the first draft of your annual report.andO;</TEXT></DOC>
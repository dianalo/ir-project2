<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF107-952-518  </DOCNO><DOCID>07 952 518.andM;</DOCID><JOURNAL>PC Magazine  Jan 16 1990 v9 n1 p287(7)* Full Text COPYRIGHT Ziff-Davis Publishing Co. 1990.andM;</JOURNAL><TITLE>Utilities: PCREMOTE lets you work at the office without leavinghome. (column)</TITLE><AUTHOR>Lahman, Terry.andO;AttFile:   PCMAG\V09N01\PCREMOTE.ASM;0 Program:  PCREMOTE.ASM  Assembly code.andO;PCMAG\V09N01\PCREMOTE.COM;2 Program:  PCREMOTE.COM  Access remote PC.andO;PCMAG\V09N01\PCREMOTE.DOC;0 Program:  PCREMOTE.DOC  Documentation.andM;</AUTHOR><SUMMARY>PCREMOTE allows a user to access and operate a remotely locatedcomputer via modem.andP;  The user just runs the program on the officemachine before going home and leaves the power turned on.andP;  Thisallows the user to call the office computer (host) from the homecomputer (remote).andP;  When the connection is made between the twosystems via modem and the password verified, keystrokes from theremote computer are sent to the host and data from the host isreceived and displayed on the remote screen.andP;  The program does notinterfere with the host system's normal operations.andP;  Its monitorand keyboard continue to function, allowing the user to put theprogram to additional uses.andP;  Reversal of the installationprocedure allows the user to demonstrate a program stored on thesystem.andP;  Guidelines for using the program are discussed.andM;</SUMMARY><DESCRIPT>Topic:     GuidelinesDesignSoftware packagesCommunicationTelecommunicationsTelecommutingTutorial.andO;Feature:   illustrationchart.andO;Caption:   Storing and retrieving data using a circular buffer. (chart)andM;</DESCRIPT><TEXT>Utilities PCREMOTE Lets You Work at the Office Without Leaving Home Do youever need to see a file from your hard disk in the office when you'recatching up on your work at home?andP;  Or do you ever wish that you could run aprogram that's on your office machine at home?andM;Now you can.andP;  PCREMOTE is a program (actually two programs in one) that letsyou access and operate a remotely located computer via modem.andP;  Just runPCREMOTE on your office machine before going home and leave the power turnedon.andP;  Thereafter, you'll be able to call your office computer and run itsprograms from your home keyboard and monitor.andM;For the purposes of this article, I'll call the office-based computer youwant to control the host computer.andP;  The home machine at whose keyboard you'llbe sitting will be called the remote computer.andP;  Using PCREMOTE, the remotecomputer will always access and operate the host computer.andM;After the modem link between the two machines has been made and your passwordverified, keystrokes from the remote computer are sent to the host, and videodata from the host is received and displayed on the remote screen.andP;  Inessence, the keyboard and screen of the remote machine function as if theywere the actual keyboard and screen of the host.andP;  To ensure that you'll beable to execute programs properly, care has been taken to see that allkeyboard shift status information is correctly sent from the remote to thehost computer; CapsLock, NumLock, ScrollLock, Alt, and Ctrl keys all functionnormally.andM;PCREMOTE does not interfere with the host's normal computer operations;indeed, its monitor and keyboard continue to function, allowing you to putPCREMOTE to additional uses.andP;  For example, you can use it to teach someone atanother site how to use an application program on his machine.andP;  The studentexecutes PCREMOTE, thus becoming the host.andP;  You then use the remote option ofPCREMOTE to call the student's computer.andP;  Once the two machines areconnected, data from either keyboard is accepted by the student's computer,and everything on the student's monitor is also displayed on the instructor'smonitor.andM;Alternatively, by reversing the installation procedure so that you are thehost and the student the remote (the previous host machine will have to berebooted to do this), you can demonstrate a program stored on your computer.andO;The student can then call your machine and test the program while the two ofyou examine its features together.andM;In deciding whether PCREMOTE will meet your needs, two limitations should beunderstood at the outset.andP;  First, the application programs you run remotelymust be text-based rather than graphics-based.andP;  Second, while PCREMOTE allowsyou to run programs and to access and use files on another machine, it doesnot let you transfer files back and forth between your home and officecomputers.andP;  To do that, you need a combined control and communicationsprogram such as Dynamic Microprocessor Associates' pcAnywhere.andM;Instructions for downloading a ready-to-run copy of PCREMOTE from PC MagNetare given in the sidebar &quot;PCREMOTE by Modem.&quot;andP;  Due to space considerations,we are not able to print the source code here.andP;  If you're interested inexamining or modifying the program's source code, you can download the filePCREMOTE.andP;  ASM from PC MagNet.andP;  You also can get both the assembly and BASIClistings by mail or fax by sending a written request with your name, address,and fax number (if applicable) to Utilities, PC Magazine, One Park Avenue,New York, New York, 10016, Attention: Carolyn Falconer.andP;  (Note: estimated faxlength is about 35 pages.)andP;  No phone calls, please.andM;To assemble PCREMOTE from its source code requires a macro assembler (IBM orMicrosoft, Version 2 or later) and the following commands:andM;MASM DEBUGSCR; LINK DEBUGSCR; EXE2BIN DEBUGSCR DEBUGSCR.COMandM;USING PCREMOTEandM;As noted above, PCREMOTE is actually two programs in one.andP;  The &quot;unattended&quot;mode of the program is run on the host computer that will be accessed from aremote site.andP;  The &quot;manned&quot; mode is run on the remote computer that willinitiate calls to the host.andP;  The relevant mode is selected as part of theprogram's syntax, as follows:andM;PCREMOTE [/M] [/2] [/F] [/D]andM;If you enter the above without the /M switch parameter, PCREMOTE will defaultto the unattended mode of program operation and will install itself as aRAM-resident program running in the background.andP;  As explained below,PCREMOTE/M is used to execute the program in its manned mode--that is, fromthe remote computer.andM;PCREMOTE recognizes three additional command-line switches, which are used totoggle the program's default parameters.andP;  The program defaults to1,200-bit-per-second operation through the COM1 port.andP;  Using the /2 switchcauses the program to use COM2.andP;  The /F (fast) switch tells PCREMOTE to use2,400 rather than 1,200 bps.andP;  If PCREMOTE is configured for 2,400-bpsoperation using a 2,400-bps modem, it will accept calls at either 1,200 or2,400 bps.andP;  The /D option is used only when running the program on a machineequipped with a CGA video board that exhibits snow when executing PCREMOTE.andO;The switch enables desnow logic, though at the cost of some screen-writingspeed.andM;When you execute PCREMOTE with the /M switch, it will initialize the modemand ask you for the phone number of the remote computer.andP;  After the modemshave connected, the screen will be cleared and you will be presented with an&quot;Enter password:&quot; prompt.andP;  You are given three tries to enter the correctpassword.andP;  The default password provided with the program is PC MAGAZINE.andO;(You can change the password before running the program, using the procedurethat is described later in this article under the heading &quot;Customization.&quot;andO;There is enough space allowed for a password of up to 20 characters.)andM;When the correct password is entered, the host computer begins to update thescreen of the remote computer so that the two displays are the same.andP;  You canenter data at any time, even while the screen is being updated.andM;Once your work on the host computer has been completed, you can exit PCREMOTEby hitting Alt-x, which brings up a window to confirm that you want to exit.andO;Answering anything other than yes here will return you to PCREMOTE.andP;  EnteringY sends the Alt-x keystrokes to the unattended computer, and both programsthen hang up their phones and reinitialize their modems.andP;  The screen on theremote computer will be blanked, and the host computer will return to DOS.andM;Remember, however, that exiting PCREMOTE will not affect any program runningon the host computer in unattended mode.andP;  To keep your phone bill down, it'spossible to start a task on the host computer and exit PCREMOTE, letting theprocessing finish on the host while you do something else.andP;  You can call thehost computer at intervals to see whether it's through.andM;There's one potential problem you might encounter when printing a documentfrom the remote computer: running out of paper.andP;  Always make sure that youroffice printer's paper supply is well stocked before leaving it unattended.andM;PCREMOTE has been tested and found compatible with a variety of popularprograms, including Lotus 1-2-3, The Norton Utilities, dBASE III Plus anddBASE IV, Microsoft Word, WordStar, WordPerfect, and PC Tools Deluxe.andP;  Theone caution to observe is to make sure that programs such as Microsoft Word,which can run in either graphics or text mode, are properly switched to textmode.andP;  If they aren't, you'll get either a blank screen or garbage and itwill be very difficult to return to text mode.andP;  Obviously, this also meansthat it is not possible to run Windows and similar software.andP;  Also bear inmind that some programs, such as Lotus 1-2-3, create their own cursors.andP;  Thismeans that you will be entering data without the aid of a cursor duringediting of cell entries.andM;Some RAM-resident programs on the host computer will not operate because theyrequire activation through interrupt 9, the keyboard hardware interrupt.andP;  Onthe other hand, both SideKick and SideKick Plus pop up normally on the hostcomputer and are properly displayed on the remote computer.andM;The way in which remote screen updating takes place will at first seemstrange, so you should start by experimenting with some familiar programs.andO;Try issuing the DIR command, for example.andP;  You'll find that scrolling changesonly the top line or two until the computer stops scrolling, but at thatpoint the screen will be properly displayed.andM;Perhaps the hardest thing to get used to, however, will be having to rememberthat everything you do is actually being performed on the host computer, noton the machine at which you're sitting.andP;  The DIR command, for example, willdisplay the directory of the other computer's disk.andP;  To regain direct accessto your own machine, you'll have to exit PCREMOTE.andM;If you are using a 1,200-bps modem, you should be sure to read the section&quot;Data Carrier Detect&quot; below.andP;  If for some reason the Data Carrier Detect(DCD) signal is not enabled, your computer may seem to lock up.andP;  The sectionon Data Carrier Detect desribes how to ensure that your modem is properlyconfigured.andM;HOW PCREMOTE WORKSandM;In understanding PCREMOTE, the place to start is with the timer tick.andP;  Thesystem hardware timer generates an interrupt 18.2 times per second.andP;  Changingthe timer interrupt so that it executes PCREMOTE is the only reliable way toenter the host-resident portion of PCREMOTE.andM;The interrupt 8 handler executes the old interrupt routine and checks to seeif the host program is active.andP;  If not, it sets the active flag and checks tosee if the remote system is connected.andP;  If there is no connection, theCONNECT UNATTENDED routine is executed to check for a connection and requestthe password.andP;  A correct password leaves the connect flag set and exits theCONNECT UNATTENDED routine.andP;  If the connect flag is set, the UNATTENDEDroutine is executed.andM;The CONNECT UNATTENDED routine checks for a carrier signal and, if one ispresent, it goes on to check for carriage return codes.andP;  If 5 out of 10 bytesare not carriage return codes, the routine assumes it must switch to 1,200bps.andP;  This provides a method of automatic bps rate detection when using a2,400-bps modem.andP;  The remote system sends 20 carriage returns at 1-secondintervals to provide the bps rate synchronization.andP;  The host system sends the&quot;Enter password:&quot; message and waits for the password.andP;  The unattended systemwill send 5 NULL codes after it verifies the correct password.andP;  These NULLcodes cause the manned system to branch into the manned routine to processvideo data and keystrokes for normal PCREMOTE communications.andM;After the connection is established, the &quot;Enter password:&quot; message is sent tothe manned computer, where it is received and checked.andP;  IF the password iscorrect, the routine is exited, leaving the connect flag set.andP;  Otherwise, thephone is hung up and the modem is reinitialized.andP;  During the password checks,the carrier signal is monitored for loss of carrier.andP;  This prevents systemlock-up if someone calls the system by mistake.andM;The UNATTENDED routine compares video RAM with a video RAM copy to determineif any changes have occurred in the video data.andP;  A change creates a 16-byteblock of character of attribute data for transmission to the remote system.andO;18 bytes of data are kept in the output buffer to ensure that enough data isalways available for transmission to the remote system between timer ticks.andO;At 2,400 bps, approximately 13 bytes of data can be transmitted between timerticks.andM;The INPUT PROCESSING routine decodes the data being sent from the remotecomputer and puts it into the host machine's keyboard buffer.andP;  A loss ofcarrier or receipt of Alt-x hangs up the modem and resets the unattendedportion of PCREMOTE.andM;CIRCULAR BUFFERSandM;PCREMOTE makes use of two circular buffers: one for incoming data and theother for data to be sent through the serial port.andP;  Each buffer has fourpointers: head, tail, begin, and end.andP;  When the head pointer equals the tailpointer, the buffer is empty.andP;  Data is stored in each location pointed to bythe tail pointer.andP;  Data is retrieved sequentially, starting at the locationpointed to by the head pointer.andM;As data is stored and retrieved, the appropriate head or tail pointer isincremented to the next memory location.andP;  If this exceeds the end of thereserved memory space, the pointer is set to the beginning of the buffer,thus creating a circular buffer.andP;  If the tail is one less than the head, thenthe buffer is full.andM;The diagram in Figure 1 shows how the characters SEND DATA are stored in acircular buffer.andP;  The S is stored in the location pointed to by the tailpointer, which is then incremented by one.andP;  This process is continued untilall of the characters are stored in the buffer.andP;  Note that when the tailpointer is equal to the end pointer, the tail is reset to the same value asthe begin, which causes the data being stored to wrap around in a circularfashion.andM;To get data out of the buffer, the head pointer is used.andP;  As the data isretrieved, the head pointer is incremented.andP;  This process can be continueduntil the head pointer is equal to the tail pointer, at which point thebuffer is empty.andM;The two buffers are serviced by two routines.andP;  GET BUFF DATA retrieves datafrom a buffer, and PUT BUFF DATA stores data in a buffer.andP;  The AH register isused to indicate whether the input or the output buffer is to be used.andP;  Theavailability of data in the GET BUFF DATA routine is indicated by the carryflag.andP;  The PUT BUFF DATA uses the carry flag to signal that the output bufferis full.andM;THE KEYBOARDandM;Keyboard data from the remote system is formatted before being sent to thehost computer.andP;  First, the value FEh is sent, which tells PCREMOTE that thenext 2 bytes contain keyboard data.andP;  The next byte contains the ASCII code,and the last byte contains the scan code.andP;  After decoding, this data is putinto the keyboard buffer of the host computer, where even programs that donot make use of the BIOS services will be able to access it.andM;If the shift status changes, an FDh value is sent to indicate that the nextbyte contains shift status data.andP;  This is stored in address 0040:0017H of thehost computer, which is the address of the BIOS data area that containscurrent shift-key status information.andP;  Keeping this information updatedensures that the host computer always has the correct shift-key information.andM;The keyboard buffer maintained by the BIOS is also a circular buffer.andP;  Thehead pointer is stored at address 0040:001AH and the tail pointer is storedat address 0040:001CH.andP;  The buffer itself begins at address 0040:001EH andends at address 0040:003EH.andP;  Keyboard data from the manned (remote) computeris put into the keyboard buffer of the most through a routine that is similarto the PUT BUFF DATA routine listed in the source code.andM;INTERRUPT-DRIVEN I/OandM;The COM port interrupt service routine reads the interrupt ID register todetermine whether the interrupt is being caused by receive data or bytransmit buffer empty.andP;  Receive data is stored in the input buffer.andP;  Transmitbuffer empty gets a byte of data from the output buffer and sends it to theCOM port.andP;  If the output buffer is empty, the COMM INT STA flag is reset.andO;When data is placed into the output buffer, the COMM INT STA flag is checked.andO;If it is reset, data is forced out of the COM port.andP;  This has the effect of&quot;kick starting&quot; the transmit interrupt.andM;VIDEO FORMATTINGandM;Video data from the host is formatted before being sent to the remotecomputer.andP;  The standard 25-row by 80-column display requires 4,000 memorylocations for storage.andP;  Each character displayed requires 2 bytes ofinformation.andP;  The first byte in memory is the ASCII character to bedisplayed, and the second is the &quot;attribute&quot; of the character.andP;  The attributebyte defines the foreground color, background color, intensity, and blinkattributes of the character.andM;Data is sent to the remote system in blocks, and a block is made up ofcharacter data or attribute data.andP;  In the host computer, a block of 16 wordsis read from the video RAM and compared byte by byte with the video copymaintained by PCREMOTE.andP;  If the data doesn't match, a loop counter determinesif it is character data or attribute data.andP;  The transfer block routine sendsthe appropriate sync byte--FFh for attribute data.andP;  FEh for character data.andO;The block number is sent after the sync byte to identify the location of theblock in memory.andP;  The block number is followed by the 16 bytes of data fromthe block.andM;The first byte of video data sent to the remote system provides a method ofsynchronization between the two systems.andP;  Noise on the phone line betweenblocks will be ignored by the remote system.andP;  The least significant bit ofthe sync byte is used by the remote system to address character data orattribute data in the remote video RAM.andP;  The remote system multiplies theblock number by twice the block size to determine the video RAM address ofthe block.andM;The host program also checks the current cursor position with the last knownposition of the cursor.andP;  If the position is different, the new position issent to the remote computer.andP;  The sync byte D2h is sent first, followed bythe cursor column and the row.andP;  The remote system decodes the data and usesthe BIOS video interrupt to set its cursor position correctly.andM;CGA SNOWandM;PCREMOTE accesses video RAM directly on the host and remote computers, andthis can cause &quot;snow&quot; when used with certain CGA cards.andP;  If you encounterthis problem, simply add the /D switch to the command line when you executePCREMOTE.andP;  When the &quot;de-snow&quot; option is used on the host computer, it slowsthe program slightly; this is because during the block transfer from videoRAM, the program waits for horizontal sync before transferring a byte of datafrom the video RAM.andP;  Using the de-snow option is necessary only if someonewill be watching the screen of the host computer--during a training session,for example.andP;  Using the de-snow option on the remote computer does not affectprogram execution speed.andM;CUSTOMIZATIONandM;If the default exit hotkey (Alt-x) conflicts with one of your TSR programs,you can change to another Alt-key combination with DEBUG.andP;  The hexadecimalscan code for PCREMOTE's exit is stored at address 21 Ch.andP;  Using the DEBUGcommands shown in Figure 2, you can change the exit key from Alt-x to any ofthe other alpha characters by substituting the appropriate hexadecimal scancode.andM;You will also need to use DEBUG to change your password from the default PCMAGAZINE to something more secure.andP;  The program will accommodate a passwordof up to 20 characters.andP;  When making your changes with DEBUG, be sure toenter the new password in uppercase, as PCREMOTE converts any password itreceives from the remote computer to uppercase.andM;In addition to entering the new password itself, you must update the size ofthe password so that the program will know how many characters are to bechecked.andP;  The password is stored at address 1F3h, and the size of thepassword is stored at address 1F1h.andP;  The DEBUG script in Figure 3 shows thesequence of DEBUG commands required.andP;  The example shown in Figure 3 changesthe password from PCMAGAZINE to NEWPASSWORD.andM;DATA CARRIER DETECTandM;Data Carrier Detect (DCD) is a signal sent from a modem to a computer thatindicates the status of the modem carrier.andP;  When a carrier is present, DCDwill be active, indicating that two modems are communicating via a phoneline.andP;  When the carrier is lost, DCD will become inactive.andP;  PCREMOTE requiresthat you configure your modem DCD setting to follow the status of thecarrier.andM;Most 1,200-bps modems have a switch that lets the DCD line be set either tofollow the carrier condition or to force DCD true (on).andP;  Make sure yourmodem's switch is set so that DCD follows the carrier.andP;  If instead you setthe switch to force the DCD signal true (on), PCREMOTE will appear to lockthe computer when you load the program in host mode.andP;  The reason is thtPCREMOTE will think it is connected to a remote system and will wait for apassword that never arrives.andM;In the remote mode, the same mistake will cause the screen to go blank rightafter you enter the phone number instead of waiting until the modems connect.andM;For a Hayes Smartmodem 1200, switch 6 must be up to enable DCD.andP;  The DCDsignal for 2,400-bps modems is programmable.andP;  The andamp;C1 in the MODEM__SETUP3string is the command that enables DCD to follow the carrier.andP;  Modemsoperating at 1,200 bps will ignore this command.andM;In the host mode, PCREMOTE tests DCD after each timer tick to see if aconnection with a modem has been established.andP;  In the remote mode, PCREMOTEtests DCD to see if the host computer has answered the phone.andP;  During phonecommunications, both modes of operation continually check DCD for loss ofcarrier.andP;  If phone communication is interrupted, PCREMOTE will reinitializethe modems and, in the host mode, will test for the next incoming call.andM;ENHANCEMENTSandM;Because PCREMOTE was originally designed to attach a remote terminal to ahost computer, I included no provisions for communicating with the actualremote PC at which you will be working.andP;  Thus, while running PCREMOTE, youcannot access any of the floppy disks or hard drives on the remote machine.andO;That's why you cannot exchange files between the two systems.andP;  You cannotdownload from the host to the remote computer, and you cannot upload from theremote computer to the host.andP;  For the purposes for which PCREMOTE wasdesigned, these additional functions were simply not needed.andM;The additional functionality can certainly be added to PCREMOTE, but to do sowould go beyond the scope of this article.andP;  Readers who follow theprogramming aspects of PCREMOTE can certainly try adding such functionality,and perhaps if there's interest enough, I'll add this feature to a futureversion of PCREMOTE.andM;Observant readers will no doubt have noticed that several of our recentutilities have dealt with communication via modem and phone line.andP;  With thecost of reliable modems hovering between $55 to $60, the message shouldsurely be clear.andP;  If you haven't done so, it's time to embrace communicationby electronic means.andM;PC MagNet, MCI Mail, CompuServe, BIX, and the many local bulletin boardsthroughout the country will open up a new world--there's a lot of worthwhileexploring to be done.andP;  One of the goals is to demystify the traditional (andoften imaginary) difficulties associated with the topic of communications.andO;Toward that end, we look forward to seeing your letters--with ideas andsuggestions for communications-based utilities, as well as with your commentsand questions.andM;Terry Lahman is manager of customer support for Dataproducts Corp. ofWoodland Hills, California.andO;</TEXT></DOC>
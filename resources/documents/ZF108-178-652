<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF108-178-652  </DOCNO><DOCID>08 178 652.andM;</DOCID><JOURNAL>Data Based Advisor  Jan 1990 v8 n1 p46(3)* Full Text COPYRIGHT Data Based Solutions 1990.andM;</JOURNAL><TITLE>First program. (use of Control Center)(dBASE IV Primer) (tutorial)</TITLE><AUTHOR>Rubel, Malcolm C.andM;</AUTHOR><SUMMARY>Instructions are given on entering invoice data in a dBASE IVsystem.andP;  Some tasks cannot be performed through dBASE IV's ControlCenter, only through writing a program.andP;  Fortunately, smallprograms can be written in dBASE IV.andP;  Great power exists in dBASEIV outside the Control Center.andM;</SUMMARY><DESCRIPT>Product:   dBASE IV (Data base management system) (programming).andO;Topic:     TutorialData Base Management SystemsData Base MaintenanceBilling-InvoicingProgramming Instruction.andM;</DESCRIPT><TEXT>First ProgramandM;Last month I asked you to write data between files, in particular from theCUSTOMER table to INV HEAD, and from INV HEAD to the INVOICE detail table.andO;With any experimentation, you'd have discovered that the Control Centerdoesn't help much.andP;  What works well for a single file database system may notfor multiple files--because of the way Ashton-Tate set up file linkingthrough the Query panel.andP;  While you can link several files together, youcan't edit information inside a view.andP;  You also won't be able to take thevalue of a field in one database and write it to a location in the second.andM;You could also perform update queries, writing groups of information from onefile to another.andP;  But you'd need to create temporary files as place holdersfor the work in progress.andP;  This method doesn't always work either.andP;  Itdoesn't mean you can't relate files and write informantion from one toanother.andP;  It's just easier to leave the Control Center to handle it.andM;Remember, this month we wanted to enter invoice data in our system.andP;  Thelogical place to start is in the Customer database, but it's not.andP;  Thereverse is actually better.andP;  We'll first fill out the invoice detail and findout which customer is ordering, then create an invoice header record to goalong with the order.andM;The invoice detailandM;We'll create a special query form for entering invoice detail.andP;  We could usethe INVOICE file, but a special query works better.andP;  Begin by activating theINVOICE database.andP;  Next, go to the Queries work surface and create a newquery.andP;  Notice that the INVOICE file is already opened in the design surface.andO;Press F4 to enter the View Skeleton at the bottom of the screen, and then F5to remove the INVOCE_NO field from the view skeleton.andP;  We also want to add acalculated field for the extended price (just like last month).andP;  Your queryshould look like Fig.andP;  1.andM;You may be asking yourself, why did we get rid of the INVOICE NO field?andP;  Andwhat are we doing with this query now that we've developed it?andP;  Because thisquery contains a single file, dBASE IV lets us append records (invoice items)to the file in the view.andP;  Press F2 to see what I mean.andP;  To add new records,press Alt-R (Records), then A.andP;  You're now in append mode.andP;  However, becausethe INVOICE NO field isn't in view, you can't enter information in it.andP;  We'llenter this in a new and different way.andM;Before continuing, we need to add invoice detail records to the file forlater work.andP;  Fig.andP;  2 shows what the Browse table looks like with the invoicedata added.andM;After entering the data shown in Fig.andP;  2, press Alt-E, then Enter.andP;  Youshould be back at the Control Center.andP;  Go back and activate the INVOICE fileto see what we've done.andP;  It should look like Fig.andP;  3.andP;  If not, try it again.andM;Note that the last four records in the INVOICE file don't have any data inthe INVOICE NO field.andP;  This situation will be remedied shortly.andM;Note that the last four records in the INVOICE file don't have any data inthe INVOICE NO field.andP;  This situation will be remedied shortly.andM;Getting data from A to BandM;It's here that we come up against a weakness in the dBASE IV Control Center.andO;We want to find the customer who placed the order in the CUSTOMER file.andP;  Ifthe order is from a new customer, then we'll create a new record in theCUSTOMER file before continuing and copy the appropriate customer number tothe INV HEAD file for the completed invoice.andP;  The last step is to write theinvoice number (which we'll create in the INV HEAD file) to each record inthe detail file just entered.andP;  Unfortunately, you can't do it from within theControl Center.andP;  You'll see why in a moment.andM;Go to the Data panel and open up the CUSTOMER database.andP;  Press PgDn and findthe Customer you're looking for.andP;  I want Customer number &quot; 7,&quot; Theresa P.andO;Williamson.andP;  How do I get the customer number into the INV HEAD file?andO;Closing the CUSTOMER file loses my place marker.andP;  I could simply remember thecustomer number and type it into my INV HEAD file when open.andP;  But thatpractice relies on good memory.andP;  Besides, we'd have to go through the sameprocess when typing the invoice number on each record in the invoice detailfile.andP;  Don't try query updates; as I mentioned earlier, they don't work wellfor these cases.andP;  What are we going to do?andP;  Write a program!andP;  You'll besurprised at how easy it is.andM;Leave the selected record (the customer who just placed the order) in theCUSTOMER database and press Alt-E and Enter to return to the Control Center.andO;Press Alt-E and Enter again to leave the Control Center and return to the dotprompt.andP;  Don't worry, we'll return to the Control Center in awhile.andP;  Just forfun, type in:? alias().andP;  On the line below you should see the word,&quot;CUSTOMER,&quot; appear.andP;  This is the name of the open database.andP;  Type:? CUST ID.andO;On my screen the response is &quot; 7&quot;.andP;  Type in? LAST NAME.andP;  My customer file isstill open, and at the correct customer.andP;  The only difference is that I'm nowfree from the Control Center.andM;Getting ready to programandM;Type in MODIFY COMMAND MAKE INV and see what happens.andP;  Congratulations!andO;You're now in the dBASE IV program editor ready to edit your dBASE IVprogram, MAKE INV.andP;  If it looks like the memo editor, that's because it is.andO;Instead of writing to a memo field in a database, however, we'll write aprogram that dBASE IV will execute for us later.andP;  The program that you'llwrite is shown in Fig.andP;  4.andP;  Type it in yourself.andM;There may be only a few lines of code, but a lot is happening here.andP;  I'llexplain the program line by line.andM;The first line says &quot;SELECT 2.&quot;andP;  dBASE IV allows more than one data tableopen at once.andP;  We did this a few lessons ago when linking the databases, toget our view of the invoices.andP;  Our first work area is already open with theCUSTOMER file.andP;  We have to switch to an unused one to open a second file.andO;Otherwise, the first file would close when opening the second (and we needthat first file open to retrieve information from it).andP;  So &quot;SELECT 2&quot; tellsdBASE IV to move to the second work area.andM;The next line of code, &quot;USE inv head,&quot; opens the INV HEAD table in theselected work area.andP;  The third line APPENDs a blank record to the end of thefile; the order information will go here.andP;  The next three lines are REPLACEstatements.andP;  They write our data to the record just appended in the INV HEADfile.andP;  The first statement writes the customer number from the selectedrecord in the CUSTOMER file (still open in work area one) to the CUST IDfield in the INV HEAD database.andP;  We can still address the CUSTOMER file eventhough it's no longer in the active work area.andP;  This is accomplished by&quot;pointing&quot; to it with the &quot;CUSTOMER-andgt;&quot; preface at the field name.andP;  This tellsdBASE to look in the CUSTOMER file for what we want.andM;The second REPLACE statement creates the invoice number from the currentrecord number of the INV HEAD data table.andP;  &quot;str(recno(),6)&quot; changes thenumber into a character string for storing in the INVOICE NO field.andP;  The lastREPLACE puts the system date in the INV DATE field.andM;That finishes our work with the INV HEAD file.andP;  We can use this informationto complete the update of the INVOICE file.andM;Finishing the invoiceandM;Before using the INVOICE file let's move to a new work area.andP;  &quot;SELECT 3&quot;creates the thind work area.andP;  We can USE the INVOICE file now without closingour other two files (INV HEAD and CUSTOMER).andP;  We want to replace the INVOICENO field for those records just added, with the invoice number from the INVHEAD file.andP;  The REPLACE command with the FOR clause does this.andP;  That's whyit's important that no information be written in the INVOICE NO field.andP;  RheREPLACE command looks for empty records in this field, updating them with thenew invoice number.andM;The last part of the program closes down unnecessary files and passes controlback to the ASSIST mode.andP;  ASSIST actually returns us to the Control Center.andM;If you types in the commands carefully, when you press Alt-E and E (for run),you should see the program compile and run.andP;  When the program stops, you'llfind yourself back at the Control Center with the invoice completed.andM;ConclusionandM;What have we leared?andP;  That it's a good thing dBASE IV allows us to writesmall programs.andP;  Otherwise we'd have trouble with our invoice.andP;  You've alsoglimpsed some of the power existing outside the control Center.andP;  The power isgreat and, as we move along, we'll explore it in greater depth.andM;For next monthandM;At this point we can make out invoices, but there's a lot of keystrokinginvolved.andP;  As far as I'm concerned, too many.andP;  Next month we'll learn how toreduce the amount of typing the program requires by using the keyboard macrocapabilities of dBASE IV.andM;And one final thing.andP;  When we finish keyboard macros, we'll design a reportform to print out our invoice.andP;  I've left out a field in one of the datatables that's absolutely essential.andP;  What field is it, and which data tabledoes it belong in?andP;  That should keep you guessing.andM;Malcolm Rubel is president of Performance Dynamics Associates, a businessapplications consulting firm located in New York city.andP;  He is the author ofProgramming the dBASE III PLUS User Interface and dBASE IV Power Tools, bothfrom Bantam.andP;  He can be reached at (212) 972-2330.andO;</TEXT></DOC>
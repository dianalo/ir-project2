<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF207-841-820  </DOCNO><DOCID>07 841 820.andM;</DOCID><JOURNAL>Lotus  Nov 1989 v5 n11 p24(3)* Full Text COPYRIGHT Lotus Publishing Corporation 1989.andM;</JOURNAL><TITLE>Control your data. (extracting selected information from Lotus1-2-3 database) (Start Here) (column)</TITLE><AUTHOR>Gasteiger, Daniel.andM;</AUTHOR><SUMMARY>The Data Query Extract command in Lotus 1-2-3 can be used to copyspecified information from a Lotus database and place it in aseparate part of the worksheet.andP;  Reports can then be preparedwithout laborious searching through the database and re-enteringdata manually.andP;  A Criterion range must first be specified so Lotusknows what records to retrieve.andP;  An Output range will tell Lotuswhere on the worksheet to put the data once it is retrieved.andP;  Whenusing the Data Query Extract command, the user must remember thatall data below the Output range in the worksheet will be purgedafter the extraction is complete.andP;  If possible, the Output rangeshould be placed below all other worksheet data.andP;  If this is notpossible, the Output range should be two or more rows, dependingon the amount of output expected.andM;</SUMMARY><DESCRIPT>Product:   Lotus 1-2-3 (Spreadsheet software) (usage).andO;Topic:     TutorialData Bases.andM;</DESCRIPT><TEXT>CONTROL YOUR DATAandM;In the past two installments of this column we explored 1-2-3's databasefeatures.andP;  First we saw how to sort a database's records into alphabeticaland numerical order.andP;  Then we learned how to create a Criterion range to findspecific database records.andP;  This month we'll use the Data Query Extractcommand to copy selected information from a database.andM;DATABASE REVIEWandM;A database is a collection of related information.andP;  In 1-2-3, databaserecords are stored in individual rows.andP;  Each record contains informationabout a specific person, thing, or transaction.andP;  For example, a single recordmight contain employment and salary data for one employee.andM;Each database record is made up of fields, in which you store specific piecesof information.andP;  One field of an employee's record might contain his or herdate of hire.andP;  Another field might contain the employee's current salary.andP;  In1-2-3 each column of a database represents a field.andM;The following illustration shows a small 1-2-3 database that contains recordsin rows 5 through 12.andP;  The database has four fields: the Region field, theProduct field, and fields for October and November revenue.andM;You may have created and saved this database and its corresponding Criterionrange if you worked through last month's Start Here.andP;  If so, retrieve thefile.andP;  Erase any data that you entered in row 2 of the worksheet.andP;  Pressslash, select Range Erase, specify range A2..D2, and press Return.andP;  Then skipahead to the &quot;Set The Criterion&quot; section.andM;If you haven't created the database yet, start in a blank worksheet and enterthe labels and values shown in range A4..D12 of the figure.andP;  This is thedatabase Input range.andP;  Don't enter the dollar signs and commas that appearwith the numbers in columns C and D.andM;After you enter the values, use the Range Format command to assign a currencyformat with no decimal places to range C5..D12.andP;  To do this, press slash,select Range Format Currency, and enter 0.andP;  Then type C5..D12 and pressReturn.andP;  You've just created a 1-2-3 database.andM;Create the field names for the database's Criterion range by copying thedatabase field names to the first row of the worksheet.andP;  To do this, pressslash and select Copy.andP;   Indicate range A4..D4 as the range to copy from andcell A1 as the range to copy to.andM;SET THE CRITERIONandM;Suppose that you wish to prepare a report of October sales in the Southregion.andP;  You've already entered all the data available about these sales anddon't want to retype the information to create the report.andM;1-2-3 lets you copy selected information from the database into a separatearea of the worksheet.andP;  This way, you can prepare simple reports quicklywithout searching through the database or reentering information.andP;  To createthese reports, you must first prepare the Criterion range.andM;You may recall that we used a Criterion range in last month's article to helpus find selected records.andP;  Let's review the fundamentals of using a Criterionrange and see how we can use criteria to help extract selected records andcopy them to another part of the worksheet.andM;The Criterion range consists of no fewer than two rows.andP;  The first rowcontains field names that match the database field names.andP;  The second rowcontains criteria that a record must meet before 1-2-3 will include it in aData Query operation.andP;  A criterion might identify records with the word Southin the Region field or records whose October sales are greater than $25,000.andM;Enter a criterion into the second row of the Criterion range, row 2 of theworksheet.andP;  Because you're going to create a report of South region sales,you must enter the criterion in the Region column of the Criterion range.andO;Move the cell pointer to cell A2 and enter South.andM;Let's put our Criterion range to work.andP;  Press slash and select Data Query.andO;Select Input and enter A4..D12 (this will be the default for people workingwith last month's worksheet).andP;  Assigning the Input range tells 1-2-3 toperform all upcoming database operations using the data in range A4..D12.andO;Next select Criterion and indicate range A1..D2.andP;  This confirms that therecord-selecting criteria are in range A1..D2.andP;  Finally, select Find.andP;  Thecell pointer expands and highlights the first of the database entriesconcerning southern revenues.andM;Press the DownArrow and UpArrow keys to navigate from one matching entry toanother, then press Return when you're satisfied with your results.andP;  SelectQuit to return to Ready mode.andP;  We discussed the use of the Data Query Findcommand in depth in last month's column.andP;  As you will see, the Input andCriterion ranges that controlled the Data Query Find command don't have to bespecified again to use the Data Query Extract command.andM;CREATE THE REPORTandM;Little additional preparation is needed to extract records.andP;  The Data QueryExtract command creates a report of selected records.andP;  All that's left ispreparing a range to receive the information that we extract from thedatabase.andM;In this case, we're interested only in October's revenue for the South.andO;Because all of the records in our report will be from the same region, wedon't need the Region field.andP;  (If we were going to make a formal report, wecould insert a label such as October Sales for the South above the data weextract.)andP;  The extracted data should also exclude entries from the Nov field.andO;The Criterion range we set up will screen out the records for all regionsexcept South.andP;  Somehow, we also need to tell 1-2-3 to copy information fromonly the Product and Oct fields.andM;To do this, create an Output range.andP;  When you use the Data Query Extractcommand, 1-2-3 will copy selected records from the database into the Outputrange.andP;  Create the range by entering the label Product in cell A15.andP;  Thenenter the label Oct into cell B15.andP;  The field names in the Output andCriterion ranges must be spelled and punctuated exactly the same as they arein the Input range.andM;Select /Data Query Output and indicate range A15..B15.andP;  This tells 1-2-3 thatthe entries in cells A15 and B15 identify which database fields to copy fromthe database.andP;  You've already defined a Criterion range that tells 1-2-3 toextract only records that have the word South in the Region field.andM;Now select Extract.andP;  Immediately, 1-2-3 copies the South's revenue data foreach product into the cells directly beneath the Output range's field names.andO;Select Quit to exit the Data Query menu.andM;Suppose that you want the report to include November's revenues, as well asOctober's.andP;  Enter the field name Nov in cell C15, then reassign the Outputrange to include this new entry.andP;  Select /Data Query Output, press Escape,and indicate range A15..C15.andP;  This is the new Output range.andP;  When you selectExtract from the Data Query menu, 1-2-3 copies the newly requestedinformation, as shown above.andP;  After you choose Extract, select Quit.andM;Exercise caution when using the Data Query Extract command as we've describedit.andP;  When you assign an Output range that has only one row, 1-2-3 erasesevery entry in the cells below the Output range.andP;  No matter how small theextraction is, all data below the Output range is purged.andP;  A good habit,then, is to put the Output range below all other entries in a worksheet.andM;However, this can be impractical with large databases.andP;  If your databasecontains thousands of records, your Output range may not be large enough forsome extracts if you put it below the Input range.andM;You can prevent the loss of data below an Output range by specifying anOutput range of two or more rows.andP;  If you expect 1-2-3 to extract 25 recordsfrom the database, make the Output range at least 26 rows deep.andP;  The DataQuery Extract command erases everything in the Output range, but it does noterase cells below the Output range.andP;  The command then copies matching recordsfrom the database.andM;If the Output range has too few rows to hold all the matching records, 1-2-3informs you with the error message Too many records for Output range andstops copying.andP;  To clear the error, press the Escape key, then reassign anOutput range that has enough rows and reissue the command.andM;Sometimes you wish to limit the information that appears in a databaseextract.andP;  Suppose that you wish to see the records for only those regionswhose revenues from staples in October were more than $25,000.andM;Erase the criterion in the Region field of the Criterion range.andP;  Some peopleattempt to erase cells by entering a blank space.andP;  This does not truly erasethe data and may cause problems when using a database.andP;  If you clear a fieldin a Criterion range this way, the Data Query command matches records thathave blank labels.andP;  Select /Range Erase and specify cell A2 to erase the oldcriterion.andM;Now enter the label Staples in cell B2, and enter the formula +C5[is greaterthan]25000 in cell C2.andP;  The formula means the entry in cell C5 is greaterthan 25,000.andP;  This statement can be either true or false.andP;  If the statementis true, the criterion matches the first record and the formula returns 1.andO;If the statement is false, 1-2-3 sees no match and the formula returns 0.andO;The 1 in cell C2 tells you that, for the first record of the database, theresult of the formula is true.andP;  The value of cell C5 is greater than 25,000.andM;It is essential that the above formula refer to cell C5 instead of some othercell in column C.andP;  As 1-2-3 looks over the database records in a Data Querycommand, it acts as if each record is the first one below the field names.andO;When you issue the Data Query Extract command, 1-2-3 uses the formula in cellC2 to evaluate the entries in the Oct field one by one.andM;You need to change the fields in the Output range so that you can seeregional information.andP;  Since you are only looking for staples data, you canreplace the Product field with a Region field.andP;  Go to cell A15 and enter thelabel Region.andP;  Now select /Data Query Extract.andP;  1-2-3 erases the existingentries from the Output range and copies the staples records for the East andWest regions.andP;  Remember to save your worksheet for further practice.andM;Use your imagination to create some other complex criteria.andP;  If you wish tocompare values in a criterion, write the equation as we have done to comparea value with the first database entry of the field in question.andP;  For example,the formula +D5[is less than]20000 in cell D2 of the Criterion range willcause 1-2-3 to extract only the records that contain numbers lower than$20,000 in the Nov field.andP;  Make sure as you fiddle with new criteria that youerase any old criteria so that they don't interfere with the matchingprocess.andM;Daniel Gasteiger is a contributing editor to LOTUS and president of thesoftware firm Tenet Educational.andO;</TEXT></DOC>
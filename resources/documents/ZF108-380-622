<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF108-380-622  </DOCNO><DOCID>08 380 622.andM;</DOCID><JOURNAL>Data Based Advisor  May 1990 v8 n5 p43(5)* Full Text COPYRIGHT Data Based Solutions 1990.andM;</JOURNAL><TITLE>Become a QBE crackerjack. (query by example) (R:BASE Lab)(technical) (tutorial)</TITLE><AUTHOR>Litwin, Paul.andM;</AUTHOR><SUMMARY>The data base management system R:base 3.0 has improvedapplications program development tools including query by example(QBE).andP;  QBE is a visual query language which replaces the BROWSEand EDIT commands of previous versions of R:base.andP;  The tutorialshows how QBE is integrated into the rest of R:base 3.0 and howits three modules work.andP;  QBE can be accessed through several menusor through commands entered at the R prompt.andP;  It enables thedeveloper to create, modify, execute and print single andmultiple-table queries.andP;  QBE includes sorting, statisticaloptions, access to ANSI structured query language (SQL), a layoutmenu and other features.andP;  Program developers should learn QBEbecause it replaces the BROWSE and EDIT commands, is an easy wayto learn SQL and is a better way to create query features forusers and for developers.andM;</SUMMARY><DESCRIPT>Product:   R:base 3.0 (Data base management system) (usage).andO;Topic:     TutorialQuery LanguagesApplications ProgrammingStructured Query LanguageProgram Development Tools.andM;</DESCRIPT><TEXT>Become a QBE CrackerjackandM;R:BASE version 3.0 has a lot of improvements, including support for ANSILevel 2 SQL, transaction processing, query by example (QBE), an improvedinterface, better forms and reports, and powerful additions to the commandlanguage.andP;  This month's column, a look at R:BASE's QBE system, is the firstin a series of articles exploring the new R:BASE.andM;Strictly speaking, the term &quot;query by example&quot; refers to the process ofgathering information from a database by filling in blanks with examples ofthe data.andP;  QBE is a visual query method and has little in common withprogramming languages or prompted menu systems (such as R:BASE 2.1's PromptBy Example).andP;  QBE has features that both novices and experienced power usersfind attractive.andP;  Like SQL, QBE is a product of IBM research.andP;  It was createdby Moshe Zloof in 1976 to run on various IBM mainframes.andP;  Of course, that'swhen dumb terminals were standard, so QBE has evolved some since then.andP;  Itwas popularized on the PC by Borland's Paradox database management system.andM;R:BASE's QBEandM;R:BASE's QBE (referred to in the R:BASE documentation as the &quot;Info/ViewsMenus&quot;) is a system for viewing, editing, and querying data.andP;  It replacesR:BASE 2.1's BROWSE and EDIT commands and throws in a powerful ad hoc queryengine.andP;  In addition, R:BASE's QBE includes options to control the layout,perform statistical procedures, sort, save the results, manage views, andprint.andP;  QBE is an integrated system made up of three modes: Browse, Edit, andQuery.andM;The Browse/Edit screenandM;The Browse and Edit modes are similar.andP;  They're often lumped together in thedocumentation (the only difference is the ability in the latter to edit thedata).andP;  Each allows you to display tables, views, or queries in aspreadsheet-like table of rows and columns (see Fig.andP;  1).andP;  You use the F4 keyto toggle between the modes and Ctrl-F3 to switch to Query mode.andM;The Query screenandM;You construct queries with the Query screen--what most people think of whenyou say &quot;query by example&quot; (see Fig.andP;  2).andP;  At the simplest level, when you'reonly dealing with one table, defining a query consists of just a few steps:andM;1.andP;  Select the tableandM;2.andP;  Select the columnsandM;3.andP;  Specify the conditionsandM;4.andP;  ExecuteandM;For more elaborate queries, you can add, link, and delete up to five tables.andO;After specifying the query, you execute it with the F2 key.andP;  When the query'sdone, it switches the display back to the Browse/Edit mode and displays theresults of the query there.andM;Half the fun is getting thereandM;You can access the QBE system through the Info or Views menu.andP;  You can alsoaccess it from the Randgt; prompt using one of three commands: QUERY, BROWSE, orEDIT.andP;  Add the myriad of parameters that you can specify at the command lineand you have quite a few ways to call QBE.andP;  Although this might sound a bitconfusing, there's good news.andP;  No matter how you get to QBE (with a fewuser-specified exceptions), you have access to all its features.andM;From the Main menu, if you click on the Info menu with your mouse (or Alt-Ifrom the keyboard), you'll get a submenu of all the tables in the currentdatabase and the Create/Modify option.andP;  If you click on Views, you'll get amenu of all the defined views and the Create/Modify entry.andP;  Although they maylook the same and may both offer a path to R:BASE's QBE system, they're notreally similar.andP;  When you choose a table from the Info menu, the Browse/Editscreen for the table will display.andP;  This initial picture of your table isequivalent to:andM;SELECT ALL FROM table_nameandM;Type Ctrl-F3 and you'll see the Query screen with all the columns selectedand no conditions specified.andP;  From the Views menu, clicking on a named Viewbrings up the Browse/Edit screen for that view.andP;  This time the Browse/Editscreen displays the rows and columns associated with the view.andP;  Switching tothe Query screen displays the tables, columns, table-links, and conditionsyou used to create the view (even if the view wasn't done with QBE).andM;When you choose Create/Modify from the Info menu, you invoke the DatabaseBuilding Menu system (Definition Express).andP;  There's no QBE there.andP;  On theother hand, if you select Create/Modify from the Views menu, you get a blankQuery screen where you can start building your query.andM;Creating queriesandM;You define queries at the Query screen.andP;  If you're in the Browse/Edit screen,switch to Query mode by choosing &quot;Show Query screen&quot; from the Query menu orby typing Ctrl-F3.andP;  Building a single-table query takes four steps.andM;1.andP;  If you haven't selected a table, choose &quot;Add tables&quot; from the Query menuand a submenu of the tables is displayed.andP;  Choose one with the mouse or Enterkey (if you used the Info menu to start QBE, skip this step).andM;2.andP;  Select the columns that you want to appear in the query with the F6 key.andO;A check mark will appear to the left of each column you select Shift-F6selects all columns.andP;  These keys act as toggles; if you want to unselect acolumn, press F6 again.andM;3.andP;  Now specify the conditions.andP;  This is the same as writing a WHERE clause.andO;Move the cursor to the column to which you want to add a condition.andP;  Type theEnter key and a pop-up menu of operators appears (=, andgt;, andless;, etc.).andP;  Select anoperator and type Enter again.andP;  A dialog box will appear for you to enter thecondition.andM;You can specify conditions that refer to other columns in the table (such asandgt; Cost).andP;  Conditions can even include nested subselects!andP;  Let's useMicrorim's sample CONCOMP database (included in the R:BASE 3.0 package) toillustrate.andP;  Using the PRODLOCATION table, we might add the condition:andM;= (SELECT MAX (onhand) FROM prodlocation)andM;to the Onhand column.andP;  When this query executes, it'll return rows whereOnhand is equal to the maximum.andM;You can enter as many conditions as you need (or want).andP;  When you specifyadditional conditions with the Enter key, they're treated as if they'reconnected with the &quot;AND&quot; operator.andP;  You can add either/or conditions with theShift-F10 key.andP;  For example, let's use the PRODLOCATION table again and addthe condition andgt; 100 to the Onhand column.andP;  Next, let's add the condition='X1000' to the Model column using the Shift-F10 key.andP;  If we'd added thiscondition with the Enter key, then both conditions would have to be metsimultaneously.andP;  For rows to be included in the query, Onhand would have tobe greater than 100 and Model would have to be X1000.andP;  But because we addedthe second condition using Shift-F10 (an either-or condition), rows will bereturned where Onhand is greater than 100 or Model is X1000.andM;When you specify an either-or condition, R:BASE draws a dashed line acrossthe screen to separate the two conditions (see Fig.andP;  2).andM;4.andP;  Execute the query.andP;  Simply hit the F2 key.andP;  R:BASE will switch to theBrowse/Edit screen, and the rows and columns meeting the query specificationwill be displayed.andM;Querying multiple tablesandM;Querying data from more than one table isn't much more difficult.andP;  Let'scontinue using the CONCOMP database.andP;  We want to view all the orders wheremore than 25 units were ordered.andP;  Let's sort the results by model number anddate.andP;  For each order we want to see the model number, number of units,product name, and order date.andP;  This query requires data from three tables:Transdetail, Transaction, and Product.andP;  We'll start with the Transdetailtable.andP;  From R:BASE's Main Menu, select Info and choose the Transdetailtable.andP;  Switch to the Query screen (Ctrl-F3).andP;  Press F6 to unselect allcolumns except Model and Units.andP;  Under the Units column, enter the conditionandgt; 25.andM;Next, add the Product table to the query by choosing &quot;Add Tables&quot; from theQuery menu (you could also use the F10 function key).andP;  Choose Product fromthe pop-up menu of tables that appears.andP;  Tab over to the Prodname column andhit F6 to select this column--a check mark will appear to the left of thecolumn name.andP;  You've just added the Product table to the query.andM;We must still link the two tables by their common column, Model.andP;  (If you addmultiple tables to a query without linking them on any columns, the resultstable will be the mathematical union of every row in the first table witheach row in the second table--usually not what you intended.)andP;  Move to theModel column in the Product table and choose &quot;Link Tables&quot; from the Querymenu.andP;  You'll get a pop-up menu of linking operators.andP;  Choose =.andP;  Now moveback to the Transdetail table using the Shift-F7 key.andP;  Tab over to the Modelcolumn and type Enter.andP;  You've just linked the two tables.andP;  Your screenshould now look like Fig.andP;  3.andM;We need one more table, Transaction, to complete our query.andP;  Choose &quot;AddTables&quot; again.andP;  This time choose Transaction.andP;  Tab over to the Transdatecolumn and hit the F6 key to add it to the query.andP;  Now tab back to Transidand choose &quot;Link Tables&quot; from the Query menu.andP;  Choose the = operator.andP;  HitShift-F7 twice to move back to Transdetail and hit Enter with the cursorunder Transid.andM;That's it, you've linked the three tables and selected the columns and rowsto appear in the query.andP;  The only thing left to do is execute the query andadd the sort parameters.andP;  You might ask why we can't specify the sort columnsbefore executing the query--good question.andP;  For now, the Sort menu is onlyactive in Browse/Edit mode.andP;  Execute the query by pressing F2.andP;  The unsortedquery should appear.andP;  At the Browse/Edit screen, choose &quot;Multicolumn Sort&quot;from the Sort menu.andP;  A pop-up checklist will appear.andP;  Choose Model, followedby Transdate, in ascending order.andP;  Execute the sort with the F2 key and yourscreen should look like Fig.andP;  4.andP;  Give yourself a pat on the back--you'vejust created and executed a three-table query with a sort clause.andM;More goodiesandM;There are a few other menu options available in QBE.andP;  We've used just partsof the Query and Sort menus.andP;  The Sort menu is where you specify single andmulti-column sorts.andP;  You'll also find choices for listing and clearing thesort columns.andM;You use the Edit menu to edit, delete, and insert rows of data.andP;  The firstoption, &quot;Edit Data,&quot; toggles between Edit and Browse modes (the F4 key doesthe same thing).andP;  There are other menu choices for deleting and insertingrows and erasing field values.andP;  Another Edit menu choice, &quot;Replace All With,&quot;performs global replaces.andP;  This replaces every row of a given column with aconstant value--use it with caution.andM;Several options in the Calculate menu help you statistically analyze queryresults.andP;  These functions duplicate the COMPUTE, TALLY, CROSSTAB, and SELECTGROUP BY commands and are a nice addition to the QBE system.andM;The Layout menu has options for moving, hiding, &quot;unhiding,&quot; and altering thewidths of columns.andP;  You can also lock groups of columns to the left or rightside of the screen.andP;  This is handy for keeping certain indentifying columns(such as name or I.D.andP;  number) visible as the screen scrolls from left toright.andP;  Similarly, R:BASE can lock certain rows at the top or bottom of thescreen.andP;  Another Layout choice lets you hide duplicate rows.andM;The Manage Views menu seems a bit out of place in a QBE system but you mayoccasionally find it useful.andP;  It has options to remove, rename, or copyviews.andP;  The Modify option replaces the current query with another definedquery.andM;The query menu also has several other potent choices.andP;  &quot;Computed Columns&quot;allows users to create computed columns on the fly from within a query.andO;&quot;Clear query&quot; wipes out all references to tables and columns and allows usersto start with a blank slate.andP;  Two other options save the results of queriesas a permanent table or view.andP;  The rest of the Query options duplicatefunction keys, for example, specifying and clearing conditions, adding andremoving tables, or moving between Brose/Edit and Query modes.andM;You use the Print menu options to send the results of a query to a printer orfile.andP;  Unfortunately, no facilities exist for outputting the results of thestatistical commands (from the Calculate menu).andP;  I'd also like the ability tospecify header and footer text, and margins for creating quick andnot-so-dirty reports in QBE.andM;A few function keys perform functions not available through menus.andP;  In theBrowse/Edit mode, F6 copies all or part of the contents of a field to ascratch buffer.andP;  Ctrl-F7 pastes the contents of the buffer to a new field.andO;These function keys might be useful for copying long text or note data fromone row to another.andP;  Most of the remaining function keys are used to movearound the screen.andM;QBE as a SQL tutorandM;I ran into one more function key, Shift-F3 (&quot;Show Current Query&quot;), byaccident.andP;  Although it's included in a summary table of Query mode functiokeys in the User Manual, I couldn't find a reference to this keystroke in thedocumentation (this may change in the final User Manual--I'm working with thepreliminary documentation for this article).andP;  Pressing Shift-F3 displays theequivalent SQL SELECT command that you could have used from the commandprompt to create the QBE-defined query!andP;  For example, the three-table examplediscussed earlier produces the SQL command displayed in Fig.andP;  5.andP;  Don'tunderestimate the usefulness of this keystroke.andP;  It's a wonderful SQLlearning tool.andP;  The ability to tie R:BASE's QBE to SQL with a single functionkey again demonstrates R:BASE's superior level of integration.andM;QBE for real programmersandM;Well, most of us know that real programmers don't use menus.andP;  So how do youget to QBE from the Randgt; prompt?andP;  And why would you want to?andP;  You can invokethe QBE system with the QUERY, BROWSE, and EDIT commands.andP;  We'll talk aboutwhy later.andM;QUERY starts you out at different places in the QBE system--depending on thecommand line options.andP;  Simply entering QUERY at the Randgt; prompt brings up ablank Query screen without any associated tables or columns (the same asCreate/Modify from the Views menu).andP;  More complicated QUERY commands canrefer to columns, tables, views, and correlation names.andP;  They can includeWHERE and ORDER BY clauses much like a SELECT command.andP;  Entering any of theseparameters starts QBE with the specified query displayed.andP;  You can thenmodify the query or execute it with the F2 key.andP;  Adding the EXECUTE keywordto the command line starts QBE and immediately executes the query.andP;  Theresults are displayed in a Browse/Edit screen.andM;The BROWSE and EDIT commands are supersets of the QUERY command.andP;  UnlikeQUERY, you must use BROWSE or EDIT with parameters.andP;  Also, they don't supportthe EXECUTE option.andP;  (You don't need EXECUTE because BROWSE and EDIT alwaysstart at the Browse/Edit screen of the QBE system, executing any specifiedquery.)andP;  Both BROWSE and EDIT have options that control the layout andediting of the data.andP;  Most of these options duplicate functions availablefrom the QBE menus.andP;  Application developers will appreciate the ability tospecify options from the command line.andP;  The =width option allows ypu tospecify the display widths for one or more columns.andP;  The =color optionassings background colors to individual columns--a great way to drawattention to speical columns.andP;  You can combine them with the =READ optionthat designates a read-only column.andP;  The =NOSCROLL option allows you tocreate locked columns that remain on the screen when the display is scrolledleft or right.andP;  The NOCHG option is handy.andP;  When used with the BROWSEcommand, it disables the user's ability to switch to the Edit or Query modes.andO;When used with the EDIT command, the NOCHG option allows you to edit data,but disallows any ad-hoc queries.andM;I can think of at least four reasons why an R:BASE developer needs to learnQBE.andP;  The first is the most obvious.andP;  If your applications use BROWSE orEDIT, you have no choice.andP;  The old commands have been replaced with the newQBE commands.andP;  Second, I bet many of you have applications that need anad-hoc query option.andP;  Prior to 3.0, you might have allowed your users to exitto the wilds of the Randgt; prompt or perhaps spent tens or hundreds of hoursprogramming tedious WHERE clause-building procedures.andP;  With the new QBEsystem, your life just got a little easier.andP;  Third, you might want to use QBEfor your query needs.andP;  How many of you are experts at entering multi-tableSELECT and CREATE VIEW commands?andP;  I know I'm not.andP;  QBE won't replace theSELECT command, but sometimes it's more appropriate.andP;  For example, QBE isperfect for exploratory queries.andP;  And, it's a whole lot more fun thatentering five-line SELECT statements at the Randgt; prompt--which leads me to mylast reason.andP;  As I mentioned earlier, QBE can be used to learn SQL.andP;  Afteryou've fiddled around in QBE and perfected your query, type Shift-F3 and theequivalent SELECT statement appears on the screen.andP;  Press the PrintScreen keyand you'll have a hardcopy to study.andP;  That sure beats wading throughreference manuals and text books.andM;I hope you now share my enthusiasm for R:BASE's QBE system.andP;  Power users anddevelopers m ight be tempted to ignore QBE as simply a hand-holding gimmickfor beginners.andP;  If they do, they'll be missing a powerful, integratedquerying, editing, and analysis tool.andP;  QBE wasn't on my version 3.0 wishlist, but I'm having a hard time imagining life without it.andP;  Now, if onlythere was a compiler for R:BASE version 3.0...andM;Paul Litwin is the data manager for a medical research project at theUniversity of Washington in Seattle.andP;  An R:BASE user since 1983, Paul is alsoV.P.andP;  of the Seattle area R:Gang user group.andP;  You can reach Paul by writingto Data Based Advisor or by leaving him a message on the Microrim BBS at(206) 881-8119.andO;</TEXT></DOC>
<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF107-929-996  </DOCNO><DOCID>07 929 996.andM;</DOCID><JOURNAL>Lotus  Dec 1989 v5 n12 p70(3)* Full Text COPYRIGHT Lotus Publishing Corp. 1989.andM;</JOURNAL><TITLE>Query external tables with 1-2-3 release 3; improve your access todatabase information. (Managing Databases; includes relatedarticle on Lotus Development Corp.'s DataLens drivers)</TITLE><AUTHOR>Fielding, Justin.andM;</AUTHOR><SUMMARY>Users of database software other than Lotus 1-2-3 might want toimport selected data into the spreadsheet to take advantage of1-2-3's calculation abilities and flexible control of reportformats.andP;  With 1-2-3 3.0's Data External commands, importing andexporting data is much easier.andP;  Release 3 allows an externaldatabase table to be treated as though it were a conventional1-2-3 database input range.andP;  Once data is within 1-2-3, tables inthe database can be modified and deleted at will.andP;  The tutorial inthis article demonstrates how Data External commands can be usedto query an external data table.andM;</SUMMARY><DESCRIPT>Product:   Lotus 1-2-3 3.0 (Spreadsheet software) (usage).andO;Topic:     Data BasesSpreadsheetsTutorialQuery Processing.andM;</DESCRIPT><TEXT>QUERY EXTERNAL TABLES WITH 1-2-3 RELEASE 3andM;If you use database software other than 1-2-3, you may want to importselected data into a spreadsheet.andP;  Chances are your database program can'tmatch 1-2-3's aptitude for calculations.andP;  And few, if any, database programsare as flexible as 1-2-3 for manual control of report formats.andM;Unfortunately, importing and exporting data can be cumbersome andfrustrating.andP;  1-2-3 Release 3 offers a convenient and powerful alternative totraditional data import and export.andM;With Release 3's Data External commands, you can treat an external databasetable as if it were a conventional 1-2-3 database Input range.andP;  You useordinary Criteria and Output ranges to extract the desired records and fieldsfrom a table.andP;  The database you query can be of almost any size, but theinformation that you extract into the worksheet cannot exceed 1-2-3'sconstrains on memory size and the number of fields and records.andM;The Data External commands let you manipulate the database itself.andP;  Within1-2-3 you can create, delete, and modify tables in a database.andP;  Like otherfeatures of Release 3, the Data External commands support multiple-table, or&quot;relational,&quot; databases.andP;  You can even issue commands in the command languageof the program that created the database.andM;The exercises that follow demonstrate how to query an external table.andP;  Futurearticles will address some of the more advanced ways in which 1-2-3 cancontrol external database files.andM;What You Need to KnowandM;To use the Data External commands, you need some understanding of 1-2-3database fundamentals, as well as an understanding of the program thatcreated your database.andP;  Although the examples here import data from dBase IIIPlus, you don't have to know about dBase III Plus to do the exercises.andM;Release 3 comes with SAMPLE, a driver that helps 1-2-3 work with dBase IIIPlus files.andP;  It also comes with a dBase practice file called EMPFILEDBF.andP;  Thedriver is called SAMPLE because it offers a limited set of external databasecommands.andP;  It does, however, support all of the essential features.andM;If dBase is your main point of reference for database terminology, a fewterms used by the Data External commands may bear explanation.andP;  In dBase IIIPlus, each table of data is stored in a separate file.andP;  You generallyidentify a dBase database by the names of its component files.andM;The Data External commands use terminology that is more familiar to users ofSQL-based relational databases, such as Oracle.andP;  In these systems, tablesrather than files are the essence.andP;  The actual names and structures of thefiles are neither apparent nor relevant to the user.andP;  What Oracle users calla database is somewhat analogous to a subdirectory that contains all of thefiles in a dBase application.andP;  To the Data External commands, a database isthe location where the data is stored.andM;If You're preparing to query a dBase database and 1-2-3 asks you to specifyan external database, enter the name of the subdirectory that contains thedatabase files.andP;  When you're asked to provide a &quot;table&quot; name, indicate a .DBFfile name.andM;Note that in 1-2-3 Release 3, the term &quot;database table is often used insteadof &quot;database&quot; or &quot;Imput range,&quot; because the database you query may consist ofmore than one table.andP;  An &quot;external table&quot; is the part of a database that youaccess via Data External commands.andM;Setting Up a LinkandM;Let's use SAMPLE and the EMPFILEDBF file to see how Data External commandswork.andM;Start with a blank worksheet with the cell pointer in cell A1.andP;  Since you'rejust going to use worksheet A, you don't need to use Release 3's 3-D notation(for example, specify A1 instead of A:A1).andM;The first step in working with an external table is to press the slash keyand choose Data External Use.andP;  1-2-3 takes you through the steps ofidentifying the table you want to use.andM;The names of the drivers you have installed appear in the control panel.andO;Select SAMPLE.andM;Next, identify the database.andP;  For dBase databases, this is the subdirectorythat contains the database file.andP;  If you installed 1-2-3 using the defaultsettings, subdirectory C:\123R3 contains the dBase test file EMPFILEDBF.andO;Select C:\123R3, or whichever directory contains your copy of EMPFILEDBF.andM;Now, highlight the table (or &quot;file&quot; in dBase parlance) name EMPFILE and pressReturn.andP;  Press Return again to accept Empfile as the range name for theexternal table.andP;  You now have access to an external database table.andM;The first three steps of the Data External Use command provided the sameprompt: Enter name of table to use.andP;  These three steps helped you build a&quot;full table name,&quot; which consists of the names of a driver, an externaldatabase, and an external table.andP;  The full table name is the combination ofthese elements, separated by spaces.andP;  Some database systems require oneadditional element, an &quot;owner name,&quot; but it is not needed with dBase andSAMPLE.andM;If you prefer, you can enter the full table name in one step.andP;  After youselect/data External Use, enter sample c:\123r3 empfile dbf.andP;  Then typeempfile and press Return to supply a range name for the external table.andM;Now that you have established a link to the external table, you need to buildyour Criteria and Output ranges.andP;  You could type in the field names, but thatwould require you to remember the exact spelling of the field names in thedBase file.andP;  Instead, choose List Fields (if the Data External menu is notcurrent, press slash and select Data External List Fields).andM;The Data External List Fields command requests the range name of the externaltable.andP;  Press Return to select empfile.andP;  Press Return a second time to placethe field information in cell A1 and its neighboring cells.andP;  You should nowsee a table definition in range A1..F6.andP;  Choose Quit to exist the DataExternal menu.andM;The table definition contains six columns of information about the externaltable.andP;  Not all of the columns are relevant to all external programs andtheir related drivers.andP;  The SAMPLE dBase driver uses only the first three:field names, data types, and field widths.andP;  The other columns are for columnlabels, field descriptions, and field-creation strings.andM;The only column that you're concerned with at this time is column A, whichcontains the field names.andP;  Since the field names are arranged vertically, youneed to do a bit of reorganizing if you want to use them in Criteria andOutput ranges.andP;  To crase the other columns, select/Range Erase and indicaterange B1..F6.andP;  Next, with the cell pointer in cell A1, choose /Range Trans,type A1..A6, and press Return twice.andP;  Now, the field names are in a row,readily to be used as a Criteria range.andP;  You don't need the extra copies ofthe field names in range A2..A6.andP;  Select /Range Erase and indicate rangeA2..A6.andM;The Output range is easy to set up.andP;  Copy the labels in range A1..F1 to cellA5.andM;Now you're ready to specify the location of the various database ranges.andO;Select /Data Query Criteria, and specify range A1..F2.andP;  Then choose Outputfrom the Data Query menu and indicate range A5..F5.andP;  Remember that any dataentered below the Output range will be erased if you perform a Data QueryExtract or Data Query Unique command.andM;Finally, you need to identify the location of the Input range.andP;  Here's whereyou start to see the Data External command in action.andP;  Instead of identifyingcells in the current worksheet, you'll identify the external table as yourInput range.andP;  Choose Input from the Data Query menu, press the NAME key (F3on most computers) for the list of range names, highlight EMPFILE, and pressReturn.andM;Using the External TableandM;From here on out, you can use the external table like any other 1-2-3database Input range.andM;If the Data Query menus is still on the screen, choose Extract (otherwise,select /Data Query Extract) and select Quit.andP;  Because there are no criteriain the Criteria range, your Output range now contains a copy of the entirecontents of EMPFILE.DBF.andP;  Select Quit.andM;Suppose you want to see only the employees whose last names begin with M.andO;Enter thelabel M* in cell B2.andP;  After you press Return, press the QUERY key,which is F7 on most computers.andP;  If you're not familiar with the QUERY key,it's a shortcut for repeating the last Data Query command--in this case, DataQuery Extract.andP;  Now the Output range includes only the employee records thatmatch the current criteria.andM;If you're a seasoned user of 1-2-3 databases, you may see a potential problemwith using an Input range that's not on the worksheet.andP;  Some formulas in aCriteria range refer to the second row of the Input range (the first row thatcontains data), such as +Z99andless;1987.andP;  Many people use the Range Name LabelsDown command to assign the field names at the top of an Input range to thefirst data row, so they can write formulas like +DEPT-NUMandgt;3000.andP;  Since theexternal table doesn't actually reside in the worksheet, there's no way toassign range names to parts of it.andP;  Although the Data External Use commanddoes not actually assign range names to the fields, criterion formulas canuse field names from the external table as if they were range names.andM;Now use the Range Erase command to erase cell B2.andP;  Move the cell pointer tocell F2 and enter +DEPTNUMandgt;3000.andP;  After you press Return, press the QUERY keyto perform another Data Query Extract operation.andP;  An ERR indicator appears incell F2, but it is of no significance.andP;  1-2-3 treats this formula as an errorbecause it refers to a range name that doesn't really exist.andP;  The formula,however, serves its purpose during a Data Query command, and your Outputrange now contains a list of employees whose department number is greaterthan 3000.andM;Keep in mind that some queries with large databases might require a largerOutput range than 1-2-3 can accommodate.andP;  Some database commands, such as theData Query Find command, aren't practical with an external table.andP;  And if youexperiment with the more advanced Data External features, remember that someof them aren't supported by the SAMPLE driver.andM;INTRODUCING DATALENSandM;If you ever have had to convert data files from one program to another, youknow it usually isn't easy.andP;  Often data conversions require you to switchback and forth between programs, perform extensive file alterations, and usespecial conversion utilities.andP;  Then you try to clean up the results withouttoo much manual intervention.andM;Lotus Development Corp.'s DataLens technology offers a more sophisticatedlink between applications than conventional importing and exporting.andP;  Forexample, it enables you to modify data created with a separate databasepackage, even if the information resides on a remote mainframe computer or ona network file server.andM;1-2-3 Release 3 is the first product to include DataLens.andP;  Release 3's DataExternal commands let you use DataLens by way of 1-2-3 menu choices.andP;  Severalforthcoming Lotus products will also support DataLens, including 1-2-3/G,Lotus's graphical spreadsheet for OS/2, and 1-2-3/M, the version of 1-2-3 forIBM mainframes.andM;Lotus markets a toolkit that helps software publishers make DataLens drivers,which are programs that oversee the translation of data and commands.andP;  Onebenefit of DataLens is that a given driver works with all DataLens-compatiblesoftware on the same system.andP;  If you have a DataLens driver for your databaseprogram, you can use your database files with any other program that supportsDataLens.andM;The SAMPLE driver included with 1-2-3 Release 3 gives you access to dBase IIIPlus files, but if you use a different database program, you'll need toacquire the appropriate driver.andP;  Oracle Corporation, Gupta Technologies,Microrim, Novell, Teradata Corp., and Computer Corporation of America haveannounced their intention to produce DataLens drivers.andP;  And Lotus hasannounced that drivers are in development for Sybase's SQL server, IBM'sExtended Edition Data Manager, and Borland's Paradox.andP;  At press time,however, none of these drivers were available.andM;Lotus provides a toll-free number for information about the availability ofDataLens drivers: 800-343-5414, from 8:30 A.M.andP;  to 8:00 P.M.andP;  Eastern time.andM;Paula Dempsey, a frequent contributor to LOTUS, wrote a primer on @functionsin September's Special Report on formulas.andO;</TEXT></DOC>
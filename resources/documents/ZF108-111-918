<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF108-111-918  </DOCNO><DOCID>08 111 918.andM;</DOCID><JOURNAL>Lotus  Feb 1990 v6 n2 p34(6)* Full Text COPYRIGHT Lotus Publishing Corp. 1990.andM;</JOURNAL><TITLE>Here's the missing link. (multiple-file applications permanentlyconnect data between files) (tutorial)</TITLE><AUTHOR>Bookbinder, David J.andM;</AUTHOR><SUMMARY>The true file linking capabilities of Lotus 1-2-3 Release 3overcome the limitations of earlier versions and offer manyadvantages.andP;  Two files are linked when a worksheet cell refers toa cell in any other worksheet file in memory or on disk.andP;  Files inmemory can be linked to files on the disk.andP;  Information that isentered or changed in one file is automatically changed in thelinked files.andP;  Instructions for creating linked files and buildingdivisional worksheets and consolidation files is presented.andM;</SUMMARY><DESCRIPT>Ticker:    LOTS.andO;Product:   Lotus 1-2-3 3.0 (Spreadsheet software) (usage).andO;Topic:     Linkage EditorsFilesSpreadsheets.andO;Feature:   illustrationtable.andO;Caption:   How to set up the divisional worksheets. (table)Key combinations for cell-pointer movement. (table)How to set up the consolidation worksheet. (table)andM;</DESCRIPT><TEXT>HERE'S THE MISSING LINKandM;The concept of linking data in one file to data in another file is not new.andO;1-2-3 has always contained File Combine commands that enable you to pullinformation from subordinate worksheets into a master worksheet.andO;Unfortunately, these commands are limited.andP;  For example, when you edit datain a subordinate file, the master file does not automatically reflect thechange.andP;  Consequently, each time you update data, you must remember toreissue the appropriate File Combine commands for each changed range or use amacro to do so.andM;True file linking, available in 1-2-3 Release 3, overcomes these limitationsand offers many advantages.andP;  Two files are linked when a cell in oneworksheet file refers to a cell in any other worksheet file in memory or ondisk.andP;  Just as you use an ordinary cell reference in a formula or macro, youcan use a range reference in a file link.andP;  When you change the data, Release3 updates the link for you.andM;In addition, by allowing you to link files in memory to files on disk,Release 3 nearly eliminates memory constraints.andP;  A model that wisely usesfile linking can be as large as the available disk storage, instead of beinglimited to the amount of available RAM.andM;But before we get ahead of ourselves, it's important to distinguish between amultiple-file application and a multidimensional worksheet.andP;  It's alsoimportant to know when to use which.andM;A multidimensional worksheet is one file that contains several worksheets.andO;You'll want to base an application on a single multidimensional worksheetfile if everyone who uses the application has access to the same file and isentitled to have access to all the data in it.andP;  Also, the application mustnot be too big to fit into memory.andP;  For more on the 3-D worksheet, see thearticle &quot;Meet the Multidimensional Worksheet&quot; in the January issue.andM;On the other hand, a multiple-file application can work with more than onefile at once.andP;  The files can be in memory or on disk, and each file cancontain multiple sheets.andP;  Such an application is ideally suited to data thatmore than one person manipulates or data that more than one applicationrequires.andP;  The multiple-file solution is also handy when an application wouldotherwise be too large to fit into available memory.andM;A multiple-file application makes it easy for a group of people to sharedata.andP;  For example, suppose several department managers need financialinformation from a database that is updated weekly.andP;  Instead of someone ineach department rekeying values from the database into the departmentalworksheet, each worksheet can contain file links that refer to the databasefile.andP;  Whenever the database is updated, each manager issues a single commandto update the file links.andM;To simplify the presentation of multiple-file concepts, we've selected aconcise model.andP;  Once you master the basics of file linking, you'll beprepared to develop your own more intricate applications.andM;NAVIGATE AMONG FILESandM;When a Release 3 worksheet file is in memory, it is known as an active file.andO;In theory, Release 3 lets you have a maximum of 256 files active at once.andO;The actual limit, however, depends on available memory and operating systemconstraints.andP;  Up to 256 worksheets can be distributed among all active files.andM;Just as you can pull out several file folders, lay them on a desk, and leafthrough them, you can read several worksheet files into memory and then&quot;flip&quot; through them.andP;  To bring a file into memory, you use the File Opencommand.andP;  This command lets you specify whether the file should appear beforeor after the current file, which is the one that currently contains the cellpointer.andM;Once you have opened several files, you need ways to navigate among them.andO;The table on page 37 summarizes the key combinations that move the cellpointer from one active file to another.andP;  When you move the cell pointer fromfile to file, you'll notice that the name of the current file appears in thelower-left corner of the screen.andP;  This helps you remember which file you arein when you're navigating.andM;When you finish working with an active file, you may want to save it to diskand then delete it from memory.andP;  Saving a file is probably second nature toyou by now: You select /File Save and enter a file name.andP;  If you havepreviously saved the file, Release 3 presents three options: Cancel, Replace,and Backup.andP;  To abort the process of saving the file, select Cancel.andP;  Toreplace an existing file on disk with the copy in memory, select Replace.andO;Finally, to create two files representing the last two versions of the file,select the Backup option.andP;  This command first renames the file on disk bychanging the file extension from .WK3 to .BAK, and then saves the file inmemory by using the existing file name and the .WK3 extension.andP;  In mostcases, you'll probably want to select Replace.andM;The process of saving files is slightly different when more than one file isin memory.andP;  You can save either all modified files at once or only thecurrent file.andP;  To save all modified files at once, select /File Save andpress Return.andP;  To save only the current file, select /File Save, press theEDIT key or the Escape key to display the current file name, and then pressReturn.andP;  In both cases, you'll be presented with the three save optionsdescribed in the previous paragraph.andM;The File List Active command displays a full-screen list of all active files.andO;If you highlight a particular file name, 1-2-3 displays at the top of thescreen the date and time the file was created, its size, and the number ofworksheets in the file.andP;  In addition, 1-2-3 indicates whether or not a filehas been modified since you last saved it.andP;  It's good practice to list theactive files before you delete a file from memory.andM;To delete an active file from memory, you use the Worksheet Delete Filecommand.andP;  This command does not affect the file currently stored on disk orany other files in memory.andM;CREATE FILE LINKSandM;Now that you're familiar with moving files in and out of memory andnavigating among files, you're ready to explore the fundamentals of filelinking.andP;  To create a file link, you specify two pieces of information: afile reference and a range specification.andP;  The file reference, which youenclose in double angle brackets (andless;andless;andgt;andgt;), can be a file name or a file pathplus a file name.andP;  If the file reference contains only the file name, 1-2-3searches only the current directory for the file.andP;  If the referenced file isnot in the current directory, the file link returns ERR, indicating that youmust include a path.andP;  The range specification, which immediately follows thefile reference, can be a single-cell range, a range of cells, or a namedrange.andP;  If the link is to a multiple-worksheet file, the range can include aworksheet letter.andP;  The range you specify can be relative, absolute, or mixed.andM;Consider a few examples of file links.andP;  If you enter +andless;andless;gum.wk3andgt;andgt;proj feb inthe file TEA.WK3, you create a link to a range named proj feb, which islocated in the file GUM.WK3, which in turn is in the current directory.andO;Similarly, to sum projected February sales in the file C:\SALES\GUM.WK3 andto add to that total the value of the cell named factor in the target file,you enter the following formula:andM;@SUM(andless;andless;C:\SALES\GUM.WK3andgt;andgt;proj feb)+factorandM;The file containing the cell or range referred to in the file link is calledthe source file, since it's the source of the data.andP;  In the example above,the source file is GUM.WK3.andP;  The file containing the reference is called thetarget file since it receives the values from the source files.andP;  In theexample, the target file is TEA.WK3.andP;  When you alter a source-file cell,1-2-3 updates target-file cells that are linked to that cell.andM;BUILD DIVISIONAL WORKSHEETSandM;Now let's work with a multiple-file application.andP;  To begin, we'll buildseveral worksheets that will eventually be combined into a consolidationworksheet for the hypothetical business Manifest Destiny.andP;  The company'sthree divisions produce paper fortunes for bubble gum wrappers, fortunecookies, and tea bag tags.andM;Figure 1 shows the divisional worksheets for the month of February.andP;  The fileGUM.WK3 contains the data for the Bubble Gum Division, showing the projectedand actual sales, expenses, and profit, as well as the variances betweenprojected and actual amounts expressed as a percentage.andP;  The consolidationworksheet, shown in Figure 2, contains file links to the divisionalworksheets and provides a view of the entire enterprise.andM;To build the worksheet file for the Bubble Gum Division, follow the steps inthe setup box for the divisional worksheets at the bottom of this page.andP;  Thenselect/File Save, type the name gum, and press Return to save the file asGUM.WK3.andM;Now use the GUM.WK3 file as a template to create files for the Cookie and TeaBag divisions.andP;  To create a file for the Cookie Division, begin in the fileGUM.WK3.andP;  Enter the label Cookie Division in cell A1.andP;  Then select/RangeErase and specify range B6..C7.andP;  1-2-3 displays $0.00 in range B9..C9 and ERRin the %Variance column.andP;  Select/File Save and enter cookie to save the fileas COOKIE.WK3.andP;  Similarly, to create the Tea Bag Division worksheet, enterTea Bag Division in cell A1 and save the file as TEA.WK3.andM;Now read the file COOKIE.WK3 into memory.andP;  Select /File Open Before,highlight the file name COOKIE.WK3, and press Return to read that file intomemory in front of the TEA.WK3 file.andP;  Be sure to use the File Open commandnot the File Retrieve command.andP;  The File Open command reads the selected fileinto memory without disturbing other files in memory, while the File Retrievecommand replaces the current active file with the file you specify.andM;Next enter the values shown in Range B6..C7 of the file COOKIE.WK3 shown infigure 1.andP;  Then press the key combination Ctrl-End Ctrl-PgUp to move the cellpointer to the file TEA.WK3.andP;  Enter the values shown in range B6..C7 of thefile TEA.WK3 shown in figure 1.andM;Now select/File Save and press Return to save all modified files.andP;  SelectReplace.andP;  This command simultaneously saves COOKIE.WK3 and TEA.WK3.andM;Next read GUM.WK3 into memory.andP;  Press the key combination Ctrl-End Ctrl-PgDnto move the cell pointer to the file COOKIE.WK3.andP;  Select/File Open Before,highlight the name GUM.WK3, and press Return to read GUM.WK3 into memory infront of COOKIE.WK3.andM;All three divisional files are now active.andP;  To verify this, select/File ListActive.andP;  1-2-3 displays the three file names COOKIE.WK3, GUM.WK3, andTEA.WK3.andP;  Press any key to return to the worksheet.andM;BUILD THE CONSOLIDATION FILEandM;Figure 2 shows what the consolidation worksheet will look like after youbuild it.andP;  This worksheet uses file links to display and summarize bothprojected and actual profit figures from each division's file.andP;  As in thedivision worksheets, column B shows projected values, column C shows actualvalues, and column D shows the variance between projected and actual valuesas a percentageandM;The formulas in cells B7..D9 contain links to named ranges in the variousdivisions' worksheet files.andP;  For example, the formula in cell B7, whichcalculates the Bubble Gum Division's projected profit, is +andless;andless;GUM.WK3andgt;andgt;proj-feb.andP;  This formula links cell B7 in the consolidation file with therange named proj-feb in the file GUM.WK3.andM;The formulas in row 11 perform simple calculations on the linked cells.andO;Cells B11 and C11 contain at SUM formulas that total projected and actualprofit figures for all divisions.andP;  These formulas include an extra row aboveand below the actual values to be summed.andP;  This ensures that the ranges willautomatically adjust to include any new row you might insert between rows 6and 10.andP;  Cell D11 calculates the variance between Manifest Destiny'sprojected and actual profit as a percentage of the projected value.andM;If the divisional files are still in memory, move the cell pointer to thefile GUM.WK3, select/File New Before, and enter the file name DESTINY.andP;  Ifthe divisional files are not in memory, read them into memory before youcreate the file named DESTINY.andP;  Select/File Retrieve and indicate TEA.WK3,select/File Open Before and indicate COOKIE.WK3, and then select/File OpenBefore again to read GUM.WK3 into memory.andM;To create the consolidation worksheet, follow the steps in the setup box onpage 37 for the consolidation worksheet.andP;  When you have completed thesesteps, select/File Save, press the Edit or Escape key to display the currentfile names, press Return, and then select Replace to save the fileDESTINY.WK3.andM;TEST THE CONSOLIDATIONandM;To see how 1-2-3 updates file links, let's modify a value in the fileCOOKIE.WK3.andP;  Press the GOTO key and enter andless;andless;cookieandgt;andgt;B7.andP;  Press the EDIT key,type +0.05, and press Return to add $50,000 to the projected Februaryexpenses for the Cookie Division.andP;  1-2-3 automatically updates cells B9, D7,and D9, as shown in figure 3a.andM;Now see how 1-2-3 has updated the file DESTINY.WK3.andP;  Move the cell pointer tothe DESTINY file.andP;  Press the GOTO key and enter andless;andless;destinyandgt;andgt;.andP;  1-2-3 hasautomatically updated the file links in cells B8 and D8 and recalculated theformulas in cells B11 and D11, which depend on those cells.andP;  Figure 3b showsthe results of these changes.andM;The updating of the file links occurred automatically because both the sourceand target files were in memory.andP;  However, if you change the source file whenthe target file is not in memory, 1-2-3 will not automatically update thefile links.andP;  Instead, while the source file is in memory, use the File opencommand to read the target file into memory.andP;  Or if the source file is nolonger in memory, retrieve the target file and select/File AdminLink-Refresh.andP;  Doing so forces 1-2-3 to update the file links and present thenew, changed values.andM;A FEW FINAL TIPSandM;Using multiple files in your application offers many new ways to work with1-2-3.andP;  However, you may also discover yourself making errors that you couldnot make before.andP;  This section outlines three potential problem areas andsuggests how to avoid them.andM;Manage Multiple-Level LinksandM;When you select /File Admin Link-Refresh to update the links in a targetfile, 1-2-3, does not first update links that may exist between source filesand other files.andP;  That may sound somewhat confusing, so consider an example.andM;Suppose that cell A1 of file A contains a link to cell B1 of file B.andP;  Alsosuppose that cell A2 of file A links to cell B2 of file B, which links tocell C2 of file C.andP;  When you read file A into memory and select /File AdminLink-Refresh, 1-2-3 updates the link in cell A1 of file A, which refers tocell B1 of file B.andP;  1-2-3 does not update the link in cell b2 of file B thatlinks to cell C2 of file C.andP;  Therefore, the link in cell A2 of file A thatdepends on the link to file C will be incorrect if you have changed file Csince the last time you updated the links in file B.andM;To avoid problems with multiple-level file linking, use one-level links orread all target files into memory before you modify a source file.andP;  Then1-2-3 will automatically update all file links.andM;Use Range NamesandM;When you use a range name in a file link, 1-2-3 uses the name to locate thesource-file data.andP;  If you move the named source-file data, the range namecontinues to be assigned to the data.andP;  Therefore, the file link, which usesthe range name, still refers to the correct data.andM;On the other hand, if you use cell addresses in a file link and then move thesource-file data when the target file is not in memory, the target file willnot know that you moved the data.andP;  Consequently, when you retrieve the targetfile, the file link will refer to the old location of the data, and formulasdepending on that data will return incorrect results.andP;  That should be reasonenough to convince you to use named ranges in file links.andM;Minimize Memory UseandM;To update a link to a formula in a source file, 1-2-3 must read into memoryall the cells in the source file that the formula depends on.andP;  If yourapplication has many file links to cells containing formulas, you may run lowon memory.andP;  To update a link to a cell containing a value or label, 1-2-3must read in only the cell to which the link has been made.andP;  Obviously, linksto cells that contain values or labels instead of formulas require lessmemory to update.andM;If you run into memory problems when you try to update file links, determinewhether the links are to formulas, values, or labels.andP;  If the links are toformulas that no longer need to be stored as formulas, convert the formulasto their calculated results.andM;To convert a range of cells, select /Range Value and specify the rangecontaining the formulas as the From range and the To range.andP;  To convert asingle cell, move the cell pointer to the cell, press the EDIT key followedby the CALC key, and then press Return.andM;David J. Bookbinder is a free-lance writer and author of The Lotus Guide to1-2-3 Release 3 (Addison-Wesley Publishing Co.).andO;</TEXT></DOC>
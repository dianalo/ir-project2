<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO> ZF32-211-117 </DOCNO><DOCID>10 385 831</DOCID><JOURNAL>Lotus  March 1991 v7 n3 p30(2)* Full Text COPYRIGHT Lotus Publishing Corp. 1991.andM;</JOURNAL><TITLE>Safe file-saving: prevent mishaps with save and retrieve macros.andO;(1-2-3 Macros) (tutorial)</TITLE><AUTHOR>Delonas, Nicholas.andM;</AUTHOR><SUMMARY>Three macros for Lotus Development Corp's Lotus 1-2-3 spreadsheetsoftware are discussed in detail.andP;  When using the /File Savecommand, it is important to have created a dummy file so that themacro does not overwrite a previously created file.andP;  Create adummy file using !!DUMMY.WK1 and the macro will list it firstwithout writing over an important file.andP;  A macro is demonstratedthat checks for the existence of a dummy file.andP;  The simplestfile-retrieving macro is /File Retrieve, but by adding the (NAME)command 1-2-3 will list worksheet files on the full screen and notjust in the control panel.andP;  Other macros shows how the user maysave a current file before retrieving a new one and how to changethe default directory.andM;</SUMMARY><DESCRIPT>Product:   Lotus 1-2-3 (Spreadsheet software) (Programming).andO;Topic:     File ManagementMacrosSpreadsheetsTutorial.andM;</DESCRIPT><TEXT>Automating routine filing tasks is easy.andP;  Macros that save and retrieveworksheets abound.andP;  But a small macro that saves your work could alsoaccidentally overwrite an important file.andP;  We'll show you a file-saving macrothat makes such a mishap less likely; a retrieve macro; and a macro that letsyou switch the default directory quickly and easily.andM;Figure 1 shows one of the most common file-saving macros.andP;  If you've usedmacros before, chances are you've used this one.andP;  It works fine, but itcontains a hidden threat.andP;  Look closely at what it does.andM;The macro selects /File Save and then presses Return, accepting the defaultfile name.andP;  That's fine most of the time.andP;  But what if you just created a newfile and imported this macro? When you run it, the macro overwrites the firstworksheet file listed in the control panel when you select /File Save.andM;It's prudent to create a dummy file, such as !!DUMMYWK1, that will be listedfirst when you select /File Save.andP;  That way, you can avoid overwritingimportant files.andP;  Even if you don't use a file-saving macro, it's good tohave a dummy file for those times when you quickly select /File Save Replacewithout thinking.andP;  Those keystrokes become so automatic that it's easy tooverwrite that first file.andM;But even users who create dummy files can run into trouble when they switchbetween data directories.andP;  For this reason, it's better to create a macrothat checks to make sure a dummy file exists.andM;The macro in figure 2 assumes that!!DUMMY.WK1 is the name of the dummy file.andO;It's a good choice because it's likely to be the first file listed; 1-2-3Release 2.x sorts exclamation points before alphanumeric characters.andM;To create the macro, enter the labels as shown.andP;  Preface the labels in cellsAl and B3 with an apostrophe.andP;  Then use the Range Name Labels Right commandto assign the label in cell Al as the range name for cell B1.andM;To run the macro, hold down the MACRO key (Alt on most computers) and pressS.andM;The macro checks to see if !!DUMMYWK1 exists in the current directory.andP;  If itdoesn't, the macro creates it.andP;  Then the macro saves the current file to thedefault file name.andP;  If the current file was not previously saved, the macrosaves it to the first file name listed in the control panel.andP;  That's likelyto be !!DUMMYWK1.andP;  So if you save the file before naming it, you're much lesslikely to overwrite a file with this macro than with the macro in figure 1.andO;Here's how it works:andM;andlsqb;OPEN  !!dummy.wk1&quot;,R}/FXF!!dummy.wk1~Al~ tries to open !!DUMMY.WK1.andP;  If thefile doesn't exist, the macro creates it by writing the contents of cell Alto that file.andM;andlsqb;CLOSE) closes!!DUMMY.WK1.andP;  If the file doesn't exist, 1-2-3 ignores thiscommand.andM;/FS~R[ESC) selects /File Save and saves the current file to the default filename, overwriting the old file.andM;File-retrieving macros are as common as file-saving macros.andP;  The simplest isFR{?}~, which selects /File Retrieve and then pauses for you to pick a file.andO;When you press Return, the macro retrieves your file.andP;  You can easily improvethis macro by adding the  NAME) command.andP;  This command instructs 1-2-3 tolist the worksheet files on the full screen rather than just in the controlpanel.andP;  You'll see  FR{NAME}{?}~ in many users' macro libraries.andM;These macros work well, but you may want one that lets you save your filebefore retrieving a new one.andP;  The macro shown in figure 3 does just that.andP;  Itrequires one more keystroke than the simple retrieve macros just discussed,but the file-save reminder is worth it.andM;To create the macro, enter labels as shown.andP;  Preface the labels in cells A6and B8 with an apostrophe.andP;  Then use the Range Name Labels Right command toassign the labels in range A5..A6 as range names for the adjacent cells incolumn B.andM;To run the macro, press MACRO-R.andP;  The macro asks you if you want to save thecurrent file first.andP;  If you press Y, the macro runs the save macro in figure2 before listing all the files to retrieve on the full screen.andP;  If you pressN or Return, the macro lists the files without running the save macro.andP;  Whenyou press Return, the macro retrieves the file that you highlighted.andP;  Here'show it works:andM;Save first? andless;Nandgt;  {GET temp}{ESC} displays the string Save first? andless;Alandgt; andpauses for a response.andP;  The macro stores the first key you type in the cellnamed temp.andP;  It then clears the string from the control panel with the {ESC}command.andM;{IF @UPPER(temp)=&quot;Y&quot;}{\s} determines whether the character in temp is Y or y.andO;If it is, the macro calls the \s macro before proceeding, letting you saveyour file.andM;/FR{NAME}{?}~ selects /File Retrieve and presses the NAME key to display thefiles you can retrieve on the full screen.andP;  The macro then pauses for you toselect the file you want.andP;  When you press Return, the macro retrieves thehighlighted file.andM;If you keep your important worksheet files in more than one directory, youknow how tedious changing the default directory can be.andP;  A macro thatautomates this process might be useful.andM;To create such a macro, enter labels as shown in figure 4.andP;  Preface the labelin cell A10 with an apostrophe.andP;  In range B19..B22, enter the path names ofyour data directories.andP;  Expand this list downward if necessary.andM;Use the Range Name Labels Right command to assign the labels in rangeA10..A19 as range names for the adjacent cells in column B. To run the macro,press MACRO-D.andM;The macro moves the cell pointer to the top of your list of directories.andO;Move the pointer to the directory you want to make the default and pressReturn.andP;  The macro then uses the File Directory command to make the directoryyou selected the default directory.andP;  To see if the macro updated the defaultdirectory, select /File Directory.andM;Here's how it works:andM;{END}{HOME}{GOTO}dirl~{GOTO}dir2~ moves the cell pointer to the last cell inthe worksheet.andP;  The macro then moves the cell pointer to the cell named dir1and then to the cell named dir2.andP;  The macro first moves the cell pointer tothe bottom of the worksheet so that when it moves the cell pointer to thelist of directories, you can see as much of the list as possible.andM;{?}~/C~dirt~/FDx{ESC} pauses to let you move the cell pointer to the desireddirectory name.andP;  When you press Return, the macro copies the name youselected to the range named dirt.andP;  The macro then selects /File Directory andclears the control panel.andM;{IF @CELL(&quot;type&quot;,dirt) andless;andgt;&quot;1&quot;}{ESC 3}{BEEP}{QUIT} checks to see if the cellnamed did contains a label.andP;  If it doesn't, the macro returns 1-2-3 to READYmode, beeps, and macro processing stops.andP;  Thus, if you move the cell pointerto a blank cell before pressing Return, the macro will stop rather than resetthe default directory.andM;The next line in the macro is the cell named dirt.andP;  It contains the directoryname you selected.andP;  The macro enters this name as the default directory usingthe tilde -) on the following line to finish the command.andM;The model described in this article is available on disk.andP;  See page 90 fordetails.andO;</TEXT></DOC>
<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF108-436-736  </DOCNO><DOCID>08 436 736.andM;</DOCID><JOURNAL>PC Magazine  May 29 1990 v9 n10 p393(4)* Full Text COPYRIGHT Ziff-Davis Publishing Co. 1990.andM;</JOURNAL><TITLE>Windows. (how Microsoft Windows graphical interface uses fonts)(column)</TITLE><AUTHOR>Hall, William S.andM;</AUTHOR><SUMMARY>A technical discussion of font technology in the Microsoft Windowsgraphical user interface is presented, along with a description ofBitstream's Fontware Windows font implementation.andP;  Bit-mapped, orimage, fonts are formed by lighting individual pixels in a bitpattern analogous to the type blocks used in traditional printing.andO;Outline, or vector, fonts use sequences of graphics commands todraw the outline of a character and fill its interior.andP;  Imagefonts can be optimized for a given size and device, but vectorfonts are more versatile because they can be scaled easily todifferent sizes.andP;  Windows 2.0 creates 'typographic' fonts for wordprocessing, desktop publishing, and drawing programs and 'system'fonts for displaying menus, titles, and dialog boxes.andP;  Itsupplies, ROMAN, SCRIPT, and MODERN vector fonts and bit-mappedfonts in sizes of 8, 10, 12, 14, 18, and 24 points.andP;  Bitstream'sFontware provides tools to generate up to 84 characters in anytypeface, allowing users to create customized fonts.andM;</SUMMARY><DESCRIPT>Company:   Microsoft Corp. (products).andO;Ticker:    MSFT.andO;Product:   Microsoft Windows (Graphical user interface) (design andconstruction).andO;Topic:     FontsGraphical User InterfaceSoftware DesignSystems SoftwareGraphics Systems.andM;</DESCRIPT><TEXT>WindowsandM;FONTS AND FONTWAREandM;Tired of the same old faces on your Microsoft Windows screen or printer?andP;  Doyou need special characters for a brochure youhre designing?andP;  Are youintrigued by the strange entries under [fonts] in your WIN .INI file, baffledby acronyms such as ANSI, or perhaps simply curious about how the ancient artof typography is realized in Windows?andP;  If so, then read on, because thisissue's column is all about how Windows uses fonts.andP;  We'll also take a lookat Bitstream's Fontware, a software package that creates fonts for Windows.andM;WINDOWS FONTSandM;Many end users--even power users, if the truth must be known--ask me aboutfonts.andP;  The inquiries are often accompanied by quiziical looks and confusedfaces.andP;  It seems there's a lot of confusion about them--and no small wonder:with the advent of computers, the word font has acquired enough new meaningsto confuse anyone.andM;A dictionary defines font as an assortment of type, all of one size andstyle.andP;  Type itself is defined as a rectangular block of wood or metalbearing a relief character from which an inked print is made.andM;In the computing world these definitions have been extended in many ways.andO;Imagine, for example, that the recipient of the print is a raster scanningdevice such as a PC monitor.andP;  Inking is simply a matter of lighting selectedpixel elements (pels).andP;  The pels to be lit for a given character aredetermined by a bit pattern that can be thought of as the type block; therelief consists of the bits that are on.andP;  Finally, an assortment of suchpatterns constitutes the font.andP;  This description defines the essence ofbitmapped or image fonts.andP;  Bitmapped fonts are the obvious extension ofclassical printing to computing.andM;But, there is another way to create characters on a display device, andthat's to do what people have done for centuries--draw them.andP;  Hence, insteadof a bit pattern, a character is described in terms of a sequence ofelementary graphics commands to actually draw the character's outline and tofill the interior.andP;  A collection of such rules is called an outline, vector,or stroke font.andP;  Arising from the days of storage-tube technology, they findwide use in plotters, PostScript pritners, and phototypesetting.andP;  Unlikebitmapped fonts, which have a specific size and resolution, outline andstroke fonts can be rotated to any angle and scaled to any size.andP;  Both imageand vector fonts are available in Windows.andM;Image fonts have an advantage in that they can be tailored to produce thebest appearance for a given size and device.andP;  And they require lesscomputation to display.andP;  However, a number of such fonts must be available inorder to create different sizes of characters.andP;  Of course, it is possible toscale the bit patterns themselves, but quality is often lost in the process.andO;By contrast, the very versatility of vector fonts renders them more expensiveto display in terms of computing time.andP;  And their appearance onlow-resolution devices or when scaled to small sizes is worse than can beachieved manually.andM;CHARACTERS SETSandM;A font includes a given set of symbols, called a character set.andP;  The mostwidely known character set is basic ASCII.andP;  Consisting of 94 glyphs(characters), a space, and 33 control codes, ASCII includes the letters ofthe English alphabet in both lower- and uppercase, punctuation marks,symbols, numerals, and diacritical marks.andP;  No glyphs are associated with thecontrol codes, whose values encompass 0 to 31 and 127.andP;  The space &quot;character&quot;has a value of 32, and the rest of the so-called printable characters rangein value from 33 to 126.andP;  Basic ASCII is called a 7-bit character set since amaximum of 7 bits of information is required to represent any single element.andM;An extension, called Business ASCII by Bitstream, adds additional symbols andpunctuation in the range of 161 to 175 and adds an extra space character at160.andP;  The values from 128 to 159 are reserved for 8-bit controls, which areneeded by such terminals as the DEC VT220.andP;  Business ASCII is an example ofan 8-bit character set, since those values above 127 require 8 bits torepresent them.andM;Your personal computer's ROM contains an 8-bit character set developed byIBM, which has a glyph for every value except 0 and 255.andP;  Containing basicASCII as a subset, the 8-bit positions contain a subset of letters fromWestern European languages requiring diacritical marks, symbols, somemathematical signs, and a collection of graphics characters.andM;In Windows, this character set is realized in a collection of files known asOEM (original equipment manufacturer) fonts.andP;  OEM character sets varyaccording to the keyboard type and country.andM;In Windows 2.x these fonts are found in files usually named FONTXXYY.FON.andO;The XX will be either LO, HI, or SQ, and are optimized for the CGA, EGA, andVGA displays, respectively.andP;  YY stands for a particular kind of keyboard: NOfor Nordic, PO for Portuguese, ES for Extended Spanish, and so on.andM;Windows requires the OEM font only when running a standard application in awindow.andP;  To see it, just execute COMMAND.COM from Windows.andP;  Windows/386 hasan additional special set of OEM fonts called EGA40.FON, EGA80.FON and so onto handle old applications.andM;All fonts that appear in Windows applications use a character set calledWindows ANSI.andP;  Again, an 8-bit character set including ASCII, ANSI containsenough characters in the range of 160 to 255 to render the major WesternEuropean languages when used with an appropriate keyboard driver.andP;  WindowsANSI cannot be used with many Eastern European languages, even those based onthe Roman alphabet, because a number of letters with diacritical marks aremissing.andM;Other character sets arise from printer technology.andP;  For example, severalhave been defined by Hewlett-Packard for their LaserJet printers and includeHP Roman 8, Linedraw, Math, and Pi.andM;TYPEFACES AND STYLESandM;A font usually uses a specific design, called a typeface.andP;  The SpeedballTextbook for Pen and Brush Lettering (by Ross F. George, 19th edition, 1965)recognizes three basic groups: Roman, Gothic, and Text.andP;  Characters composedof thick and thin elements are called Roman.andP;  Gothic letters are composed ofuniform width elements.andP;  Angular letters such as Old English and Old Germanare examples from the Text group, although others tend to regrd them asGothic.andP;  Any of these groups may be made into a serif font by adding a smallline at an angle to the upper and lower ends of the strokes of a letter.andM;The beautiful Roman letter evolved from the Greek form.andP;  Written by reed pensheld at a constant angle, the wide/narrow strokes were produced naturally.andO;Roman builders added the serifs when the letters were applied to inscriptionson the famous Roman arches.andP;  Endless variations exist today.andP;  One of its mostpopular forms, Times Roman, was developed (and copyrighted) by the Times ofLondon newspaper.andM;The Helvetica typeface provides a pleasing example of sans serif letters ofuniform width.andP;  The Helvetii were a Celtic people inhabiting WesternSwitzerland in the roman era.andP;  This may explain why such fonts arealternatively known as Swiss fonts.andM;Any font can be written in various styles, such as italics where the lettersare slated at about a 15-degree angle.andP;  Other styles include bold,underlined, and strike-over.andP;  They can be combined to produce a boldunderlined italic font.andP;  Windows can synthesize each of these types.andM;A font can be either fixed-pitch or proportionally spaced.andP;  The first case istypical of typewriters, some printers, and video terminals.andP;  Each characterhas the same width.andP;  If a font is proportional, the width can vary fromletter to letter.andP;  A font can also designate kerning pairs.andP;  These are pairsof letters that, because of their relative shapes, can be placed closer toeach other than their normal intercharacter spacing.andP;  The pairs AW and VAserve as examples of this spacing.andM;WINDOWS-SUPPLIED FONTSandM;The image fonts provided under Windows 2.0 can be classified as typographicor system, according to usage.andP;  The typographic fonts are used primarily byword processing, drawing, and desktop publishing applications such as WindowsWrite, Ami, and PageMaker.andP;  The typefaces include Times Roman (TMRSX.FON),Helvetica (HELVX.FON), and a fixed-pitch typewriter font called Courier(COURX.FON).andP;  In each case, the last letter in the filename signifies thedevice type for which the font was designed.andM;A fonts are for low-resolution displays such as the CGA.andP;  B fonts aredesigned for medium resolutions such as provided by the EGA and Herculesvideo cards.andP;  Fonts such as TMRSE.FON work well on the VGA.andP;  Fonts whose lastletter is D are made for the Epson class of printers in portrait mode,whereas the C fonts work best in landscape mode.andM;For displaying menus, dialog boxes, window titles, and the like, Windows 2.xuses the system font, which is currently a fairly bold fixed-pitch font usinga sans serif, modern typeface and the ANSI character set.andP;  Hopefully, thiswill be changed to a proportional font in a future release of Windows.andP;  Sucha change may sound trivial, but check out the appearance of OS/2'sPresentation Manager.andP;  The superior look of PM windows is due in no smallpart to the proportional font used.andM;Windows' system fonts have the name FONTXX.FON, where XX can be LO (CGA), HI(EGA), or SQ (VGA).andP;  You won't see this font file after you've run Setup,because it gets absorbed, as does the corresponding OEM font, into one of theWIN200 files.andM;An image font file in Windows is actually an executable file having a singleempty code segment that has been assembled and linked into an equally emptyexecutable to which one or more .FNT files have been attached.andP;  Each .FNTfile consists of a header data structure followed by the bit patterns for thevarious characters.andM;The .FNT files are added as resources to the executable.andP;  When the font isinstalled by the Windows control panel or during Setup, a notation is made inthe [fonts] section of WIN.INI in the form keystring=valstring.andP;  Thekeystring describes the font and the valstring names the file in which it canbe found.andP;  When Windows runs, the strings are read, and enough of the .FONfile (224 bytes for each .FNT file contained therein) is loaded to be able tofind the rest of the font if an application needs it.andP;  Clearly, you can savesome memory space by installing fewer fonts but at the price of reducedcapability.andM;The standard Windows fonts provide sizes of 8, 10, 12, 14, 18, and 24 points,a point being 1/72 of an inch.andP;  Depending on the display on which the fontwas digitized, the height and width, in bits, will vary.andP;  None of the Windowsfonts have any specific type, since all can be synthesized.andP;  However,products such as Fontware can make separate characters that may look betterthan the synthesized ones.andM;Windows also supplies three vector fonts called ROMAN, SCRIPT, and MODERN.andO;These are actually OEM fonts but use the ANSI character set.andP;  I don't knowenough of their organization to describe them in detail.andM;Here is a tip for Windows 2.x users:  You can store your fonts in anotherdirectory if it is named in your path.andP;  You can also use the DOS APPENDcommand to point to their location.andP;  This can reduce clutter in your Windowsdirectory.andM;HOW WINDOWS USES THE FONTSandM;Let us suppose you have a dot matrix printer such as an Epson FX-100 as yourprimary printer.andP;  Using Windows Write, load and print that perennial favoritePRACTICE.WRI, which comes with your Windows distribution disks.andP;  When youprint it, note that you get a rather good rendering of the Helvetica andCourier fonts used in the document.andP;  If you happen to change one of theparagraphs to Times Roman, that comes out fairly well, too.andP;  How is thispossible, since such fonts are not built into the printer?andM;What happens is that the fonts you see on the screen are those designed forthe display.andP;  But when printing occurs, your document (or part of it) iscomposed again, this time is memory, using the fonts which are appropriatefor the printing device's resolution and aspect ratio.andP;  The result is thensent to the printer as a graphics image.andP;  The process is repeated until theend of the document is reached.andM;Now try an experiment.andP;  Using the Control Panel, remove HELVD.FON fromWindows' list of fonts.andP;  (However, don't delete the file!)andP;  And then printthe file again.andP;  You'll find that it won't look nearly as nice.andP;  Whathappened is that when you deleted the D font, you removed the font providingthe best available match to the characteristics of the printer.andP;  Windows mustthen create a font from the remaining ones available and the quality may dropif the match is not a good one.andM;If you print WIN.INI from Notepad, no attempt is made to much the font yousee on the display.andP;  Instead the text is transferred directly to the printer,which then uses its own internal fonts.andM;EXPANDING AVAILABLE FONTSandM;The discussion above illustrates why Windows becomes a less-useful tool forquality text processing if your font set doesn't match the requirements ofyour output devices.andP;  A really good example is provided by some Toshibaprinters with resolutions of 180 dots per inch horizontally and 60vertically.andP;  When a columnist for the now defunct Sextant magazine lamentedthe poor quality of his Toshiba's output, I suggested that he try creatingnew printer fonts using Bitstream's Fontware package.andP;  The results were agreat improvement.andM;You may want to generate new fonts for many other reasons.andP;  An obvious one isto obtain access to a wide variety of typefaces; in one of Bitstream's recentcatalogs I counted over 50 faces, including classic typewriter, a variety ofRoman, Gothic, Modern, and numerous special-purpose types.andP;  Most supportitalic, bold, and bold italic styles.andM;If you're fortunate enough to have a PCL printer capable of supporting softfonts, you can greatly increase the variety of fonts over those contained infont catridges.andP;  Finally, you may need a special character set; in the latestversion of Fontware, a limited customized set can be created.andM;There is good news for Microsoft Excel users.andP;  Bitstream is currentlyproviding a $25 starter kit specifically for Excel, though anyone canpurchase it.andP;  For this price, you get Fontware, Version 3.0, and twotypefaces, Swiss and Dutch, which sets you up with the basic Gothic and Romancategories.andP;  Each can be used to generate fonts of any size (includingdecimal increments) up to certain specified maximums that depend on yourprinter and display.andP;  Styles include italic, bold, and bold italic.andP;  Supportin the starter kit is not provided for PostScript outline fonts.andM;Additional typefaces can be purchased for about $180 each from Bitstream orfor considerably less from dealers.andP;  Even so, building up an extensivelibrary of different fonts can be expensive, but the results are usuallyworth it.andM;Font generation is a slow process involving quite a great deal of real-numbercalculation.andP;  Hence, if you use Fontware frequently, you may want to installa floating-point chip such as an 80287 or 80387 in your machine.andP;  Since many386 computers can also use the 80287, which is quite adequate--and muchcheaper--this may provide the best compromise of speed and price.andM;I've found the quality of such fonts to be fairly good.andP;  It can be useful toproduce sizes not provided by the standard Windows selections.andP;  This isespecially true for the larger fonts, frequently generated in Windows simplyby doubling the width or height of some smaller font, and always resulting inan unacceptable loss of quality.andP;  By creating fonts of the required size, youcan greatly improve the appearance of your documents.andP;  I especially likebeing able to produce downloadable fonts for a PCL printer to increase itsversatility.andM;CUSTOM CHARACTERSandM;Finally, let me mention one other powerful feature of Fontware--thecapability to create customized character sets.andP;  The current version providesa tool to generate a typeface containing up to 94 characters.andP;  One use is tocreate a large, headline font containing only a few characters.andP;  Large fontscan use a lot of computer memory, so it is advantageous to limit the numberof characters to those needed.andM;The elements of a customized font can be chosen from the BitstreamInternational Character Set (BICS), which has some 560 characters.andP;  I decidedto test this capability by putting together a font that would contain theletters with diacritical marks of the main Western Slavic languages (Czech,Polist, and Slovak).andP;  I also wanted to have standard ASCII, so the bestapproach seemed to try to replace the last 64 characters in the Windows ANSIset with my choices.andP;  Since Fontware's tools for customized fonts is limited,it was necessary to examine some of the files in the CSD subdirectory, wherethe character sets are defined.andM;It turns out that the .CSD files are simply text files.andP;  First I usedFontware to create a customized character set containing the ASCII characterset.andP;  Then, with my text editor I edited the corresponding .CSD file.andP;  Sincethe file consists mainly of a column of paired figures of the form XX:XY, itwas not hard to figure out that the first number is the position in thecharacter set and the second the BICS index.andP;  By adding the necessarypairings, I was able to construct a font containing all but one of thespecial characters I wanted: the Slovak r with an acute accent (long r).andM;Finally, I made and tested the font for both printer and display using thetwo typefaces supplied with the starter kit.andP;  I also created standard WindowsANSI fonts.andP;  Generally, the characters in the ASCII range (32 to 127) werewell formed.andP;  But, as I expected, the high-order ones did not fare so well.andM;Accents on some of the capital letters were either missing (the umlaut) orindistinguishable.andP;  Such errors might be minimized if the font has internalleading, which is the region reserved for diacritical marks.andP;  In the suppliedtypefaces, those characters having accents above are simply made smaller thantheir unaccented companions, resulting in further reduction of the quality ofthese letters.andP;  Hence, you may need to correct your font.andP;  In the future I'llreport on tools to do this.andM;Before we close, here's a tip from frequent contributor Barry Simon:andM;Tired of seeing the Microsoft logo everytime you start Windows?andP;  Here's howto make it go away.andP;  Hit the Spacebar after typing the command w in and thenhit Enter and no logo will appear.andP;  This will work in a batch file, althoughyour editor may trim trailing spaces.andP;  If it does, use the command win [isgreater than] nu1 instead.andM;OPENING WINDOWSandM;Share your experiences with the Windows environment.andP;  We'll pay you $50 forany tips we print.andP;  Please send your letter on a disk along with a printout.andO;Mail your contributions to Windows, PC Magazine, One Park Avenue, New York,NY 10016, or upload them to PC MagNet (see the &quot;By Modem&quot; sidebar in theUtilities column).andO;</TEXT></DOC>
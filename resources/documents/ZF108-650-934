<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF108-650-934  </DOCNO><DOCID>08 650 934.andM;</DOCID><JOURNAL>PC-Computing  August 1990 v3 n8 p132(2)* Full Text COPYRIGHT Ziff-Davis Publishing Co. 1990.andM;</JOURNAL><TITLE>Create a 1-2-3 menu for macros. (Lotus 1-2-3) (tutorial)</TITLE><AUTHOR>Gasteiger, Daniel.andM;</AUTHOR><SUMMARY>A technique for creating macro-based custom menus in Lotus 1-2-3is presented.andP;  Custom menus look and act exactly like normal 1-2-3menus but trigger macros instead of activating built-in commands.andO;Menu macros begin with branching and calling commands that lead tocollections of labels representing how a user-defined menu appearsin the control panel.andP;  Code for a sample custom menu that controlsexisting macros is shown, and step-by-step programminginstructions are given.andP;  Users should make sure that menu itemshave short but descriptive names; that cells just to the right ofthose containing the menu item are blank; and that no two menuprompts in a menu begin with the same letter.andP;  The most commonlyused macro should be first on the list of menu items.andM;</SUMMARY><DESCRIPT>Company:   Lotus Development Corp. (products).andO;Ticker:    LOTS.andO;Product:   Lotus 1-2-3 (Spreadsheet software) (usage).andO;Topic:     MenusMacrosTutorialSpreadsheetsProgramming Instruction.andM;</DESCRIPT><TEXT>WHEN YOU USE macros in Lotus 1-2-3, whether for common or complicated taskssuch as setting column widths, entering printer setup strings, and savingfiles, you reduce keystrokes and mistakes.andP;  But the more utility macros youcreate, the more difficult it is to remember which macro performs which task.andO;The answer? Organize your macros under a customized macro menu.andM;Custom menus, which are actually elaborate, specialized macros, look andbehave just like 1-2-3 menus.andP;  They appear in the control panel just abovethe worksheet, and you select menu items by moving the cursor to the item orby typing the first letter of the item's name.andP;  The difference is that anitem from a custom menu, instead of activating a built-in 1-2-3 command,triggers one of the macros you've created.andM;To see how easily you can create a custom menu for macros, perform this quickexercise: Start in a blank 1-2-3 worksheet and enter labels as shown in thefollowing illustration.andP;  Note that we've adjusted the column widths to revealall the characters in the macro.andP;  You don't need to expand column widths foryours to run properly.andM;Enter all the characters as shown, including the red apostrophe in cell Al.andO;The apostrophe won't appear in the worksheet when you save the cell, but itserves as a label prefix for the macro name \M.andP;  The program automaticallyadds label prefixes to the other text shown in the example.andP;  Next, issue thecommand / Range Name Labels Right, and indicate range A1..A3 as the labelrange.andP;  This assigns the name \M to cell B1 and MEN1 to cell B3.andM;You're done.andP;  To activate the menu, hold down the Alt key and press M. Themenu appears in the control panel.andP;  If you select Yes from the menu, yourcomputer beeps.andP;  If you select No, your computer remains silent.andM;Branching and CallingandM;To understand exactly how custom menus work, you must understand theircomponents.andP;  A menu macro in 1-2-3 Releases 2.0 and later begins with thecommand {MENU-BRANCH},  as used in the example, or {MENUCALL}.andP;  (You can use/XM instead of {MENUBRANCH} in any release.) Both commands and /XM tell 1-2-3to go to a set of cells and to treat the macro commands found there as amenu.andP;  These macro commands are typically stacked in adjacent columns, as arethe commands in cells B3..B7 and C3..C5 in the example.andM;The difference between {MENUBRANCH} and {MENUCALL} is apparent when youinclude these commands as part of a larger macro.andP;  When you select an itemfrom a {MENUCALL} menu, its macro routine runs, then macro control returns tothe command following the original {MENUCALL}.andM;Whenever 1-2-3 encounters {MENUBRANCH} in a macro, it displays a custom menuand transfers control irreversibly to the command associated with yourselection.andP;  Control doesn't return to the original {MENUBRANCH} unless youpress the Esc key in response to the menu.andM;To see the difference in the example above, substitute {MENUCALL MEN1} for{MENUBRANCH MEN1} in cell A2 and place the command {MENUBRANCH MEN1} in B2.andO;When you press Alt-M and choose  Yes,&quot; the tone beeps and the menu reappears.andO;That's because the macro returns execution to whatever command is in the cellbeneath {MENUCALL}.andP;  In this case, {MENUBRANCH MEN1} in B2 tells the macro tobranch to MEN1 again.andP;  If you choose  No,&quot; the menu does not reappear becausethe macro processor encounters the {QUIT} command, which ends the macro.andM;For simplicity, the example uses {MENUBRANCH} because the menu is not part ofa larger menu.andP;  But except for the difference we've noted, {MENUBRANCH},{MENUCALL}, and /XM function similarly.andP;  They all take the form commandlocation-for example, {MENUBRANCH} MEN1.andP;  This means, &quot;find a set of menuinstructions at the named range, and follow those instructions to display amenu in the control panel.&quot; In the example, location identifies the menuinstructions that begin with the cell MEN1 (B3).andM;Menu instructionsandM;What these commands lead to-the menu instructions-are a collection of labelsthat represent how a menu appears in the control panel.andP;  Menu instructionsuse two rows of the worksheet.andP;  The first row contains a list of menu items,each occupying its own cell.andP;  You can have up to eight items.andM;The second row clarifies the meanings of the menu items by describing whatthe selections do.andP;  Each description appears in the control panel when youhighlight its menu selection.andM;In the example, when the macro processor detects the command {MENUBRANCHMEN1}, it looks in the cell named MEN1 for a set of menu instructions.andP;  Themacro processor displays the row of menu items in the control panel with themenu pointer highlighting the first one, &quot;Yes.&quot; The correspondingdescription, &quot;Sound a tone,&quot; appears beneath the item.andP;  When you make aselection from the menu, the macro's control shifts from {MENUBRANCH}.andP;  Ifyou select  Yes,&quot; control passes to the cell directly beneath thedescription, that is, to cell B5.andP;  If you select  No,&quot; control passes to cellC5.andM;Create Your Own Macro Menu Now let's create a custom menu that controlsmacros you already use.andM;Suppose your worksheet contains three macros named \S, \H, and \V, as in theexample shown at upper right.andP;  (For simplicity, we'll limit the discussion tothree macros, but in fact you can include many more.)andM;To put these macros under menu control, rename each by entering new labels incolumn A. For this example, we'll use ADD in cell Al, HLINE in A3, and VLINEin A5.andM;Now enter the command that calls the menu.andP;  In cell A7, enter the characters'\M.andP;  Enter the label {MENUBRANCH UTILS} into B7 and enter UTILS in A9.andO;Finally, create the menu instructions beginning in B9 so that your worksheetlooks like the one at the bottom of this page.andM;Assign all the new range names associated with the macros and their menu byselecting / Range Name Labels Right, highlighting range A1..A9, and pressingEnter.andP;  Activate the new menu by pressing Alt-M, and select a task.andM;Finally, create a menu that uses your own macro collection.andP;  Once you get thehang of creating menus, you can create complete menu-driven applications thatsimplify complex tasks, such as tracking stocks or balancing your books.andM;Regardless of bow simple or complex your menus become, keep the followingguidelines in mind:andM;1.andP;  The names of menu items should be short but descriptive.andM;2.andP;  The cells immediately to the right of the cells containing the menu itemnames should be blank.andP;  If they're not, the contents of those cells mayappear on your menu.andM;3.andP;  No two menu prompts in a menu should begin with the same letter.andP;  If twoprompts share a first letter, you can select the second prompt only bypointing to it and pressing Enter.andM;4.andP;  Make your most commonly used macro the first on the list of menu items.andO;Since it appears with the cursor already highlighting it, you can execute itby simply pressing Enter.andM;A        BandM;1    '\S     '\=~{DOWN}@SUM({UP}.{end}{UP}..)~andM;2andM;3    '\H     '\-~/C~.andM;4andM;5    '\V     '^|~/C~.andM;A        B                    C              DandM;1  ADD      '\=~{DOWN}@SUM({UP}.{end}{UP}..)~andM;3  HLINE    '\~/C~.andM;5  VLINE    '^|~C~.andM;7  '\M      {MENUBRANCH UTILS}andM;9  UTILS    Sum               Horizontal        VerticalandM;10          Total column      '-Divide line     '| Divide lineandM;11          {BRANCH ADD}      {BRANCH HLINE}    {BRANCH VLINE}andM;A              B                  CandM;1    \M      {MENUBRANCH MEN1}andM;2andM;3   MEN1     Yes                   NoandM;4            Sound a tone          Don't sound a toneandM;5            {BEEP 1}              {QUIT}andM;6            {BEEP 2}andM;7            {BEEP 3}</TEXT></DOC>
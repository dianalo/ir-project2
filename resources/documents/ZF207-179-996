<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF207-179-996  </DOCNO><DOCID>07 179 996.andM;</DOCID><JOURNAL>Hewlett-Packard Journal  April 1989 v40 n2 p15(7)* Full Text COPYRIGHT Hewlett Packard 1989.andM;</JOURNAL><TITLE>Precision AC voltage measurements using digital samplingtechniques. (HP 3458A Digital Multimeter) (technical)</TITLE><AUTHOR>Swerlein, Ronald L.andM;</AUTHOR><SUMMARY>The HP 3458A Digital Multimeter is able to sample the input signaland compute the rms value digitally in real time in order tomeasure rms ac voltages.andP;  The device implements a digital methodfor precise measurements of the voltages, using a techniquesimilar to that of a modern digitizing oscilloscope.andP;  The finalmeasurement result is produced by computing the rms value of thedata in real time.andP;  The devices objectives for high-precisionsdigital ac measurements necessitate the development of newmeasurement algorithms, as well as a track-and-hold circuitcapable of fulfilling these needs.andP;  The HP 3458A's performancewith sinusoidal and nonsinusoidal inputs is excellent.andP;  In tests,the device performed with errors ranging from 5 parts per millionto 50 parts per million for 7V rms inputs from 100 Hz to 10 kHz.andM;</SUMMARY><DESCRIPT>Company:   Hewlett-Packard Co. (products).andO;Ticker:    HWP.andO;Product:   HP 3458A Digital Multimeter (Test equipment, electronic) (designand construction).andO;Topic:     Test EquipmentVoltageMeasurementSamplingAnalog to Digital Convertors.andO;Feature:   illustrationchart.andO;Caption:   Simplified block diagram of a subsampling ac voltmeter. (chart)Basic track-and-hold circuit with ideal components. (chart)Basic track-and-hold circuit with real components. (chart)andM;</DESCRIPT><TEXT>Precision AC Voltage Measurements Using Digital Sampling TechniquesandM;THE HP 3458A DIGITAL MULTIMETER implements a digital method for the pricesmesurement of rms ac voltages.andP;  A technique similar to that of a moderndigitizing oscilloscope is used to sample the input voltage waveform.andP;  Therms value of the data is computed in real time to produce the finalmeasurement result.andP;  The HP 3458A objectives for high-precision digital acmeasurements required the development of both new measurement algorithms anda track-and-hold circuit capable of fulfilling these needs.andM;Limitations of Conventional TechniquesandM;All methods for making ac rms measurements tend to have various performancelimitations.andP;  Depending on the needs of the measurement, these limitationstake on different levels of importance.andM;Perhaps the most basic specification of performance is accuracy.andP;  For acmeasurements, accuracy has to be specified over a frequency band.andP;  Usually,the best accuracy is for sine waves at midband frequencies (typically 1 kHzto 20 kHz).andP;  Low-frequency accuracy usually refers to frequencies below 200Hz (some techniques can work down to 1 Hz).andP;  Bandwidth is a measure of thetechnique's performance at higher frequencies.andM;Linearity is another measure of accuracy.andP;  Linearity is a measure of how muchthe measurement accuracy changes when the applied signal voltage changes.andP;  Ingeneral, linearity is a function of frequency just as accuracy is, and can beincluded in the accuracy specifications.andP;  For instance, the accuracy at 1 kHzmay be specified as 0.02% of reading +0.01% of range while the accuracy at100 kHz may be specified as 0.1% of reading +0.1% of range.andP;  Thepercent-of-range part of the specification is where most of the linearityerror is found.andM;If a nonsinusoid is being measured, most ac rms measurement techniquesexhibit additional error.andP;  Crest-factor error is one way to characterize thisperformance.andP;  Crest factor is defined as the ratio of the peak value of awaveform to its rms value.andP;  For example, a sine wave has a crest factor of1.4 and a pulse train with a duty cycle of 1/25 has a crest factor of 5.andO;Even when crest factor error is specified, one should use caution whenapplying this additional error if it is not given as a function of frequency.andO;A signal with a moderately high crest factor may have significant frequencycomponents at 40,000 times the fundamental frequency.andP;  Thus crest factorerror should be coupled with bandwidth information in estimating the accuracyof a measurement.andP;  In some ac voltmeters, crest factor specifications meanonly that the voltmeter's internal amplifiers will remain unsaturated withthis signal, and the accuracy for nonsinusoids may actually be unspecified.andM;Some of the secondary performance specifications for rms measurements areshort-term reading stability, settling time, and reading rate.andP;  Theseparameters may have primary importance, however, depending on the need of themeasurement.andP;  Short-term stability is self-explanatory, but the differencebetween settling time and reading rate is sometimes confusing.andP;  Settling timeis usually specified as the time that one should wait after a full-scalesignal amplitude change before accepting a reading as having full accuracy.andO;Reading rate is the rate at which readings can be taken.andP;  Its possible for anac voltmeter that has a one-second settling time to be able to take more than300 readings per second.andP;  Of course, after a full-scale signal swing, thenext 299 readings would have degraded accuracy.andP;  But if the input signalswing is smaller than full-scale, the settling time to specified accuracy isfaster.andP;  Therefore, is some situations, the 300 readings/second capability isactually useful even though the settling time is one second.andM;The traditional methods for measuring ac rms voltage are thermal conversionand analog computation.andP;  The basis of thermal conversion is that the heatgenerated in a resistive element is proportional to the square of the rmsvoltage applied to the element.andP;  A thermocouple is used to measure thisgenerated heat.andP;  Thermal conversion can be highly accurate with both sinewaves and waveforms of higher crest factor.andP;  Indeed, this accuracy is part ofthe reason that the U.S.andP;  National Institute of Standards and Technology(formerly the National Bureau of Standards) uses this method to supply acvoltage traceability.andP;  It can also be used at very high frequencies (in thehundreds of MHz).andP;  But thermal conversion tends to be slow (near one minuteper reading) and tends to exhibit degraded performance at low frequencies(below 20 Hz).andP;  The other major limitation of thermal conversion is dynamicrange.andP;  Low output voltage, low thermal coupling to the ambient environment,and other factors limit this technique to a dynamic range of around 10 dB.andO;This compares to the greater than 20 dB range typical of other techniques.andM;Analog computation is the other common technology used for rms measurements.andO;Essentially, the analog converter uses logging and antilogging circuitry toimplement an analog computer that calculates the squares and square rootsinvolved in an rms measurement.andP;  Since the rms averaging is implemented usingelectronic filters (instead of the physical thermal mass of the thermalconverter), analog computation is very flexible in terms of reading rate.andO;This flexibility is the reason that this technique is offered in the HP 3458AMultimeter as an ATE-optimized ac measurement function (SETACV ANA).andO;Switchable filters offer settling times as fast as 0.01 second forfrequencies above 10 kHz.andP;  With such a filter, reading rates up to 1000readings/second may be useful.andM;Analog computation does have some severe accuracy drawbacks, however.andP;  It canbe very accurate in the midband audio range, but both its accuracy and itslinearity tend to suffer severe degradations at higher frequencies.andP;  Also,the emitter resistance of the transistors commonly used to implement thelogging and antilogging functions tend to cause errors that are crest-factordependent.andM;Digital AC TechniqueandM;Digital ac is another way to measure the rms value of a signal.andP;  The signalis sampled by an analog-to-digital converter (ADC) at greater than thesignal's Nyquist rate to avoid aliasing errors.andP;  A digital computer is thenused to compute the rms value of the applied signal.andP;  Digital ac can exhibitexcellent linearity that doesn't degrade at high frequencies as analog accomputation does.andP;  Accuracy with allw aveforms is comparable to thermaltechniques without their long settling times.andP;  It is possible to measure lowfrequencies faster and with better accuracy than other methods using digitalac measurements.andP;  Also, the technique lends itself to autocalibration of bothgain and frequency response errors using only an external dc voltage standard(see article, page 22).andM;In its basic form, a digital rms voltmeter would sample the input waveformwith an ADC at a fast enough rate to avoid aliasing errors.andP;  The sampledvoltage points (in the form of digital data) would then be operated on by anrms estimation algorithm.andP;  One example is shown below: Num = number ofdigital samples Sum = sum of digital data Sumsq = sum of squares of digitaldata ac rms = SQR((Sumsq-Sum*Sum/Num)/Num)andM;Conceptually, digital rms estimation has many potential advantages that canbe exploited in a digital multimeter (DMM).andP;  Accuracy, linearity over themeasurement range, frequency response, short-term reading stability, andcrest factor performance can all be excellent and limited only by the errorsof the ADC.andP;  The performance limitations of digital ac are unknown at thepresent time since ADC technology is continually improving.andM;Reading rates can be as fast as theoretically possible because idealaveraging filters can be implemented in firmware.andP;  Low-frequency settlingtime can be improved by measuring the period of the input waveform andsampling only over integral numbers of periods.andP;  This would allow a 1-Hzwaveform to be measured in only two seconds--one second to measure the periodand one second to sample the waveform.andM;Synchronous SubsamplingandM;A thermal converter can measure ac voltages in the frequency band of 20 Hz to10 MHz with state-of-the-art accuracy.andP;  Sampling rates near 50 MHz arerequired to measure these same frequencies digitally, but present ADCs thatcan sample at this rate have far less linearity and stability than isrequired for stte-of-the-art accuracy in the audio band.andP;  If the restrictionis made that the signal being measured must be repetitive, however, atrack-and-hold circuit can be used ahead of a slower ADC with higherstability to create an ADC that can effectively sample at a much higher rate.andO;The terms &quot;effective time sampling,&quot; &quot;equivalent time sampling,&quot; and&quot;subsampling&quot; are used interchangeably to describe this technique.andM;The concept of subsampling is used by digitizing oscilloscopes to extendtheir sample rate to well beyond the intrinsic speed of the ADC.andP;  The conceptis to use a trigger level circuit to establish a time reference relative to apoint on a repetitive input signal.andP;  A timing circuit, or time base, is usedto select sample delays from this reference point in increments determined bythe required effective sampling rate.andP;  For example, moving the sampling pointin 10-ns increments corresponds to an effective sampling rate of 100 MHz.andP;  Ablock diagram of a subsampling ac voltmeter is shown in Fig.andP;  1.andM;Fig.andP;  2 is a simple graphic example of subsampling.andP;  Here we have an ADC thatcan sample at the rate of five samples for one period of the waveform beingmeasured.andP;  We want to sample one period of this waveform at an effective rateof 20 samples per period.andP;  First, the timing circuit waits for a positivezero crossing and then takes a burst of five readings at its fastest samplerate.andP;  This is shown as &quot;First Pass&quot; in Fig.andP;  2.andP;  On a subsequent positiveslope, the time base delays an amount of time equal to one fourth of theADC's minimum time between samples and again takes a burst of five readings.andO;This is shown as &quot;Second Pass.&quot;andP;  This continues through the fourth pass, atwhich time the applied repetitive waveform has been equivalent time sampledas if the ADC could acquire data at a rate four times faster than it actuallycan.andM;The digital ac measurement technique of the HP 3458A is optimized forprecision calibration laboratory measurements.andP;  short-term measurementstability better than 1 ppm has been demonstrated.andP;  Absolute accuracy betterthan 100 ppm has been shown.andP;  This accuracy is achieved by automatic internaladjustment relative to an external 10V dc standard.andP;  No ac source is required(see article, page 22).andP;  The internal adjustments have the added benefit ofproviding a quick, independent check of the voltage ratios and transfers thatare typically performed in a standards laboratory every day.andP;  Fast, accurate1-Hz measurements and superb performance with nonsinusoids allow calibrationlaboratories to make measurements easily that were previously very difficult.andM;The HP 3458A enters into the synchronously subsampled ac mode through thecommand SETACV SYNC.andP;  For optimal sampling of the input signal, one mustdetermine the period of the signal, the number of samples required, and thesignal bandwidth.andP;  The measurement resolution desired and the potentialbandwidth of the input waveform are described using the commands RES andACBAND.andP;  The period of the input signal is measured by the instrument.andP;  Themore the HP 3458A knows about the bandwidth of the input and the requiredmeasurement resolution, the better the job it can do of optimizing accuracyand reading rate.andP;  Default values are assumed if the user chooses not toenter more complete information.andP;  An ac measurement using the SYNC modeappears to function almost exactly the same to the user as one made using themore conventional analog mode.andM;Subsampled AC AlgorithmandM;The algorithm applied internally by the HP 3458A during each subsampled acmeasurment is totally invisible to the user.andP;  The first part of a subsampledac measurement is autolevel.andP;  The input waveform is randomly sampled for aperiod of time long enough to get an idea of its minimum and maximum voltagepoints.andP;  This time is at least one cycle of the lowest expected frequencyvalue (the low-frequency value of ACBAND).andP;  The trigger level is then set toa point midway between the minimum and maximum voltages, a good triggeringpoint for most waveforms.andP;  In the unlikely event that this triggering pointdoes not generate a reliable trigger, provision is made for the user togenerate a trigger signal and apply it to an external trigger input.andP;  Anexample of such a waveform is a video signal.andP;  Even though video signals canbe repetitive, they are difficult to trigger on correctly with just astandard trigger level.andM;With the trigger level determined, the period of the input waveform ismeasured.andP;  The measured period is used along with the global parameter RES todetermine subsampling parameters.andP;  These parameters are used by the timingcircuitry in the hP 3458A to select the effective sample rate, the number ofsamples, and the order in which these samples are to be taken.andP;  In general,the HP 3458A tries to sample at the highest effective sample rate consistentwith meeting the twin constraints of subsampling over an integral number ofinput waveform periods and restricting the total number of samples to aminimum value large enough to meet the specified resolution.andP;  This pushes thefrequency where aliasing may occur as high as posisble and also performs thebest rms measurement of arbitrary waveforms of high crest factor.andP;  The numberof samples taken will lie somewhere between 4/RES and 8/RES depending on themeasured period of the input waveform.andM;The final tep is to acquire samples.andP;  As samples are taken, the data isprocessed in real time at a rate of up to 50,000 samples per second tocompute a sum of the readings squared and a sum of the readings.andP;  After allthe samples are taken, the two sum registers are used to determine standarddeviation (ACV function), or rms value (ACDCV function).andP;  For example,suppose a 1-kHZ waveform is being measured and the specified measurementresolution is 0.001%.andP;  When triggered, the HP 3458A will take 400,000 samplesusing an effective sample rate of 100 MHz.andP;  The timing circuit waits for apositive-slope trigger level.andP;  Then, after a small fixed delay, it takes aburst of 200 readings spaced 20 [mu]s apart.andP;  It waits for another trigger,and when this occurs the timing circuit adds 10 ns to the previous delaybefore starting another burst of 200 readings.andP;  This is repeated 2,000 times,generating 400,000 samples.andP;  Effectively, four periods of the 1-kHz signalare sampled with samples placed every 10 ns.andM;Sources of ErrorandM;Internal time base jitter and trigger jitter during subsampling contributemeasurement uncertainty to the rms measurement.andP;  The magnitude of thisuncertainty depends on the magnitude of these timing errors.andP;  The internaltime base jitter in the HP 3458A is less than 100 ps rms.andP;  Trigger jitter isdependent on the input signal's amplitude and frequency, since internal noisewill create greater time uncertainties for slow-slew-rate signals than forfaster ones.andP;  A readily achievable trigger jitter is 100 ps rms for a 1-MHzinput.andP;  Fig.andP;  3 is a plot generated by mathematical modeling of theperformance of a 400,000-sample ac measurement using the HP 3458A'ssubsampling algorithm (RES = 0.001%) in the presence of 100-ps time base andtrigger jitters.andP;  The modeled errors suggest the possibility of stable andaccurate ac measurements with better than 6-digit accuracy.andM;Errors other than time jitter and trigger jitter limit the typical absoluteaccuracy of the HP 3458A to about 50 ppm, but there is reason to believe thatshort-term stability is better than 1 ppm.andP;  Many five-minute stability testsusing a Datron 4200 AC Calibrator show reading-to-reading standard deviationsbetween 0.7 ppm and 3 ppm.andP;  Other measurements independently show the Datron4200 to have similar short-term stability.andP;  More recently, tests performedusing a Fluke 5700 Calibrator, which uses a theoreitcally quieter levelingloop, show standard deviations under 0.6 ppm.andM;The above algorithm tries to sample the applied signal over an integralnumber of periods.andP;  To do this, the period of the signal must first bemeasured.andP;  Errors in measuring the period of the input waveform will causethe subsequent sampling to cover more or less than an integral number ofperiods.andP;  Thus, the accuracy of the subsampled ac rms measurement is directlyrelated to how accurately the period of the input waveform is known relativeto the internal sample time base clock.andM;Period measurements in the HP 3458A are performed using reciprocal frequencycounting techniques.andP;  This method allows accuracy to be traded off formeasurement speed by selecting different gate times.andP;  A shorter gate timecontributes to a faster measurement, but the lower accuracy of the perioddetermination contributes to a less accurate ac measurement.andP;  Fig.andP;  4 is agraph of the error introduced into the rms measurement by various gate times.andO;At high frequencies, this error is a constant dependent on the resolution ofthe frequency counter for a given gate time.andP;  At lower frequencies, triggertime jitter increases, causing increased error, because random noise has alarger effect on slower signals.andP;  At still lower frequencies, where theperiod being measured is longer than the selected gate time, this errorbecomes constant again.andP;  This is because the gate time is always at least oneperiod in length, and as the frequency is lowered, the gate time increasesjust fast enough to cancel the effect of increasing trigger jitter.andM;Any violation of the restriction that the input waveform be repetitive willalso lead to errors.andP;  A common condition is amplitude and frequencymodulation of the input.andP;  If this modulation is of a fairly small magnitudeand is fast compared to the total measurement time this violation of therepetitive requirement will probably be negligible.andP;  At most,reading-to-reading variation might increase slightly.andP;  If these modulationsbecome large, however, subsampled ac accuracy can be seriously compromised.andO;The signal sources typically present on a lab bench or in a calibrationlaboratory work quite well with the subsampling algorithm of the HP 3458A.andM;Random noise spikes superimposed on an input can make an otherwise repetitiveinput waveform appear non-repetitive.andP;  Induced current caused by motors andelectrical devices turning on and off is just one of many ways to generatesuch spikes.andP;  Large test systems tend to generate more of this than bench andcalibration laboratory environments.andP;  Low-voltage input signals (below 100mV) at low frequencies are the signals most susceptible to these errors.andM;Two ways are provided by the HP 3458A to deal with these potential errors.andO;The first is to use the internal 80-kHz low-pas trigger filter to reducehigh-frequency trigger noise (LFILTER ON).andP;  If this is not enough, provisionis made for accepting external synchronization pulses.andP;  In principle, gettingsubsampled ac to work in a noisy environment is no more difficult thangetting a frequency counter to work in the same environment.andM;If nonsinusoidal signals are being measured, the subsampling algorithm hassome additional random errors that become greater for signals of large crestfactor.andP;  All nonsinusoidal repetitive signals have some of their spectralenergy at frequencies higher than their fundamental frequency.andP;  Signals ofhigh crest factor generally have more of this high-frequency energy thanthose of lower crest factor.andP;  Random timing jitter, which tends to affecthigher frequencies the most, will create measurement errors that are greaterfor large-crest-factor signals.andP;  These random errors can be reduced byspecifying a higher-resolution measurement, which forces more samples perreading to be acquired.andP;  The additional measurement error induced by a signalcrest factor of 5 can be as low as 50 ppm in the HP 3458A.andM;Track-and-hold CircuitandM;Track-and-hold performance is critical to the accuracy of digital acmeasurements.andP;  Track-and-hold linearity, bandwidth, frequency flatness, andaperture jitter all affect the error in a sampled measurement.andP;  To meet theHP 3458A performance objectives, track-and-hold frequency response flatnessof [plus-or-minus]0.0015% (15 ppm) was required from dc to 50 kHz, along wihta 3-dB bandwidth of 15 MHz.andP;  In addition, 16-bit linearity 50 kHz and lowaperture jitter were needed.andP;  A custom track-and-hold amplifier was developedto meet these requirements.andM;The most basic implementation of a track-and-hold circuit--a switch and acapacitor--is shown in Fig.andP;  5.andP;  If the assumption is made that the switch isperfect (when open it has infinite impedance and when closed it has zeroimpedance) and if it assumed that the capacitor is perfect (no dielectricabsorption), then this is a perfect track-and-hold circuit.andP;  The voltage onthe capacitor will track the input signal perfectly in track mode, and whenthe switch is opened, the capacitor will hold its value until the switch isclosed.andP;  Also, as long as the buffer amplifier's input impedance is high andwell-behaved, its bandwidth can be much lower than the bandwidth of thesignal being sampled.andP;  When the switch is opened, the buffer amplifier'soutput might not have been keeping up with the input signal, but since thevoltage at the input of the amplifier is now static, the buffer willeventually settle out to the hold capacitor's voltage.andM;The problem with building Fig.andP;  5 is that it is impossible at the presenttime to build a perfect switch.andP;  When the switch is opened it is not trulyturned off; it has some residual leakage capacitance and resistance.andP;  In holdmode, there is some residual coupling to the input signal because of thisleakage capacitance.andP;  This error term is commonly called feedthrough.andO;Another error term is pedestal voltage.andP;  The process of turning real-worldswitches off induces a charge transfer that causes the hold capacitor toexperience a fixed voltage step (a pedestal) when entering hold mode.andM;Another problem with Fi.andP;  5 is that it is impossible in the real world tobuild a perfect capacitor.andP;  Real-world capacitors have nonideal behaviorsbecause of dielectric absorption and other factors.andP;  This dielectricabsorption will manifest itself as a pedestal that is different for differentinput-voltage slew rates.andP;  Even if the capacitor is refined until it is&quot;perfect enough,&quot; the switch and the buffer amplifier may contributed enoughcapacitance in parallel with C.sub.hold that the resultant capacitance hasdielectric absorption problems.andM;Fig.andP;  6 is an implementation of Fig.andP;  5 using real-world components.andP;  Theswitch is implemented with a p-channel MOS FET.andP;  When the drive voltage is-15V, the circuit is in track mode.andP;  If the FET has an on resistance of R,then the 3-dB bandwidth of the circuit is 1/2[pi]RC.sub.hold.).andP;  C.sub.dg(the drain-to-gate capacitance) is always in parallel with C.sub.hold., soeven if C.sub.hold and the buffer amplifier have low dielectric absorption,the dielectric absorption associated with C.sub.dg will cause this circuit toexhibit pedestal changes with different input signal slew rates.andM;When the drive voltage is changed to +15V, the FET turns off and puts thecircuit into hold mode.andP;  The drain-to-source capacitance (C.sub.ds.)andO;contributes feedthrough error equal to C.sub.ds./C.sub.hold.andP;  If the drivevoltage changes infinitely fast, the pedestal error is(30V)(C.sub.dg./C.sub.hold.).andP;  If the drive voltage changes at a slower rate,the pedestal error will be less, but a gain error term will now appear.andO;Assume that the drive voltage changes slowly relative to the bandwidth of thetrack-and-hold circuit (1/(2[pi]RC.sub.hold.)).andP;  Assume also  that the FET ison until the drive voltage is equal to V.sub.in and that it is off when thedrive voltage is greater than V.sub.in.andP;  The process of going into hold modebegins with the drive voltage changing from -15V to +15V.andP;  As the voltagechanges from -15V to V.sub.in., C.sub.hold experiences very little pedestalerror since the current C.sub.dg.(dv/dt) mostly flows into the FET, which ison.andP;  When the drive voltage reaches V.sub.in., the FET turns off and all ofthe C.sub.dg.(dv/dt) current flows into C.sub.hold.andP;  The pedestal in thiscase is (15V.andP;  - V.sub.in.)(C.sub.dg./C.sub.hold.).andP;  Notice that this is asmaller pedestal than in the previous case where the drive voltage changedinfinitely fast.andP;  Also notice that there is a V.sub.in term in the pedestalequation.andP;  This is a gain error.andM;Pedestal errors are easy to deal with in the real world.andP;  There are a numberof easy ways to remove offset errors.andP;  Gain errors are not necessarily badeither, since ideal gain errors can be corrected with a compensating gainstage.andP;  But because C.sub.dg is a semiconductor capacitance, it tends tochange value with the applied voltage.andP;  This leads to a form of error callednonlinearity.andP;  In general, gain errors that are caused by semiconductorcapacitances (like that calculated in the above paragraph) lead tononlinearity errors.andP;  A track-and-hold circuit appliction that is affected bynonlinearity errors is sampling a signal and calculating its Fouriertransform.andP;  Feedthrough a dielectric absoprtion errors also are hard to dealwith.andP;  Commonly, a different track-and-hold architecture is used to achievebetter linearity, feedthrough, and dielectric absorption performance.andM;Fig.andP;  7 is a diagram of the track-and-hold architecture used most oftent toachieve 16-bit or better resolution along with 2-MHz bandwidths.andP;  In trackmode the drive voltage is -15V, turning Q1 on.andP;  The output voltage is theinverse of the input voltage.andP;  The inverse of the input voltage is impressedacross C.sub.hold during track mode.andP;  When the drive voltage is changed to+15V, Q1 turns off and V.sub.out is held.andM;Fig.andP;  7 has several advantages over Fig.andP;  6.andP;  Since the switch (Q1) is at avirtual ground point, the pedestal voltage is constant with V.sub.in andequal to (30V)(C.sub.dg./C.sub.hold.).andP;  This is because the drain and sourceare always at zero so that when Q1 is turned off the same amount of charge isalways transferred to C.sub.hold.andP;  Also, since no point on Q1 moves withV.sub.in., the FET does not contribute any dielectric absorption error terms.andM;Fig.andP;  7 does have feedthrough error.andP;  It is equal to1/2(C.sub.ds./C.sub.hold.).andP;  Theoretically this error could be substantiallyeliminated if a second switch could be turned on after entering hold mode toground the junction of the two resistors.andP;  However, a real drawback of thiscircuit is that the op amp U1 has to have the same bandwidth and slew ratecapabilities as the signal being sampled.andP;  In the descriptions of Figs.andP;  5and 6 it was mentioned that the buffer amplifier need not have the samebandwidth as the signal being sampled.andP;  So in summary, Fig.andP;  7 eliminatessome of the errors of the previous circuits but introduces at least one newlimitation.andM;HP 3458A Track-and-Hold ArchitectureandM;Fig.andP;  8 is a modification of Fig.andP;  6 that has most of the advantages and veryfew of the disadvantages of the previous circuits.andP;  Here the switch isimplemented with two n-channel JFETs and one p-channel MOS FET.andP;  In trackmode the JFETs Q1 and Q2 are on and the MOS FET Q3 is off.andP;  Q1 and Q2 are onbecause their gate-to-source voltages are zero, since their gates trackV.sub.in.andP;  Their gates track V.sub.in because in track mode point B is anopen circuit and CR1 and CR2 act like resistances of about 1 k[omega].andP;  CR1and CR2 are current regulator diodes, which are simply JFETs with their gateswired to their sources.andP;  In hold mode, Q1 and Q2 are off and Q3 is on.andP;  Q1 isnow off because point B is not at -15V and thus the gate of Q1 is at -15V.andO;CR2 now appears as a current source of high resistance and the gate of Q2 isclamped at about 7V below V.sub.out., turning off Q2.andP;  Q3 is on because itsgate (point A) is at -15V.andM;In hold mode, feedthrough error is very low, since the feedthrough caued byC.sub.ds1 is shunted into the ac ground created by Q3's being on.andP;  Also, thepedestal error caused by C.sub.dg2 is constant for all V.sub.in., since thegate of Q2 is clamped at 7V below V.sub.out.andP;  Since V.sub.out is trackingV.sub.in during track mode (or will settle out to V.sub.in after hold mode isentered), the pedestal error caused by C.sub.dg2 is(-7V)(C.sub.DG2./C.sub.hold.) and has no V.sub.in dependent terms.andP;  Thereforeit makes no difference to the linearity errors of the track-and-hold circuitwhether C.sub.dg2 is nonlinear with bias voltage.andM;It is not so obvious that C.sub.ds2 contributes almost nothing to thepedestal errors and the nonlinearity errors of the circuit.andP;  In addition tobeing a T-switch that reduces feed-through errors in hold mode, Q1, Q2, andQ3 when switched in the correct sequence act to remove almost all of thepedestal errors caused by C.sub.ds2.andP;  This is very important, since C.sub.ds2is nonlinear, and if its pedestal errors remained, the linearity of thecircuit would be no better than that of Fig.andP;  6.andP;  Q1 is selected such thatits pinchoff voltage  (V.sub.gsoff.) is greater than that of Q2.andP;  Thus, aspoint B is driven to -15V, Q2 turns off before Q1.andP;  Once Q2 is off, the onlycoupling path to C.sub.hold is through the capacitance C.sub.ds2.andM;Fig.andP;  9 shows the various waveforms present in the circuit.andP;  When Q1 isfinally turned off, the voltage on C1 has a pedestal error of (V.sub.in -15V)(C.sub.dg1./C.sub.1.).andP;  This pedestal couples into C.sub.hold throughC.sub.ds2.andP;  The magnitude is (V.sub.in -15V)(C.sub.dg1./C.sub.1.)(C.sub.ds2./C.sub.hold.).andP;  Since C.sub.dg1 isnonlinear and the coupling has a v.sub.in dependent term, the pedestal onC.sub.hold now has a nonlinear component.andP;  But after Q1 and Q2 are off, pointA is driven to -15V, turning Q3 on.andP;  C.sub.1 is now connected to V.sub.outthrough the on resistance of Q3 and approaches the voltage V.sub.out.andP;  Thisvoltage movement, which is of the same magnitude as C.sub.1.'s previouschange but in the opposite direction, couples into C.sub.hold throughC.sub.ds2  and totally removes the pedestal error previously coupled intoC.sub.hold through C.sub.ds2.andM;Another point that also might not be so obvious is that Q1, Q2, and Q3 do notcontribute any dielectric absoprtion errors to the track-and-hold circuit.andO;Since in track mode the drains, sources, and gates of Q1 and Q2 are at thesame potential (V.sub.in.), none of the FET capacitances has charge on itbefore it is put in hold mode.andP;  Therefore, the charge transferred toC.sub.hold through the FET capacitances when hold mode is entered is the samefor any value or slew rate of V.sub.in., so it doesn't matter whether the FETcapacitances have high dielectric absorption.andM;SummaryandM;The performance of the HP 3458A with sinusoidal and nonsinusoidal inputs isknown to be very good.andP;  The DMM was tested against a synthesized arbitrarywaveform generator under development at the U.S.andP;  National Bureau ofStandards which was capable of generating sine waves and ANSI-standarddistorted sine waves with an absolute uncertainty to 10 ppm.andP;  The HP 3458Ameasured all of the various test waveforms with errors ranging from 5 ppm to50 ppm for 7V rms inputs from 100 Hz to 10 kHz.andM;The digital ac measurement capability of the HP 3458A combines the bestfeatures of the traditional thermal and analog computational ac rmstechniques in addition to adding several advantages of its own.andP;  Measurementaccuracies for digital ac are comparable to thermal techniques for bothsinusoidal (crest factor 1.4) and large-crest-factor nonsinusoidal waveforms.andO;Like analog computation, digital ac reading rates are reasonably fastcompared to thermal rms techniques.andP;  The major advantages of digital acinclude linearity superior to traditional analog rms detection methods andsignificantly faster low-frequency rms ac measurements (less than six secondsfor a 1-Hz input).andP;  Short-term reading stability is excellent, allowingpreviously difficult characterizations to be performed easily.andM;AcknowledgmentsandM;Credit should be given to Larry DesJardin for his direction and support forthe development of the digital ac techniques implemented in the HP 3458A.andP;  Iwould also like to thank Barry Bell and Nile Oldham of the National Bureau ofStandards for allowing access to their synthesized ac source to help validatethe digital ac concept.andO;</TEXT></DOC>
<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO> ZF32-254-071 </DOCNO><DOCID>10 606 403</DOCID><JOURNAL>NetWare Advisor  Jan 1991 v4 n1 p9(3)* Full Text COPYRIGHT Business Systems Group Inc. 1991.andM;</JOURNAL><TITLE>Managing single-user applications with NetMenu. (includes relatedarticle on mapping drives with the DOS 'CD' command)</TITLE><AUTHOR>Toney, John.andM;</AUTHOR><DESCRIPT>Product:   NetMenu (Network management software) (Business use).andO;Topic:     TutorialNetwork ManagementNetwork Operating SystemsLocal Area NetworksSingle-User SystemsMS-DOSNetwork Management Software.andM;</DESCRIPT><TEXT>Most LAN installations still run a large number of application packages thatwere written for single-user environments.andP;  The specific user, display type,and printer (among other options) for these applications must be definedthrough an installation procedure or through the appropriate command lineparameters.andP;  If any of the specifics change, the application must bereinstalled, or the command line parameters that execute the program must bechanged.andP;  The challenge facing LAN administrators is to find a way for theapplications to make these adjustments automatically.andP;  The applicationsshould be able to execute themselves in a manner specific to the equipmentupon which they are being run, and according to the preferences (or allowedprivileges) of each actual user who runs them.andM;The NetMenu AlternativeandM;To compensate for Lan-unaware applications, LAN administrators have becomeaccustomed to setting DOS environment variables directly through the loginscript, based on information derived from NetWare.andP;  Other usefulinformation--such as the workstation's display type, processor, network cablesegment, file server name, and node address--has traditionally been set asDOS environment variables through batch files, such as each workstation'sAUTOEXEC.BAT file.andP;  This technique is acceptable only as long as theinformation defined through the environment variables remains correct.andP;  Overa period of time, though, any LAN'S equipment.andP;  user responsibilities, andboot disks tend to get swapped around, which makes maintaining theseenvironment variables an increasingly complex task.andM;A simple administrative alternative to DOS environment variables andNetWare's login scripts is offered by a LAN management utility collectioncalled NetMenu from NETinc (Houston, TX; 713-974-1810).andM;The core program in the collection is NetMenu, a NetWare-aware userinterface.andP;  Like many of the hundreds of interfaces that can be used onDOS-based networks,  NetMenu  is configurable with text files similar tobatch files.andP;  Unlike other user interfaces, NetMenu can be customized withNetWare login identifier variables.andP;  These  variables  (such  as LOGIN_NAMEand P_STATION) can be used anywhere on the workstation display, as commandline parameters, or even as the basis for whether an individual menuselection is made available (or not available) to individual users,workstations, and so on.andM;In addition to NetWare's login identifier variables, NetMenu offers over 65other variables, such as SERVER (which substitutes the name of the defaultNetWare file server), DISPLAY (which returns CGA, EGA.andP;  VGA.andP;  etc.), andBETWEEN (used to specify a period of time.andP;  such as  between 9:00 am and 5:00pm&quot;).andM;The actual value for each of these variables is substituted at theworkstation each time NetMenu is run, based on direct queries to NetWare andDOS.andP;  The values of certain variables are updated every 30 seconds, and thevalues of variables used in batch files are updated at the moment each batchfile is executed.andP;  As a result, even if equipment is swapped or users log inat different workstations, all selection will still work.andM;The NetMenu Configuration FileandM;The NetMenu configuration file contains a list of your network's resources,and describes how those resources are accessed (exactly as they would be in aDOS batch file).andP;  You can construct a single NetMenu text configuration filethat addresses a wide range of management issues.andP;  The resulting file doublesas an on-line document that describes exactly how each LAN resource isaccessed.andP;  Changing the way a resource is used automatically updates thisdocument, which makes it much easier to coordinate the efforts of supportpersonnel.andM;Let's examine a NetMenu configuration file to see how it can be.andP;  used toinvoke the proper configuration of Lotus 1-2-3.andP;  For our example, the LAN'Ssystem login script includes the following drive mappings: map s1:=sys:publicmap s2:=sys:public\%MACHINE\andM;%OS\%OS_VERSION map s3:=sys:public\extras map s4:=sys: mapf:=sys:users\%LOGIN_NAME map m:=sys: map n:=sys:andM;The  first  search  drive, SYS:PUBLIC, contains only the files that areincluded on the NetWare distribution disks.andP;  These files are flaggedShareable, Read-only to insure that they are not unintentionally modified.andO;such as by a computer virus.andM;The second search drive contains Read-only files of the operating systemversion currently running at the workstation.andP;  copied directly from themanufacturer's distribution disks.andP;  From a maintenance standpoint.andP;  it is nota good idea to bog down these directories with third-party files.andM;The third search drive is mapped to a general utility directory.andP;  For ourexample.andP;  this directory contains the user interface.andP;  third-party utilities,and all files that need to be frequently accessed by most users.andM;Search drive four is a &quot;scratch&quot; search drive.andP;  By mapping a scratch searchdrive at login time, we can change search drives with the DOS CD commandrather than the NetWare MAP command.andP;  This technique has two distinctadvantages: it is much faster than the NetWare procedure, and it does notrequire user intervention to change the drive mapping.andP;  This mappingtechnique can be used effectively across multiple file servers.andP;  See theaccompanying sidebar for more specifics on mapping with the DOS CD command.andM;Drive F: in our example is the user's home directory.andP;  We remap F: in thelogin script because the user no longer needs access to SYS:LOGIN afterattaching to the network.andM;Drives M: and N: are scratch drives that can be remapped on-the-fly with theDOS CD command, as they are needed by applications.andM;For the configuration file in Figure A, we use Lotus 1-2-3 v2.01, whichexhibits many of the common problems associated with running a Lan-unawareapplication in a multiuser environment.andP;  That is, the proper configurationand set files must be invoked for the application to run properly for thatparticular user on that particular workstation.andP;  Though a single copy ofLotus is actually installed on the LAN, each workstation that will access theselection has a licensed copy and documentation.andM;The first line in the example tells NetMenu what to display as the selectiontitle.andP;  The second line is displayed at the bottom of the screen as anextended information (or &quot;help&quot;) line.andM;Line 3 of the example tells NetMenu to check with the file server for thestatus of a NetWare semaphore named &quot;LOTUS.&quot; Semaphores are labels (and theirassociated values) that can be indirectly used to control network activity oraccess to a network resource.andP;  In this example, we tell NetWare that we wantto limit the simultaneous users of the label LOTUS to a maximum of six, whichis the total number of licensed copies that we have.andP;  By using NetWare'ssemaphore system, NetMenu eliminates the need to maintain a separate(proprietary) database.andM;When the first user accesses the selection, NetMenu tells NetWare to create aNetWare semaphore with a label of &quot;LOTUS&quot; and an initial value of  6.&quot;andO;NetMenu then asks NetWare to decrease the semaphore's value by one, since thesemaphore is now in use.andP;  Each succeeding user reduces the number by one.andP;  Ifthe value of the semaphore reaches zero, no additional users are allowed toaccess 1-2-3.andP;  When a user is denied access, NetMenu displays a message thatstates that all copies of the LOTUS option are currently in use, and suggeststhat the user try again later.andP;  The date.andP;  time, node address, station, username, semaphore name and value, and the fact that an attempt was made toexceed the value of the semaphore arc recorded to a NetWare system log.andP;  Theinformation contained in the file can be used to alert system administratorsthat it is time to order more copies of heavily-used software.andM;Each time a user is finished with the resource, the value of the semaphore isrestored by one--in this case, the equivalent of returning a copy of 1-2-3 tothe &quot;pool&quot; for use by others.andM;The next two lines of the example define prompts for input.andP;  which work justlike those in the NetWare menu utility.andP;  Defining the prompts for input inremark statements, prior to their use, makes the logic of the selectioneasier to follow.andP;  Since NetMenu does not write remarks to the batch fileswhich execute selections, comments do not retard performance as they wouldwith the NetWare menu.andP;  For installations where cooperation among multiplesupport personnel is essential, comments and documentation should beencouraged.andM;Line 4 prompts the user for the worksheet directory in which they wish towork.andP;  By offering 'a path of least resistance, you can encourage users toaccept defaults that make it easier to manage subdirectories and files.andO;Rather than prompting a user for input, NetMenu could have been configured topresent a list of available options.andP;  Each of the options in the list couldhave been made available based on membership in NetWare groups, theworkstation's node address or cable segment, the time of day, and so on.andM;Line 5 maps drive M: with the DOS CD command, after first testing to see ifthe user accepted the default directory by pressing andless;Eenterandgt; with no input.andO;Line 6 tests for an entry, also.andP;  These lines could have been combined in oneline with an &quot;if andless;conditionandgt; andless;actionandgt;.andP;  .  .  if not andless;conditionandgt; andless;actionandgt;&quot;statement.andP;  Line 7 maps drive N: to a shared projects directory.andM;The DOS CD command is used in line 8 to map search drive 4 (W:) to thedirectory which contains 1-2-3, and again in line 9 to map the user's homedirectory to the one which contains their personal 1-2-3 user preferenceconfiguration file (123.CNF).andP;  A copy of a generic configuration is copied tothe work directory in line 10 if no configuration file exists.andP;  It is notnecessary to change directories for the F: drive.andP;  since it was the currentworking drive when the CD command was issued.andM;Lines 11 and 12 ask NetWare if the current user is a member of the NetWaregroup &quot;MIS.&quot; If the answer is &quot;Yes,&quot; line 11 is executed.andP;  If the answer is&quot;No,&quot; line 12 is executed.andP;  Line 12 invokes another NETinc program.andP;  Ncommandis a special DOS command processor that works in much the same manner as theDOS &quot;command/C&quot; option.andP;  Unlike DOS, however, Ncommand hides COMSPEC from theapplication being executed.andP;  As a result, members of group &quot;MIS&quot; on thedefault file server who use line 11 to execute 1-2-3 will be allowed to&quot;shell out&quot; to DOS from within 1-2-3 by using the &quot;/S&quot; option.andP;  All others(line 12) are denied access to DOS from within the application.andM;Both line 11 and line 12 use the NetMenu variable DISPLAY to load theappropriate 123.SET file (CGA, EGA, VGA.andP;  etc.andP;  .andM;Lines 13 through 17 guarantee that the workstation's drive mappings arerestored to their original state after exiting the application.andP;  Thisrestoration is important, since &quot;network naive&quot; programs like 1-2-3 canaccidentally remap drives during their execution.andP;  The last line of theselection invokes NetMenu and reloads the original menu definition file.andP;  Thevariable THIS_MDF guarantees that the original path and file name are usedfor return to the menu, even if the menu's configuration file is renamed.andO;Another advantage of using THIS_MDF is that individual menu selections can beeasily cut and pasted into other menus.andM;Our example could have included other LAN-aware features.andP;  For example, youcould track how long each user spent in the application, or the directorythey specified in which to work.andP;  The menu selection itself could have beenmade available (or not available) to members of a specific group, toworkstations attached to a particular cable segment, or restricted by any ofmore than 100 other criteria.andM;Or instead of asking the user to specify a file name or directory in which towork, you could supply a list of valid options from which the user would beallowed to select.andP;  Any of the individual options in the list could be madeavailable only if the user, equipment, time of day, and so on metpre-specified criteria.andP;  For example.andP;  the list could include all validNetWare print queues on the default file server--yet only those print queuesfor which the current user is a member or queue operator would show up ateach workstation.andM;ConclusionandM;Lotus 1-2-3 is typical of many applications in use on LANs: it is notdesigned for use on a network, but it can be made manageable with the help ofthird-party products such as NetMenu.andP;  One of the significant features ofNetMenu that allows it to efficiently manage these single-user applicationsis its use of NetWare login identifier variables and NetMenu NetWare-likevariables instead of inflexible DOS environment variables.andM;The Netmenu collection is $295 per file server, and is available throughcomputer resellers and LAN installers.andM;John Toney is President of Micro Enhancement, Inc., a Houston-basedconsulting firm that specializes in LAN management, and Vice President forTechnical Development of NETin.andM;Mapping Drives With the DOS &quot;CD&quot; CommandandM;A NetWare file server's utilization goes up significantly when users log in,and when drives are mapped by workstations.andP;  Since both NetWware and theworkstation operating system must frequently validate these drive mappings,mapping too many drives puts an unnecessary burden on the file server.andP;  Oneway to manage file server utilization and reduce LAN traffic is to use theDOS CD command instead of the NetWare MAP command, keeping the number ofmapped drives to a minimum.andP;  This procedure is faster and puts less strain onthe file server.andM;The NetWare MAP command is designed to trick the workstation's operatingsystem into thinking that files on a file server volume reside on alocally-attached hard disk.andP;  for compatibility with existing applications,when a DOS call is made to a local disk, the NetWare workstation shell passesit straight through.andP;  However.andP;  when a DOS call is made to a drive lettermapped to the file server, the shell redirects it to the appropriate NetWarevolume.andP;  You can use this feature in reverse.andM;There are three ways you can use CD with drives that are mapped to NetWarevolumes.andP;  In the following examples, drive M: is initially mapped to the SYSvolume of file server FS1.andM;1) Mapping to another area of the sameandM;volume:andM;CD M:sys:apps\lotusandM;(drive M: is now mapped toandM;FS1\sys:apps\lotus)andM;2) Mapping to another volume on the sameandM;file serverandM;CD M:SYS1:users\jtandM;(drive M: is now mapped toandM;FS1\SYS1:users\jtandM;3) Mapping to a volume on another server:andM;M:andM;CD FS2\SYS3:apps\otherandM;(drive M: is now mapped toandM;FS2\SYS3:apps\other)andM;Example 3 will only work if the user is already attached to the target fileserver.andP;  It is, however, not necessary to map a separate drive to the targetfile server.andM;If a drive specified in the CD command was originally mapped as a NetWaresearch drive, the search path is instantly changed to reflect the new drivemapping.andP;  Figuration Omitted</TEXT></DOC>
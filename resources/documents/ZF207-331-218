<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF207-331-218  </DOCNO><DOCID>07 331 218.andM;</DOCID><JOURNAL>Communications of the ACM  June 1989 v32 n6 p689(8)* Full Text COPYRIGHT Assn. for Computing Machinery, Inc. 1989.andM;</JOURNAL><TITLE>With microscope and tweezers: the worm from MIT's perspective.andO;(the Internet worm)</TITLE><AUTHOR>Rochlis, Jon A.; Eichin, Mark W.andM;</AUTHOR><SUMMARY>The Internet virus first attacked the Massachusetts Institute ofTechnology (MIT) on Oct 19, 1988.andP;  A number of important pointswere discovered in the aftermath of the infection which will helpcontain, control and prevent events like this in the future.andO;Several sites disconnected from Internet in an attempt to isolatethe worm.andP;  However, those disconnections hurt the sites and usersby cutting them off from outside help.andP;  A chronology of eventsdetailing MIT's efforts to contain and understand the virus ispresented.andP;  An extensive list of suggestions for network securityis also included.andM;</SUMMARY><DESCRIPT>Topic:     Internet (Computer network)Computer virusesMassachusetts Institute of TechnologyDisaster RecoverySecurityGuidelines.andO;Feature:   illustrationcartoon.andM;</DESCRIPT><NOTE>Only Text is presented here; see printed issues for graphics.andO;</NOTE><TEXT>With Microscope and Tweezers: The Worm from MIT's Perspective The followingchronology depicts the Internet virus as seen from MIT.andP;  It is intended as adescription of how one major Internet site discovered and reacted to thevirus.andP;  This includes the actions of our group at MIT which wound updecompiling the virus and discovering its inner details, and the peopleacross the country who were mounting similar efforts.andM;It is our belief that the people involved acted swiftly and effectivelyduring the crisis and deserve many thanks.andP;  Also, there is much to be learnedfrom the way the events unfolded.andP;  Some clear lessons fro the future emerged,and as usual, many unresolved and difficult issues have also risen to theforefront to be considered by the networking and computer community.andM;WEDNESDAY: GENESISandM;Gee Myers of the National Computer Security Center (NCSC) analyzed theCornell mailer logs.andP;  He found that testing of the sendmail attack firstoccurred on October 19, 1988 and continued through October 28, 1988.andP;  OnOctober 29, 1988, there was an increased level of testing; Myers believes thevirus author was attempting to send the binaries over the SMTP (Simple MailTransfer Protocol) connections, an attempt which was bound to fail since theSMTP is only defined for 7-bit ASCII data transfers.andM;The author appeared to go back to the drawing board, returning with the&quot;grappling hook&quot; program on Wednesday, November 2, 1988.andP;  The virus wastested or launched at 5:01:59 p.m.andP;  The Logs show it infecting a secondCornell machine at 5:04 p.m.andP;  This may have been the genesis of the virus,but that is disputed by reports in the New York Times in which Paul Graham ofHarvard states the virus started on a machine at the MIT ArtificialIntelligence Lab via remote login from Cornell.andP;  Cliff Stoll of Harvard alsobelieves the virus was started from the MIT AI Lab.andP;  At the time this articlewas written, nobody had analyzed the infected Cornell machines to determinewhere the virus would have gone next if they were indeed the first infectedmachines.andM;In any case, Paul Flaherty of Stanford reported to the tcpgroup@ucsd.edumailing list on Friday that Stanford was infected at 9 p.m.andP;  and that it gotto &quot;most of the campus UNIX machines (cf.andP;  2,500 boxes).&quot;andP;  He also reportedthe virus originated from prep.ai.mit.edu.andP;  This is the earliest report ofthe virus we have seen.andM;At 9:30 p.m.andP;  Wednesday, wombat.mit.edu, a private workstation at MIT ProjectAthena maintained by Mike Shanzer, was infected it.andP;  It was running a versionof sendmail with the debug command turned on.andP;  Shanzer believes the attackcame from prep.ai.mit.edu since he had an account on prep and wombat waslisted in his .rhosts, a file which specifies a list of hosts and users onthose hosts who may log into an account over the network without supplying apassword.andP;  Unfortunately, the appropriate logs were lost, making the sourceof the infection uncertain.andP;  (The Logs on prep were forwarded via syslog, the4.3 BSD UNIX logging package, to another host which was down and by the timeanybody looked at the wtmp log, which records logins, it was truncated,perhaps deliberately, to some point on Thursday.andP;  The lack of logginginformation and the routine discarding of what old logs did exist hamperedinvestigations.)andM;Mike Muuss of Ballistics Research Laboratory reported at the NCSC meetingthat RAND was also hit at 9 p.m.andP;  or soon thereafter.andP;  Steve Miller of theUniversity of Maryland (UMD) reports the campus was first hit at 10:54 p.m.;andO;Phil Lapsley of the University of California, Berkeley, stated that UCB washit at 11 p.m.andM;THURSDAY MORNING: &quot;THIS ISN'T APRIL FIRST&quot;andM;David Edwards, of SRI International, said at the NSCS meeting that SRI washit at midnight.andP;  Chuck Cole and Russell Brand of Lawrence Livermore NationalLaboratory (LLNL) reported they were assembling their response team by 2a.m., and John Bruner independently reported spotting the virus on the SImachines at LLNL about that time.andM;Pascal Chesnais of the MIT Media Lab was one of the first people at MIT tospot the virus, after 10 p.m.andP;  Wednesday, but assumed it was just &quot;a localrunaway program.&quot;andP;  A group at the Media Lab killed the anomalous shell andcompiler processes, and all seemed normal.andP;  After going for dinner and icecream, they figured out that it was a virus and it was coming in via mail.andO;Their response was to shut down network services such as mail and to isolatethemselves from the campus network.andP;  The MIT Telecommunications NetworkGroup's monitoring information shows the Media Lab gateway first went down at11:40 p.m.andP;  Wednesday, but was back up by 3 a.m.andP;  At 3:10 a.m.andP;  Pascal gavethe first notice of the virus at MIT by creating a message of the day onmedia-lab.mit.edu (see Figure 1).andM;False Alarms or Testing?andM;Chesnais later reported that logs on media-lab show several scatteredmessages, &quot;ttloop: peer died: No such file or directory,&quot; which frequentlyoccurred just before the virus attacked.andP;  There were a few every couple ofdays, several during Wednesday afternoon and many starting at 9:48 p.m..andP;  Thelogs on media-lab start on October 25, 1988 and entries were made by telnetdon the following dates before the swarm on Wednesday night: Oct. 26,15:01:57; Oct. 28, 11:26:55; Oct. 28, 17:36:51; Oct. 31, 16:24:41; Nov. 1,16:08:24; Nov. 1, 18:02:43; Nov. 1, 18:58:30; Nov. 2, 12:23:51; Nov. 2,15:21:47.andM;It is not clear whether these represent early testing of the virus, or ifthey were just truly accidental premature closings of the telenetconnections.andP;  We assume the latter.andP;  With hindsight we can say a telnetd thatlogged its peer address, even for such erro messages, would have been quiteuseful in tracing the origin and progress of the virus.andM;E-mail WarningsandM;The first posting mentioning the virus was by Peter Yee of NASA Ames at 2:28a.m.andP;  on Wednesday to the tcp-ip@sri-nic.arpa mailing list.andP;  Yee stated thatUCB, UC San Diego, LLNL, Stanford, and NASA Ames had been attacked, anddescribed the use of sendmail to pull over the virus binaries, including theX* files which the virus briefly stored in /usr/tmp.andP;  The virus was observedsending VAS and Sun binaries, having DES tables built in, and making some useof .rhosts and hosts.equiv files.andP;  A phone number at UCB was given andLapsley and Kurt Pires were listed as being knowledgeable about the virus.andM;At 3:34 a.m.andP;  Andy Sudduth from Harvard made his anonymous posting totcp-ip@sri-nic.arpa.andP;  The posting said that a virus might be loose on theInternet and that there were three steps to take to prevent furthertransmission.andP;  These included not running fingerd or fixing it not tooverwrite the stack when reading its arguments from the net, being suresendmail was compiled without the debug command, and  not running rexecd.andM;Mike Patton, network manager for the MIT Laboratory for Computer Science(LCS), was the first to point out to us the peculiarities of this posting.andO;It was made from an Annex terminal server at Aiken Laboratory at Harvard, bytelneting to the SMTP port of iris.brown.edu.andP;  This is obvious since themessage was from &quot;foo%bar.arpa&quot; and because the last line of the message was&quot;qui\177\177\177,&quot; an attempt to get rubout processing out of the Brown SMTPserver, a common mistake when faking Internet mail.andM;It was ironic that this posting did almost no good.andP;  Figure 2 shows the pathit took to get to Athena.andP;  There was a 43-hour delay before the messageescaped from relay.cs.net and got to sri-nic.arpa.andP;  Another six hours went bybefore the message was received by athena.mit.edu.andP;  Other sites have reportedsimilar delays.andM;Yet More People Notice the VirusandM;About 4 a.m.andP;  Thursday Richard Basch of MIT Project Athena noticed a &quot;texttable full&quot; syslog message from paris.mit.edu, an Athena development machine.andO;Since there was only one message and he was busy doing a project for adigital design lab course, he ignored it.andM;At 4:51 a.m.andP;  Chris Hanson of the MIT AI Laboratory reported spottinganomalous telent traffic to several gateways coming from machines at LCS.andP;  Henoted that the attempts were occurring every one or two seconds and had beenhappening for several hours.andM;At 5:58 a.m.andP;  Thursday morning Keith Bostic of Berkeley made the first bugfix posting.andP;  The message went to the tcp-ip@sri-nic.arpa mailing list andthe newsgroups comp.bugs.4bsd.ucb-fixes, news.announce, and news.sysadmin.andO;It supplied the &quot;compile without the debug command&quot; fix to sendmail (or patchthe debug command to a garbage string), as well as the very wise suggestionto rename the UNIX C compiler and loader (cc and 1 d), which was effectivesince the virus needed to compile and link itself, and which would beeffective at protecting against non-sendmail attacks, whatever those mighthave turned out to be.andP;  It also told the people that the virus renamed itselfto &quot;(sh&quot; and used temporary files in /usr/tmp named XNNN, vax.o, XNNN,sun3.o, and XNNN,I1.c (where NNN were random numbers, possibly process id's),and suggested that one could identify infected machine by looking for thesefiles.andP;  That was somewhat difficult to do in practice, however, since thevirus quickly got rid of all of these files.andP;  A somewhat better solution wasproposed later in the day by, among others, John Kohl of Digital EquipmentCorp. and Project Atehan, who suggested doing a cat - v/usr/tmp, thusrevealing the raw contents of the directory, including the names of deletedfiles whose directory slots had not yet been re-used.andM;The fingerd attack was not even known, much less understood, at this point.andO;Lapsley reported at the NCSC meeting that Ed Wang of UCB discovered thefingerd mechanism around 8 a.m.andP;  and sent mail to Mike Karels, but this mailwent unread until after the crisis had passed.andM;At 8:06 a.m.andP;  Gene Spafford of Purdue forwarded Bostic's fixes to thenntp-managers@ucbvax.Berkeley.edu mailing list.andP;  Ted Ts'o of MIT ProjectAthena forwarded this to an internal Project Athena hackers list(watchmakers@athena.mit.edu) at 10:07 a.m.andP;  He expressed disbelief (&quot;no, it'snot April 1st&quot;), and thought Athena machines were safe.andP;  Though no productionAthena servers were infected, several private workstations and developmentmachines were, so this proved overly optimistic.andM;Mark Reinhold, a MIT LCS graduate student, reacted to the virus around 8 a.m.andO;by powering off some network equipment in LCS.andP;  Tim Shepard, also a LCSgraduate student, soon joined him.andP;  They were hampered by a growing number ofpeople who wanted information about what was happening.andP;  Reinhold and Shepardtried to call Yee several times and eventually managed to get through toLapsley who relayed what was then known about the virus.andM;At about this time, Basch returned to his workstation (a person can only doso much school work after all) and noticed many duplicates of the &quot;text tablefull&quot; messages from paris and went to investigate.andP;  He discovered severalsuspicious logins from old accounts which should have been purged long ago.andO;The load was intolerably high, and he only managed to get one line out of anetstat command before giving up, but that proved quite interesting.andP;  Itshowed an outgoing rsh connection from paris to fmgc.mit.edu, which is astandalone non-UNIX gateway.andM;Ray Hirschfeld of the MIT Math Department at the MIT AI Lab spotted the virusThursday morning on the Sun workstations in the math department and shut downthe math gateway to the MIT backbone at 10:10 a.m.andP;  It remained down until3:15 p.m.andM;Around 11 a.m.andP;  the MIT Statistics Center called Dan Geer, manager of systemdevelopment at Project Athena.andP;  One of their Sun workstations,dolphin.mit.edu had been infected via a Project Athena guest account with aweak password, along with the account of a former staff member.andP;  Thisinfection had spread to all hosts in the Statistics Center.andP;  They had beentrying for some time prior to call Geer to eradicate the virus, but thecontinual reinfection among their local hosts had proved insurmountablybaffling.andM;Bostic sent a second virus fix message to comp.4bsd.ucb-fixes at 11:12 a.m.andO;It suggested using Oxff instead of 0x00 in the binary patch to sendmail.andP;  Theprevious patch, while effective against the current virus, would drop intodebug mode if an empty command line was sent.andP;  He also suggested using theUNIX strings command to look in the sendmail binary for the string &quot;debug.&quot;andO;If it didn't appear at all then that version of sendmail was safe.andM;About 11:30 a.m.andP;  Chesnais requested the Network Group isolate the Media Labbuilding and it remained so isolated until Friday at 2:30 p.m.andM;Russ Mundy of the Defense Communications Agency reported at the NCSC meetingthat the MILNET to ARPANET mailbridges were shut down at 11:30 a.m.andP;  andremained down until Friday at 11 a.m.andM;In response to complaint from non-UNIX users, Reinhold and Stan Zanarotti,another LCS graduate student, turned on the repeaters at LCS which had beenpreviously powered down and physically disconnected UNIX machines from thenetwork around 11:15 a.m.andP;  Shepard reloaded a root partition of one machinefrom tape (to start with known software), and added a feature to find, a UNIXfile system scanner, to report low-level modification times.andP;  Working withJim Fulton of the X Consortium, Shepard inspected allspice.lcs.mit.edu.andP;  By 1p.m.andP;  they had verified that the virus had not modified any files on allspiceand had installed a recompiled sendmail.andM;THURSDAY AFTERNOON: &quot;THIS IS BAD NEWS&quot;andM;By the time Jon Rochlis of the MIT Telecommunications Network Group arrivedfor work around noon on Thursday, November 3, 1988, the Network Group hadreceived messages from MIT Lincoln Laboratory saying they had &quot;been broughtto their knees&quot; by the virus, from Sergio Heker of the John Von NeumannNational Supercomputer Center warning of network problems, and from KentEngland of Boston University saying BU had cut their external links.andP;  The MITNetwork Group loathed the thought of severing MIT's external connections andnever did throughout the crisis.andM;At 1:30 p.m.andP;  Geer and Jeff Schiller, manager of the MIT Network and ProjectAthena Operations Manager, returned to the MIT Statistics Center and wereable to get both VAX and Sun binaries from infected machines.andM;Spafford posted a message at 2:50 p.m.andP;  Thursday to a large number of peopleand mailing lists including nntp-managers@ucbvax.berkeley,edu, which is howwe saw it quickly at MIT.andP;  It warned that the virus used rsh and looked inhosts.equiv and.rhosts for more hosts to attack.andM;Around this time the MIT group in E40 (Project Athena and theTelecommunications Network Group) called Milo Medin of NASA and found outmuch of this information.andP;  Many of us had not yet seen the messages.andP;  Hepointed out that the virus just loved to attack gateways, which were foundvia the routing tables, and remarked that it must have not been effective atMIT where we run our own C Gateway code on our routers, not UNIX.andP;  Medin alsosaid that it seemed to randomly attack network services, swamping them withinput.andP;  Some daemons that run on non-standard ports had logged such abnormalinputs.andP;  At the time we thought the virus might be systematically attackingall possible network services exploiting some unknown common flaw.andP;  This wasnot true but it seemed scary at the time.andP;  Medin also informed us that DCAhad shut down the mailbridges which serve as gateways between the MILNET andthe ARPANET.andP;  He pointed us to the group at Berkeley and Yae specifically.andM;It Uses FingerandM;At about 6 p.m.andP;  on Thursday, Ron Hoffman, of the MIT TelecommunicationsNetwork Group, observed the virus attempting to log into a standalone routerusing the Berkeley remote login protocol; the remote login attempt originatedfrom a machine previously believed immune since it was running a mailer withthe debug command turned off.andP;  The virus was running under the user name ofnobody, and it appeared that it had to be attacking through the fingerservice, the only network service running under that user name.andP;  At thatpoint, we called the group working at Berkeley; they confirmed our suspicionsthat the virus was spreading through fingerd.andM;On the surface, it seemed that fingerd was too simple to have a protectionbug similar to the one in sendmail; it was a very short program, and the onlyprogram it invoked (using the UNIX exec system call) was named using aconstant pathname.andP;  A check of the modification dates of both /etc/fingerdand /usr/ ucb/finger showed that both had been untouched, and both wereidentical to known good copies located on a read-only filesystem.andM;Berkeley reported that the attack on finger involved &quot;showing some garbage atit,&quot; probably control A's; clearly an overrun buffer wound up corruptingsomething.andM;Bill Sommerfeld of Apollo Computer and MIT Project Athena guessed that thisbug might involve overwriting the saved program counter in the stack frame;when he looked at the source for fingerd, he found that the buffr it wasusing was located on the stack.andP;  In addition, the program used the C librarygets function which assumes that the buffer it is given is long enough forthe line it is about to read.andP;  To verify that this was a viable attack, hethen went on to write a program which exploited this hole in a benign way.andO;The test virus sent the string &quot;Bozo!&quot; back out the network connection.andM;Mike Rowan and Mike Spitzer also report having discovered the fingerdmechanism at about the same time and forwarded their discovery to Spaffordand Bostic, but in the heat of the moment the discovery went unrecognized.andO;Liudvikas Bukys of the University of Rochester posted to the comp.bugs.4bsdnewsgroup a detailed description of the fingerd mechanism at 7:21 p.m.andP;  Themessage also stated that the virus used telnet but perhaps that was onlyafter cracking passwords.andP;  In reality it only sometimes used telnet to&quot;qualify&quot; a machine for later attack, and only used rsh and rexec to takeadvantage of passwords it had guessed.andM;A risks@kl.sri.com digest came out at 6:52 p.m.andP;  It included a message fromStoll describing the spread of the virus on MILNET and suggested that MILNETsites might want to remove themselves from the network.andP;  Stoll concluded bysaying, &quot;This is bad news.&quot;andP;  Other messages were from Spafford, Peter Neumannof SRI, and Matt Bishop of Dartmouth.andP;  They described the sendmailpropagation mechanism.andM;THURSDAY EVENING: &quot;WITH MICROSCOPE ANDandM;TWEEZERS&quot;andM;In the office of the Student Information Processing Board (SIPB), Zanarottiand Ts'o had managed to get a VAX binary and core dump from the virus whileit was running on a machine at LCS.andM;The duo started attacking the virus.andP;  Pretty soon they had figured out thexor encoding of the text strings embedded in the program and were manuallydecoding them.andP;  By 9 p.m.andP;  Ts'o had written a program to decode all thestrings and we had the list of strings used by the program, except for thebuilt-in dictionary which was encoded in a different fashion (by turning onthe high order bit of each character).andM;At the same time they discovered the IP address of ernie.berkeley.edu,128.32.137.13, in the program; they proceeded to take apart the virus routinesend message to figure out what it was sending to ernie, how often, and if ahandshake was involved.andP;  Zanarotti told Rochlis in the MIT Network Group ofthe SIPB group's progress.andP;  The people in E40 called Berkeley and reportedthe finding of ernie's address.andP;  Nobody seemed to have any idea why that wasthere.andM;At 9:20 p.m., Spafford created the mailing list phage@purdue.edu.andP;  Itincluded all the people he had been mailing virus information to since themorning; more people were to be added during the next few days.andP;  This listproved invaluable, since it seemed to have many of the &quot;right&quot; people on itand seemed to work in near real time despite all the network outages.andM;At 10:18 p.m.andP;  Bostic made his third bug fix posting.andP;  It included new sourcecode for fingerd which used fgets instead of gets and did an exit instead ofreturn.andP;  He also included a more general sendmail patch which disabled thedebug command completely.andM;The Media DescendsandM;About this time a camera crew from WNEV-TV Channel 7 (the Boston CBSaffiliate) showed up at the office of James D. Bruce, MIT EECS Professor andVice President for Information Systems.andP;  He called Jeff Schiller and headedover to E40.andP;  They were both interviewed and stated that there were 60,000Internet hosts, along with an estimate of 10 percent infection rate for the2,000 hosts at MIT.andP;  The infection rate was a pure guess, but seemedreasonable at the time.andP;  These numbers were to stick in a way we neveranticipated.andP;  Some of the press reports were careful to explain thederivation of the numbers they quoted, including how one could extrapolatethat as many as 6,000 computers were infected.andP;  However, many reports werenot that good and simply stated things like &quot;at least 6,000 machines had beenhit.&quot;andP;  We were unable to show the TV crew anything &quot;visual&quot; caused by thevirus, something which eventually became a common media request anddisappointment.andP;  Instead, they settled for people looking at workstationstalking &quot;computer talk.&quot;andM;The virus was the lead story on the 11 p.m.andP;  news and was mentioned onNational Public Radio as well.andP;  We were quite surprised that the real worldwould pay so much attention.andP;  Sound bites were heard on the 2 a.m.andP;  CBS RadioNews, and footage shot that evening was shown on the CBS morning news (but bythat point we were too busy to watch).andM;After watching the story on the 11 p.m.andP;  news we realized it was time to getserious about figuring out the detailed workings of the virus.andP;  We all agreedthat decompiling was the route to take, though later we also mounted aneffort to infect a specially instrumented machine to see the virus inoperation.andP;  As Saltzer said in a later message to the Project Athena staff,we undertook a &quot;wizard-level analysis&quot; by going over the virus &quot;withmicroscope and tweezers.&quot;andM;FRIDAY: &quot;WHERE'S SIGOURNEY WEAVER?&quot;andM;Tim Shepard joined the group in E40, just before midnight on Thursday.andP;  Wethought we saw packets going to ernie and replies coming back, though thislater proved to be an illusion.andP;  Shepard had hundreds of megabytes of packetheaders gathered Thursday morning from a subnet at LCS which was known tohave had infected machines on it.andP;  Unfortunately, the data was sitting on amachine at LCS, which was still off the network, so Shepard decided to goback and look through this data.andP;  Within an hour or two, Shepard called backto say that he found no unusual traffic to ernie at all.andP;  This was our firstgood confirmation that the ernie packets were a red-herring or at least theydid not actually wind up being sent.andM;Serious decompiling began after midnight.andP;  Zanarotti and Ts'o soon left theSIPB office and joined the group working in E40, bringing with them thedecoding of the strings and much of the decompiled main module for the virus.andO;Mark Eichin, who had recently spent a lot of time disassembling-assemblingsome ROMs and thus had recent experience at reverse engineering binaries,took the lead in dividing the project up and assigning parts to people.andP;  Hehad also woke up in late afternoon and was most prepared for the night ahead.andM;At 1:55 a.m.andP;  Eichin discovered the first of the bugs in the virus.andP;  A bzerocall in if init was botched.andP;  At 2:04 a.m.andP;  Zanarotti had a version of themain module that compiled.andP;  We called Bostic at Berkeley at 2:20 a.m.andP;  andarranged to do FTP exchanges of source code on an MIT machine (both Berkeleyand MIT had never cut their outside network connections).andP;  Unfortunately,Bostic was unable to get the hackers at Berkeley to take a break and batch uptheir work, so no exchange happened at that time.andM;At 2:45 a.m.andP;  Eichin started working on checkother since the Berkeley folkswere puzzled by it.andP;  Rochlis was working on the later cracksome routines.andP;  By3:06 a.m.andP;  Ts'o had figured out that ha built a table of target hosts whichhad telnet listeners running.andP;  By 3:17 a.m.andP;  Ts'o and Hal Birkeland from theMedia Lab had determined that the crypt routine was the same as one found inthe C library.andP;  Nobody had yet offered a reason why it was included in thevirus, rather than being picked up at link time.andP;  Eichin had finishedcheckother and Ts'o had finished permute at 3:28 a.m.andP;  We worked on otherroutines throughout the morning.andM;Observations from Running the VirusandM;The first method of understanding the virus was the decompilation effort.andP;  Asecond method was to watch the virus as it ran, in an attempt to characterizewhat it was doing--this is akin to looking at the symptoms of a biologicalvirus, rather than analyzing the DNA of the virus.andP;  We wanted to do severalthings to prepare for observing the virus:andM;* Monitoring: We wanted to set up a machine with special logging, mostlyincluding packet monitors.andM;* Pointers: We wanted to &quot;prime&quot; the machine with pointers to other machinesso we could watch how the virus would attack its targets.andP;  By placing namesof the target machines in many different places on the &quot;host&quot; computer wecould also see how the virus created its list of targets.andM;* Isolation: We considered isolating the machines involved from the networktotally (for paranoia's sake) or by a link-layer bridge to cut down on theamount of extraneous traffic monitored.andP;  True isolation proved more than wewere willing to deal with at the time, since all of our UNIX workstationsassume access to many network services such as nameservers and file servers.andO;We did not want to take the time to build a functional standalone system,though that would have been feasible if we had judged the risk of infectingother machines too great.andM;Mike Muuss reported that the BRL group focused on monitoring the virus inaction.andP;  They prepared a special logging kernel, but even in coordinationwith Berkeley were unable to re-infect the machine in question untilSaturday.andM;By 1 a.m.andP;  Friday we had set up the monitoring equipment (an IBM PC running apacket monitor) and two workstations (one acting as the target, the otherrunning a packet monitoring program and saving the packet traces to disk),all separated from the network by a link-layer bridge and had dubbed thewhole setup the &quot;virus net.&quot; We, too, were unsuccessful in our attempt to getour target machine infected until we had enough of the virus decompiled tounderstand what arguments it wanted.andP;  By 3:40 a.m.andP;  John Kohl had the virusrunning on our &quot;virus net&quot; and we learned a lot by watching what it did.andP;  Thevirus was soon observed trying telnet, SMTP, and finger connections to allgateways listed in the routing table.andP;  Later it was seen trying rsh and rexecinto one of the gateways.andM;At 4:22 a.m., upon hearing of the virus going after yet another host in a&quot;new&quot; manner, Rochlis remarked &quot;This really feels like the movie Aliens.andP;  Sowhere's Sigourney Weaver?&quot; Seeing the virus reach out to infect othermachines seemed quite scary and beyond our control.andM;At 5:45 a.m.andP;  we called the folks at Berkeley and finally exchanged code.andP;  Anumber of people at Berkeley had punted to get some sleep, and we had a bitof difficulty convincing the person who answered Bostic's phone that we werenot the bad guy trying to fool them.andP;  We gave him a number at MIT that showedup in the NIC's whois database, but he never bothered to call back.andM;At this point a bunch of us went out and brought back some breakfast.andM;The Media Really ArrivesandM;We had been very fortunate that the press did not distract us, and that wewere thus able to put most of our time into our decompilation and analysisefforts.andP;  Bruce and the News Office did a first rate job of dealing with mostof the press onslaught.andP;  By early morning Friday there was so much mediainterest that MIT News Office scheduled a press conference for noon in theProject Athena Visitor Center in E40.andM;Just before the press conference, we briefed Bruce on our findings and whatwe thought was important: the virus did not destroy or even try to destroyany data; it did not appear to be an &quot;accident;&quot; many people (especially thepeople we had talked to at Berkeley) had helped to solve this.andM;We were amazed at the size of the press conference--there were approximately10 TV camera crews and 25 reporters.andP;  Schiller spent a good amount of timetalking to reporters before the conference proper began, and many got shotsof him pointing at the letters &quot;(sh)&quot; on the output of a ps command.andP;  Bruceand Schiller answered questions as the decompiling crew watched from avantage point in the back of the room.andP;  At one point a reporter asked Brucehow many people had enough knowledge to write such a virus and, inparticular, if Schiller could have written such a program.andP;  The answer was,of course, many people could have written it and yes, Schiller was one ofthem.andP;  The obvious question was then asked: &quot;Where were you on Wednesdaynight, Jeff?&quot;andP;  This was received with a great deal of laughter.andP;  But when areporter stated that sources at the Pentagon had said that the instigator ofthe virus had come forward and was a BU or MIT graduate student, we allgasped and hoped it had not really been one of our students.andM;After the conference the press filmed many of us working (or pretending towork) in front of computers, as well as short interviews.andM;The media was uniformly disappointed that the virus did nothing even remotelyvisual.andP;  Several reporters also seemed pained that we were not moments awayfrom World War III, or that there were not large numbers of companies andbanks hooked up to &quot;MIT's network&quot; who were going to be really upset whenMonday rolled around.andP;  But the vast majority of the press seemed to be askinghonest questions in an attempt to grapple with the unfamiliar concepts ofcomputers and networks.andP;  At the NCSC meeting Muuss said, &quot;My greatest fearwas that of seeing a National Enquirer headline: 'Computer Virus Escapes toHumans, 96 Killed.'&quot;  We were lucky that didn't happen.andM;Perhaps the funniest thing done by the press was the picture of the viruscode printed in Saturday's edition of the Boston Herald.andP;  Jon Kamens on MITProject Athena had made a window dump of the assembly code for the start ofthe virus (along with corresponding decompiled C code), even including thewindow dump command itself.andP;  The truly amusing thing was that the Herald hadgotten an artist to add tractor feed holes to the printout in an attempt tomake it look like something that a computer might have generated.andP;  We aresure they would have preferred a dot matrix printer to the laser printer weused.andM;Bostic called in the middle of the press zoo, so we cut the conversationshort.andP;  He called us back around 3 p.m.andP;  and asked for our affiliations forhis next posting.andP;  Keith also asked if we liked the idea of posting bug fixesto the virus itself, and we instantly agreed with glee.andP;  Bostic made hisfourth bug fix posting at 5:05 p.m., this time with fixes to the virus.andO;Again he recommended renaming 1d, the UNIX linker.andM;Things began to wind down after that, though the press was still calling andwe managed to put off the NBC Today show until Saturday afternoon.andP;  Most ofus got a good amount of sleep for the first time in several days.andM;SATURDAY: SOURCE CODE POLICYandM;Saturday afternoon, November 5, 1988, the Today show came to the SIPB Office,which they referred to as the &quot;computer support club&quot; (sic), to find a groupof hackers.andP;  They interviewed Eichin and Rochlis and used Eichin'sdescription of what hackers really try to do on Monday morning's show.andM;After the Today show crew left, many of us caught up on our mail.andP;  It wasthen that we first saw Andy Sudduth's Thursday morning posting totcp-ip@srinic.arpa and Mike Patton stopped by and pointed out how strange itwas.andM;We soon found ourselves in the middle of a heated discussion onphage@purdue.edu regarding distribution of the decompiled virus source code.andO;Since we had received several private requests for our work, we sat back andtalked about what to do, and quickly reached a consensus.andP;  We agreed withmost of the other groups around the country who had come to the decision notto release the source code they had reverse engineered.andP;  We felt stronglythat the details of the inner workings of the virus should not be kepthidden, but that actual source code was a different matter.andP;  We (and others)intended to write about the algorithms used by the virus so that people wouldlearn what the Internet community was up against.andP;  This meant that somebodycould use those algorithms to write a new virus; but the knowledge requiredto do so is much greater than what is necessary to recompile the source codewith a new, destructive line or two in it.andP;  The energy barrier for this issimply too low.andP;  The people on our team (not the MIT administration) decidedto keep our source private until things calmed down; then we would considerto whom to distribute the program.andP;  A public posting of the MIT code was notgoing to happen.andM;Saltzer, among others, has argued forcefully that the code itself should bepublicly released at some point in the future.andP;  After sites have had enoughtime to fix the holes with vendor supplied bug fixes, we might do so.andM;Tuesday: The NCSC MeetingandM;On Tuesday, November 8, 1988, Eichin and Rochlis attended the Baltimorepost-mortem meeting hosted by the NCSC.andP;  We heard about the meetingindirectly at 2 a.m.andP;  and flew to Baltimore at 7 a.m.andP;  Figuring there was notime to waste with silly things like sleep, we worked on drafts of thisdocument.andP;  The meeting will be described in more detail by the NCSC, but wewill present a very brief summary here.andM;Attending the meeting were members of the National Institute of Science andTechnology (NIST), formerly the National Bureau of Standards, the DefenseCommunications Agency (DCA), the Defense Advanced Research Projects Agency(DARPA), the Department of Energy (DOE), the Ballistics Research Laboratory(BRL), the Lawrence Livermore National Laboratory (LLNL), the CentralIntelligence Agency (CIA), the University of California at Berkeley (UCB),the Massachusetts Institute of Technology (MIT), SRI International, theFederal Bureau of Investigation (FBI), and of course, the National ComputerSecurity Center (NCSC).andP;  This is not a complete list.andP;  The lack of any vendorparticipation was notable.andM;Three-quarters of the day was spent discussing what had happened from thedifferent perspectives of those attending.andP;  This included chronologies,actions taken, and an analysis of the detailed workings of the virus.andO;Meanwhile our very rough draft was duplicated and handed out.andM;The remaining time was spent discussing what we learned from the attack andwhat should be done to prepare for future attacks.andP;  This was much harder andit is not clear that feasible solutions emerged, though there was muchagreement on several motherhood and apple-pie suggestions.andP;  By this we meanthe recommendations sound good and by themselves are not objectionable, butwe doubt they will be effective.andM;Wednesday-Friday: The Purdue IncidentandM;On Wednesday evening, November 9, 1988, Rich Kulawiec of Purdue posted tophage@purdue.edu that he was making available the unas disassembler that he(and others at Purdue) used to disassemble the virus.andP;  He also made availablethe output of running the virus through this program.andP;  Rumor spread and soonthe NCSC called several people at Purdue, including Spafford, in an attemptto get this copy of the virus removed.andP;  Eventually, the President of Purduewas called and the file was deleted.andP;  The New York Times ran a heavilyslanted story about the incident on Friday, November 11, 1988.andM;Several mistakes were made here.andP;  First, the NCSC was concerned about thewrong thing.andP;  The disassembled virus was not important and was trivial forany infected site to generate.andP;  It simply was not anywhere near as importantas the decompiled virus, which could have very easily been compiled and run.andO;When the MIT group was indirectly informed about this and discovered exactlywhat was publicly available, we wondered what was the big deal.andP;  Secondly,the NCSC acted in a strong-handed manner that upset the people at Purdue whogot pushed around.andM;Other similar incidents occurred around the same time.andP;  Jean Diaz of the MITSIPB forwarded a partially decompiled copy of the virus to phage@purdue.eduat some time on Friday, November 4, 1988, but it spent several days in mailqueue on hplabs.hp.com before surfacing.andP;  Thus it had been posted before anyof the discussion of the source code release had occurred.andP;  It was also veryincomplete and thus posed little danger since the effort required to turn itinto a working virus was akin to the effort required to write the virus fromscratch.andM;These two incidents, however, caused the press to think that a secondoutbreak of the virus had once again brought the network to its knees.andO;Robert French, of the MIT SIPB and Project Athena, took one such call onThursday, November 10, and informed the reporter that no such outbreak hadoccurred.andP;  Apparently, rumors of source code availability (the Purdueincident and Diaz's posting) led to the erroneous conclusion that enoughinformation of some sort had been let out and damage had been done.andP;  Rumorcontrol was once again shown to be important.andM;LESSONS AND OPEN ISSUESandM;The virus incident taught many important issues.andP;  It also brought up manymore difficult issues which need to be addressed in the future.andM;The Community's ReactionsandM;The chronology of events is interesting.andP;  The manner in which the Internetcommunity reacted to the virus attack points out areas of concern or at leastissues for future study.andM;* Connectivity was important.andP;  Sites which disconnected from the network atthe first sign of trouble hurt themselves and the community.andP;  Not only couldthey not report their experiences and findings, but they couldn't get timelybug fixes.andP;  Furthermore, other sites using them as mail relays were crippled,thus delaying delivery of important mail, such as Sudduth's Thursday morningposting, until after the crisis had passed.andP;  Sites like MIT and Berkeley wereable to collaborate in a meaningful manner because they never took themselvesoff the network.andM;* The &quot;old boy&quot; network worked.andP;  People called and sent electronic mail tothe people they knew and trusted and much good communication happened.andP;  Thiscannot be formalized but it did function quite well in the face of thecrisis.andM;* Late night authentication is an interesting problem.andP;  How did you know thatit really is MIT on the phone?andP;  How did you know that Bostic's patch tosendmail is really a fix and isn't introducing a new problem?andP;  Did Bosticreally send the fix or was it his evil twin, Skippy?andM;* Whom do you call?andP;  If you need to talk to the manager of Ohio StateUniversity network at 3 a.m., whom do you call?andP;  How many people can findthat information, and is the information up to date?andM;* Speaker phones and conference calling proved very useful.andM;* How groups formed and who led them is a fascinating topic for future study.andO;Don Alvarez of the MIT Center for Space Research presented his observationson this at the NCSC meeting.andM;* Misinformation and illusions ran rampant.andP;  Muuss categorized several ofthese at the NCSC meeting.andP;  Our spotting of a handshake with ernie is but oneexample.andM;* Tools were not as important as one would have expected.andP;  Most of thedecompiling work was done manually with no more tools than a disassembler(adb) and an architecture manual.andP;  Based on its experience with PC viruses,the NCSC feels that more sophisticated tools must be developed.andP;  While thismay be true for future attacks, it was not the case for this attack.andM;* Source availability was important.andP;  All of the sites which respondedquickly and made progress in truly understanding the virus had UNIX sourcecode.andM;* The academic sites performed best.andP;  Government and commercial sites laggedbehind places like Berkeley and MIT in figuring out what was going on andcreating solutions.andM;* Managing the press was critical.andP;  We were not distracted by the press andwere able to be quite productive.andP;  The MIT News Office did a fine job keepingthe press informed and out of the way.andP;  Batching the numerous requests intoone press conference helped tremendously.andP;  The Berkeley group, among others,reported that it was difficult to get work done with the press constantlyhounding them.andM;General Points for the FutureandM;More general issues have popped to the surface because of the virus.andP;  Theseinclude the following:andM;* Least privilege.andP;  This basic security principle is frequently ignored andthis can result in disaster.andM;* &quot;We have met the enemy and he is us.&quot;andP;  The alleged author of the virus hasmade contributions to the computer security field and was by any definitionan insider; the attack did not come from an outside source who obtainedsensitive information, and restricting information such as source code wouldnot have helped prevent this incident.andM;* Diversity is good.andP;  Though the virus picked on the most widespreadoperating system used on the Internet and on the two most popular machinetypes, most of the machines on the network were never in danger.andP;  A widervariety of implementations is probably good, not bad.andP;  There is a directanalogy with biological genetic diversity to be made.andM;* &quot;The cure shouldn't be worse than the disease.&quot;andP;  Chuck Cole made this pointand Stoll also argued that it may be more expensive to prevent such attacksthan it is to clean up after them.andP;  Backups are good.andP;  It may be cheaper torestore from backups than to try to figure out what damage an attacker hasdone.andM;* Defenses must be at the host level, not the network level.andP;  Muuss and Stollhave made this point quite eloquently.andP;  The network performed its functionperfectly and should not be faulted; the tragic flaws were in severalapplication programs.andP;  Attempts to fix the network are misguided.andP;  Schillerlikes to use an analogy with the highway system: anybody can drive up to yourhouse and probably break into your home, but that does not mean we shouldclose down the roads or put armed guards on the exit ramps.andM;* Logging information is important.andP;  The inetd and telnetd interactionlogging the source of virus attacks turned out to be a lucky break, but evenso many sites did not have enough logging information available to identifythe source or times of infection.andP;  This greatly hindered the responses, sincepeople frequently had to install new programs which logged more information.andO;On the other hand, logging information tends to accumulate quickly and israrely referenced.andP;  Thus it is frequently automatically purged.andP;  If we loghelpful information, but find it is quickly purged, we have not improved thesituation much at all.andP;  Muuss points out that frequently one can retrieveinformation from backups, but this is not always true.andM;* Denial of service attacks are easy.andP;  The Internet is amazingly vulnerableto such attacks.andP;  These attacks are quite difficult to prevent, but we couldbe much better prepared to identify their sources than we are today.andP;  Forexample, currently it is not hard to imagine writing a program or set ofprograms which crash two-thirds of the existing Sun Workstations or othermachines implementing Sun's Network Filesystem (NFS).andP;  This is serious sincesuch machines are the most common computers connected to the Internet.andP;  Also,the total lack of authentication and authorization for network level routingmakes it possible for an ordinary user to disrupt communications for a largeportion of the Internet.andP;  Both tasks could be easily done in a manner whichmakes tracking down the initiator extremely difficult, if not impossible.andM;* A central security fix repository may be a good idea.andP;  Vendors mustparticipate.andP;  End users, who likely only want to get their work done, must beeducated about the importance of installing security fixes.andM;* Knee-jerk reactions should be avoided.andP;  Openness and free flow ofinformation is the whole point of networking, and funding agencies should notbe encouraged to do anything damaging to this without very carefulconsideration.andP;  Network connectivity proved its worth as an aid tocollaboration by playing an invaluable role in the defense and analysisefforts during the crisis, despite the sites which isolated themselves.andO;</TEXT></DOC>
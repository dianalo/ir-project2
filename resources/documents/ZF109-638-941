<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF109-638-941  </DOCNO><DOCID>09 638 941.andM;</DOCID><JOURNAL>PC User  Nov 7 1990 n145 p145(4)* Full Text COPYRIGHT EMAP Business andamp; Computer Publications(England) 1990.andM;</JOURNAL><TITLE>PC Clinic. (includes related articles on Wordperfect and printeroutput problems)andM;</TITLE><DESCRIPT>Feature:   illustrationphotograph.andM;</DESCRIPT><TEXT>PC ClinicandM;Q I'm trying to find programming instructions for the IBM Bisynchronousadaptor.andM;I'd expect this information to be in an IBM Technical Reference manual forthe adaptor, but there doesn't appear to be such a book.andM;Several large distributors and IBM themselves have been unable to locateeither this manual or the information anywhere else.andP;  Does anyone know wherethis information is bidden?andM;I need to be able to program the adaptor for the 3780 (RJE) protocol.andP;  I'monly interested in the ISA bus version of the adaptor.andP;  Bruce Evans, NorthFinchley.andM;A All surgeons are very good at finding well-hidden objects -- marbles,swabs, loose false teeth and so on -- in inaccessible places.andP;  First stop wasthe National Computing Centre, which neither had nor knew where we could gethold of documentation for the Bi-synchronous adaptor.andM;So it was off to our contacts at IBM, normal IBM channels having drawn ablank for Mr Evans.andP;  Did they have what we wanted?andP;  No, but they knew a manwho might.andM;Another phone call and a very informative journey through the IBM database(apparently a very arcane piece of kit) later and we still hadn't establishedthe existence, let alone the whereabouts, of the offending documentation.andM;But we weren't going to let this defeat us, and neither was IBM.andP;  In fact,our contact at IBM came up with his own copy and offered to send it to us toavoid delays in ordering.andP;  He also said: &quot;The only problem with the old ISAbus would be with bisynchronous and asynchronous transmission workingconcurrently; there are no such problems with the MCA bus.&quot;andM;The patient finds a miracle cure: cue withdrawal from life support machine,and seenes showing happy smiles and jogging in the park.andP;  We love happyendings at the Clinic.andM;Q I have a number of questions concerning the Amstrad PC2386.andM;First, can a standard IBM-compatible keyboard be used as a replacement forthe Amstrad keyboard?andP;  The keyboard socket has a 5-pin DIN configuration(although it's a narrower gauge than an audio 5-pin DIN).andP;  If so, where couldI get one?andM;Second, what do the following files do as supplied with AMSTRAD's OEM versionof MS-DOS 4.01: NVRTEST, MODECHK, FILESYS and IFSFUNC?andM;I think the last one is a TSR pop-up, but I've no idea how to invoke it.andP;  DStanley, Worthing, West Sussex.andM;A All the files you've listed are functions called up by other programs andnot by you directly, which is probably why they're baffling you.andP;  In short,they just run in the background, but for your peace of mind the surgeons havecome up with some explanations:andM;NVRTEST: In every machine there's a battery power area which retainsinformation when you switch the machine off, called NVR.andP;  NVRTESTautomatically checks to see that the memory is intact every time you switchon the machine.andM;MODECHK: This function checks to see which screen mode you're running andthen reports it back to the console.andM;FILESYS: Yet another automatic safety check!andP;  This one just makes sure thatyour file management commands will work.andM;IFSFUNC: This one is a secret, literally.andP;  Microsoft includes it as part offuture developments but the company won't disclose what it does to anybody.andM;As for the keyboard, only the Amstrad one will fit.andM;Q I have an Olivetti M24 on which I run dBase IV developer's edition withLotus Metro as a TSR.andP;  The system was returned to the office when the Compaq3.10 version of DOS was installed, for some reason.andP;  This left the real-timeclock inoperative but caused no other problems.andM;Last week the File Allocation Table was corrupted through mains interference(I think).andP;  So I copied all my files on to floppy disk and reformatted thehard disk.andM;I decided to revert to Olivetti DOS 2.11 in order to recover the real-timeclock.andP;  Reloading DOS failed with 'non-DOS partition'.andM;I then used the low-level disk inititalise with Debug entry C800:g, whichcleared the problem.andP;  I redefined 614 cylinders for DOS, loaded Olivetti DOS2.11 and, finally, I copied the files back onto the hard disk.andM;The problem I now have is that everything works, including the real-timeclock, except dBase IV BUILD.andP;  When I run BUILD, it analyses all the sourcefiles in the application and then either locks up or reloads!andM;Interestingly, the clock time displayed during BUILD and with dBase isn'tthat of the real-time clock -- it starts from 12:00 after switching on.andO;Also, the time displayed in dBase with the command ? TIME() is the actualreal-time clock reading.andM;Finally, I transferred dBase to another PC and BUILD ran with no problems.andO;Tony Stribling, Software Consultant, Biggleswade.andM;A OK, first of all, let's deal with the clock.andP;  dBase IV will make a DOS callto retrieve the time.andP;  Where the clock needs to keep displaying the time, theTIME () function needs to display it only once.andP;  It appears that dBase willretrieve the time for the clock display from the standard address of the DOSclock in memory, whereas the TIME() function will retrieve the time from thereal-time clock.andM;The Olivetti version of DOS which is being used seems either to insert 12:00in the DOS clock each time the machine boots up or to put the right timeretrieved from the real-time clock in a non-standard address in memory.andM;Standard versions of DOS will put the correct time in memory at the standardaddress at the time the machine boots up.andP;  Therefore, both the clock displayand the TIME() function in dBase will show the same times.andM;Better?andP;  Now for the tricky part.andM;Ashton-Tate has no idea why your machine should be locking up when you useBUILD unless there's something non-standard about the environment you'rerunning in.andP;  Have you tried BUILDing the application without the TSR loaded?andM;Was there any corruption in any of the data at the time of BUILDing on theOlivetti?andP;  Were there any lost clusters on the hard disk at the time?andM;There was an intermittent problem with BUILD in low-memory applications indBase IV version 1.0.andP;  So if you haven't switched to version 1.1, you shouldtry that straight away.andP;  The surgeons have been reliably informed that youcan receive a free upgrade by calling Ashton-Tate on (0628) 775400.andM;Q I've been a PC user for a number of years, but I've never set up a newmachine from scratch.andM;I have a Compaq Plus with MS-DOS 2.21 and I'd like to have more storagespace.andM;The hard disk is formatted and sectored to provide storage to only 7Mb,whereas I believe that I should be able to get 10Mb or thereabouts.andM;What I'm intending to do is to copy off all the data onto 360Kb 5-1/4-inchfloppy disks, then reformat the hard disk and stuff MS-DOS and all data ontothe machine.andM;Please advise me of any problems I might encounter when I attempt this.andP;  JohnD Brownlie, Construction Design.andM;A The surgeons don't think you should encounter any problems with thisstraightforward procedure, although as you've been able to access the full10Mb of hard disk storage space with MS-DOS 2.21, it's just possible thatthere's been an incorrect configuration at some time or that there are somebad blocks on the disk -- this will quickly become apparent during theformatting procedure.andM;You'd do well to take this opportunity to upgrade to a current version ofMS-DOS (such as version 3.31).andP;  The upgrade is a simple process, and onewhich you could easily perform yourself, but an authorised Compaq dealer willbe able to look at the disk and check your system configuration.andM;Q I have a 25ms 110Mb hard disk that I transferred from an 8MHz Turbo XT.andO;This uses an 8-bit RLL card with a WD1002 chipset.andP;  The interleave is set for3:1.andM;I've recently bought a 16MHz 386SX motherboard and I want to use this drivewith it.andM;when the drive was in the XT Turbo the transfer rate was about 300Kbps.andP;  Nowthe drive is in the 386SX, the transfer rate is 26Kbps.andP;  A number ofdifferent programs have been used in order to confirm this.andM;The drive has been checked in the 386SX for best interleave and this isreported to be 7:1.andP;  Using this interleave of 7:1, the transfer rate wouldstill only be 100Kbps.andM;The 386SX is running at full speed, as Norton reports 15 times the speed ofan XT.andM;I've enabled shadow RAM for the video ROM BIOS and disk BIOS, but the speedremains the same.andP;  A 16-bit RLL controller may make it faster, but the 8-bitone should perform no worse in the 386SX than in a Turbo XT.andM;Any ideas?andP;  S Lemon, Lloyds Bank Telecoms Dept, London SE1.andM;A As this Question wasn't manufacturer-specific, the houseman who was on dutytook it to Dell, which reckoned it was a difficult problem to solve owing tothe number of variables involved -- not least of which are various equipmentmanufacturers, several revisions of hardware and test software, and no directhands-on testing.andM;(The company added, with a censorial shake of the head, that this is what youcan expect from buying major system components from a range of suppliers andmaking a &quot;mix and match&quot; product.)andM;The theory says that XTs and ATs are fully compatible and you should get thesame performance if you transfer cards between systems, which has obviouslybeen disproved here.andM;The first thing that needs to be sorted out is where the speed bottleneckoccurs.andP;  is it caused by the card, the PC bus or an interface clash betweenthem?andP;  To find out, you need to talk to the manufacturer of each componentinvolved -- the hard disk drive, its controller and the PC.andM;From the information provided, it seems the possible areas of difficulty are:andM;* If the hard disk controller card was working on an XT bus at 4.77MHz, itmay not be capable of running on an 8MHz AT bus in the 386SX.andP;  If this is thecase, the card may be incapable of performing properly, hence the very slowtransfer rate.andM;If the 386SX PC bus was slowed down to 4.77MHz and the transfer rateincreased, this would provide a strong indication of this theory being right.andM;For your information, in the case of AT-compatible systems, this isn't anissue as the bus standard is set at 8MHz no matter what the processor is, sothe problem here is much less likely.andM;* The 386SX setup allows users to set many different parameters whichwouldn't be easily configurable without considerable technical expertise.andO;Also, the screen doesn't give much guidance as to what each function reallydoes.andM;From the printout which was supplied, there are several settings concerningwait-states for bus access, some of which are set at 11 and some at 1.andP;  Thiscould have a dramatic performance impact if not optimised.andM;But, says Dell, we wouldn't suggest that users just 'suck it and see' byrandomly changing these without support from the supplier.andM;The most cost-effective solution to this case might be to ask the PCmanufacturer which controller card it would use with the specific hard diskdrive, the performance it would expect and the necessary settings.andM;Since a controller card is cheap -- around 100 pounds -- this would be betterthan replacing the hard disk drive as well.andM;Q I've some questions regarding AST I/O cards.andP;  What are the chips that go inlocations u10, u11 and 119 on the I/O Plus II?andP;  And what are the chips thatgo in locations u1, u2, u3 and u6 on the I/O Mini II?andM;This information would be useful as I've a number of these boards and itwould be nice to make use of them instead of buying new ones.andP;  K Quick, OpenUniversity, Milton Keynes.andM;A Both the I/O Plus II and I/O Mini II are used in connection with an optionthat allows these boards to support games port adaptors.andM;In fact, the games port option is still available for the I/O Mini II fromAST.andP;  To get hold of one, quote part number 500323-004.andP;  Unfortunately, theoption is no longer available for the I/O Plus II as this product has beenobsolete for some time now.andM;If you'd still like to use these cards but have mislaid the manuals, the DIPswitch settings for these products (as well as all other AST board productsand even the software used in conjunction with them) are available free ofcharge from the AST on-line service.andP;  Details are available from AST on (081)568-4350.andM;Q Can you help with what, I think, should have been a simple query, andcertainly not one in the sophisticated league of most PC Clinic queries..?andM;I wish to add a 20Mb hard cad (CMS Enhancements) to a trusty old IBM PC --twin floppy disk drive, circa 1985 or 1986.andP;  However, neither the user manualnor a contemporary technical manual bother to show dip switch positions onthe system board for anything beyond two floppy disk drives.andM;The best I've achieved so far is getting the message: 'LiteDrive fullyoperational.andP;  Attempting to boot from floppy...'andP;  Then nothing.andM;If you can shed any light on this I'd be very grateful -- especially sincewe're only trying to save the State a few pounds!andP;  Dr Peter Dunwoodie,University of London.andM;A The surgeons, ever keen to help a fellow doctor save a few pennies in thishighly cost-conscious climate, were very happy to deal with this query.andM;However, they're not so sure that they can find a happy solution, as whetheror not you can install a hard card on your machine depends on whether it hasone set of dip switches or two.andM;The good news is, if you do have two sets, the hard card should work.andO;However, you needn't (and can't) actually set the number of hard filesyourself as this is done automatically when the BIOS looks for the hard fileon boot-up.andM;The bad news is, if you have one set of dip switches, it means that you haveone of the pre-1984 models.andP;  These machines were never designed to accepthard cards and so you probably won't be able to install one at all.andM;* Here's a note regarding R Potter's printer output problem in issue 142.andO;Your diagnosis is nearly correct, but what your patient didn't reveal waswhether the printer on the serial port was using Xon/Xoff or hardware flowcontrol.andM;From the description of the symptoms, it appears he's using Xon/Xoff -- apersistent problem with all PCs.andP;  Microsoft has ignored completely the factthat 90 per cent of the world and his wife uses Xon/Xoff rather than someready flavour of Ready/Busy signalling.andM;May I suggest three possible remedies, two software and one hardware.andP;  Thefirst two provide the Xon/Xoff driver so kindly omitted from MS/PC-DOS.andP;  Acopy of AST's Superspl program will program the UART to ignore the lines notused, for example, the line below sets Superspl up to use only Xon/Xoff,C:\useful\superspllpt1:=com2: /rate=2400,n,8,1/on=xon/off=cts,dcd,dsrandM;Alternatively, the line below ensures that the printer has to be switchedover or powered up before the spooler will print.andO;C:\useful\superspllpt=com2: /rate=2400,n,8,1/on=xon,dsr/off=cts,dcdandM;DEC also recognised this shortcoming of DOS with its PCSA products and it hasincorporated an Xon/Xoff driver within the PCSA utilities, which support DECprinters such as LA75s and LA210s.andM;The final solution is to fool the PC into believing that something (a modem,for instance) is attached to the serial port, by connecting pin 4 to 5 andpin 6 to 8 and 20 at the PC end of the cable.andP;  Normally the &quot;,P&quot; parameter isalso used at the end of the mode command to inform the PC that it's a printerand that the timeout should be continously retried.andM;Most manufacturers of printers and plotters recognise this when providinginstructions and drawings of cables for connecting peripherals up to anyMS-DOS machine.andM;The difficulty arises when trying to connect something else that isn'tdocumented.andP;  Roger Whiteley, systems engineer, Electronic Data Systems,Luton.andM;* In issue 141 you printed a letter from Douglas McKee (GVG FinancialServices) on the question of mailmerging random record samples.andM;We do this using SuperBase 4 Windows and Word for Windows, and we'd be happyto give him a demonstration.andP;  Martin Durham, MPD Associates, Chesham.andM;This issue we take a look at some of the most common questions users ask theWordPerfect technical support team.andM;Q Why can't I see a full line of characters across my screen?andM;A Most monitors have the ability to show 80 columns across.andP;  This means it'spossible to see only 80 characters across the screen at any one time -- inother words, 1 character = 1 column.andM;The standard paper size used in the UK is A4 (8.27x11.69 inches).andP;  Left andright margins in WordPerfect are, by default, 1-inch, leaving 62.7 inches fortext on each line.andM;When using a 10-pitch font, this allows 62.7 characters to be printed on eachline.andP;  Since the monitor is capable of showing 80 characters on any one linewithout scrolling, the whole of this line will be shown on-screen.andP;  If,however, a 15-pitch font is used with 1-inch margins, 94.05 characters willbe placed on one line.andM;As stated above, only 80 characters can be shown on screen at any one time,therefore to accommodate the remaining 14.05 characters, the screen willshift to the right.andP;  Proportionally-spaced fonts will also cause the screento scroll because, again, more than 80 characters are on any one line.andM;Q How can I stop WordPerfect inserting blank lines into a merged document?andM;A When merging a primary and secondary file to create a document such as anaddress list, you can eliminate blank lines by typing a question mark afterthe field number ({FIELD}2?~).andP;  The question mark tells WordPerfect 5.1 tosee if the field is blank.andP;  If so the line, including the end-of-linecharacter, is deleted in the merged document.andM;The following example, using the more advanced merge codes of WordPerfect5.1, checks the address field in the current record of the secondary mergefile.andM;If the address isn't blank, it writes the address in the merged document.andP;  Ifthe address is blank, the record isn't merged.andM;{IF BLANK} Address~{COMMENT} If the address field is blank: {NEXT RECORD}~{ELSE} {COMMENT}andM;Otherwise, write the address into the letter: ~{FIELD} Address~ Dear {FIELD}Name~ Body of letter {END IF}andM;If  one or more spaces are entered before {END RECORD} and [HRt] in asecondary file, the merge will insert a blank line wherever the spaces werepresent in the completed merge file.andO;</TEXT></DOC>
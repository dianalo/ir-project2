<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF109-558-811  </DOCNO><DOCID>09 558 811.andM;</DOCID><JOURNAL>Dr. Dobb's Journal  Nov 1990 v15 n11 p86(7)* Full Text COPYRIGHT Mandamp;T Publishing 1990.andM;</JOURNAL><TITLE>Programmer tools for Actor 3.0: data management and resourceediting for Windows development.andO;</TITLE><AUTHOR>Franz, Marty.andM;</AUTHOR><SUMMARY>The use of Whitewater Group's (Evanston, IL) $695 Actor 3.0Windows development language to program applications for theMicrosoft Windows is demonstrated.andP;  The new version of Actorincludes two new programming tools, WinTrieve and the WhitewaterResource Toolkit (WRT).andP;  The WinTrieve data manager provides anIndexed Sequential Access Method (ISAM) capability for ActorWindows programs.andP;  ISAM provides a program with the ability 'tocreate, add, delete and retrieve records using a key.' The WRT isan editor for developing and editing 'all the miscellaneous'graphics and text resources needed by Windows programs.andP;  Actor(and specifically the new tools) are used to successfully modify a'Book Browser' program included with WinTrieve into aWindows-based Rolodex file.andP;  The new tools improve Actor 3.0'sfunctionality as a 'professional applications and rapidprototyping language.'andM;</SUMMARY><DESCRIPT>Product:   Actor 3.0 (Program development software) (Usage)Microsoft Windows (Graphical user interface) (Programming).andO;Topic:     Program Development ToolsApplications ProgrammingWindowingData ManagementText EditorsIndexed Sequential Access MethodProgram Development Techniques.andO;Feature:   illustrationprogram.andO;Caption:   Constructing and returning new dialog. (program)Main window of Rolodex ISAM file browser. (program)Menu constants. (program)andM;</DESCRIPT><TEXT>Programmer Tools For Actor 3.0andM;A colleague of mine (who shall remain nameless) has a favorite aphorism: If aprogram is tough to write, it should be tough to use.andP;  Given this mindset, itshould come as no surprise that he dislikes writing programs for MicrosoftWindows, especially in C.andP;  I don't agree with this statement, but I do agreewith its contrapositive: If a program is easy to use, it should be easy towrite.andP;  Therefore, I have avoided using C to program for Windows.andP;  Instead, Iuse Actor.andM;The Whitewater Group, mindful of Actor's emergence as a serious Windowsdevelopment language, has decided to provide two new programming tools forActor: WinTrieve, an ISAM (Indexed Sequential Access Method) for Actor (andC) programs running under Windows; and the Whitewater Resource Toolkit, aneditor for building and editing all the miscellaneous resources (menus,accelerators, cursors, and so on) needed by a Windows program.andM;Before these tools were around, developing comparable programs for Windowsmeant writing these programs in C.andP;  In this article, I'll examine these toolsand how they're used to build an application that actually uses &quot;real&quot; filesand Windows resources -- but with considerably less suffering.andM;Actor 3.0andM;Although Actor 3.0's support of Windows 3.0 was what made the news, therewere other improvements over Version 2.0 as well.andP;  In Actor 2.0, forinstance, an innovative &quot;memory swapping&quot; technique was implemented (see thearticle &quot;Object Swapping&quot; by Jan Bottorff and Jim Bolland, DDJ, May 1990)whereby the 640-Kbyte barrier was effectively broken, allowing you to writeextremely large Actor programs.andP;  With Actor 3.0, this technique has beenextended to use Windows' standard and enhanced 80386 modes to createapplications up to 2 Mbyte in size.andM;Another feature worth mentioning is a streamlined seal-off procedure.andP;  Theterm &quot;seal-off&quot; refers to the process of removing the development classesfrom the workspace so just the application objects and classes remain: Ineffect, &quot;compiling&quot; the Actor program so it can run as a standalone Windowsapplication.andP;  In prior versions of Actor, this could be cumbersome.andP;  InVersions 2.0 and 3.0, there's a menu option and a dialog to fill out, and therest of the seal-off process is automatic.andM;There are also numerous other improvements in the product, including a Systemobject for encapsulating operating system dependencies, and moreWindows-specific classes.andP;  The new Windows classes include convenient Windowsprinting and dynamic menus and dialogs.andP;  The class library improvements havebeen added with an eye toward compatibility with prior versions of Actor, alesson Borland and Microsoft could learn from the Whitewater Group.andM;Dynamic dialog and menu classes make rapid application prototyping mucheasier.andP;  In earlier versions of Actor, there were only simply modal andnonmodal dialogs available as classes without resorting to the Actor'sWindows Call facility.andP;  This new version allows complex dialogs to be builtwith more object-oriented means, as shown in Example 1.andM;In the recDlg() method shown in Example 1, a new dialog is constructed andreturned.andP;  The setSize() message gives the overall dimensions of the dialogbox, while each addItem() adds a control or field.andP;  Static text, editedfields, and a pushbutton to cancel the dialog are added, along with theircontrol IDs.andP;  Dynamic Dialogs are used in the sample program to create amulti-field input dialog for the record being added or updated in thedatabase.andM;Other Actor 3.0 features include being able to more easily go between Actorand C or Assembler, including writing your own primitives in C and linkingthem into the Actor image.andM;WinTrieveandM;WinT}ieve is a data manager for both Actor and C that provides an IndexedSequential Access Method (ISAM) for Windows programs.andP;  Without it, fledglingWinsis their application using only the file access provided through thebasic Actor or C language.andP;  This means there's no support for addition andretrieval of keyed records.andP;  Since many (if not most) business-typeapplications require this type of function, it meant hand-building thissupport into Actor or C programs -- not the most entertaining job.andM;WinTrieve provides the capability to create, add, delete, and retrieverecords using a key.andP;  while not a complete database-management system, thissupport goes a long way to building a DBMS and in fact provides a sizablechunk of the function needed by most business programs.andP;  WinTrieve alsoprovides some limited relational capabilities, such as linking fields betweenISAM files.andP;  Locking is available in a fully automatic mode, a manual mode,or none.andP;  Both entire files and individual records may be locked.andM;WinTrieve has three parts: An ISAM server, which runs as a separate Windowsapplication, and two Application Program Interfaces (APIs), one for Actor,the other for C.andP;  The Actor API consists of several classes that are loadedinto the Actor image.andP;  These include an IsamManager class, an IsamFile class,and several IsamKey classes.andP;  The CAPI consists of header files and libraries(one for each memory model) and can be linked into your Microsoft C programs.andM;The ISAM Manager is loaded as a separate Windows program and runs &quot;outside&quot;of the Actor workspace.andP;  This means that programs written outside of Actorcan use it, provided they adhere to the protocol.andP;  This has been documentedin the WinTrieve manual and shouldn't prove any problem to experiencedWindows programmers.andM;Using an object-oriented language has advantages when writing programs thatuse an ISAM.andP;  The OOP metaphor means you can think about the ISAM file asanother collection or file object.andP;  Once written, the often-convoluted logicof dealing with recovery, transaction locking, and journaling can be safelyplaced in the class tree and inherited without a lot of fuss later.andM;WinTrieve is an access method, providing the application with services tobuild and use indexed files; it's not a complete DBMS.andP;  This limitation isboth good news and bad.andP;  The downside is that you don't get a lot of thefeatures of a full DBMS -- query facilities and application and reportgenerators.andP;  The good news is that you get a simpler, more flexible tool withconsiderably less overhead.andP;  If you need the additional DBMS-like facilities,you can build them in Actor or C.andM;Whitewater Resource ToolkitandM;One of the limitations in earlier versions of Action was that programmerswere dependent on the Microsoft Windows SDK for customizing applicationresource.andP;  What a drag.andP;  The power of a state-of-the-art language such asActor was harnessed in tandem with a plowhorse like the Resource Compiler.andO;It made using static resource in Actor programs a chore, enough so -- unlessyou were writing production-quality programs in Actor -- that you didn't doit.andM;The Whitewater Resource Toolkit is a solution to this problem.andP;  It supportsboth C and Actor programs and can handle resources in RES, BMP, ICO, CUR, andEXE formats.andP;  The individual editors in it work like MacDraw or MacPaint: Youare presented with a graphical view of the resource you are editing and youuse a selection of tools, chosen from a palette, to edit them.andM;At the time I'm writing this, the Resource Toolkit doesn't run support forWindows 3.0.andP;  But, by the time you're reading this, the Resource Toolkit willlikely support Windows 3.0.andP;  Until then, you'll have to edit resources underWindows 2.1, and bring them over.andM;Within the Resource Toolkit are editors for each type of resource: graphicseditors (for bitmpas, cursors, and icons), a menu editor, a dialog editor, anaccellerator editor, and a string editor.andP;  These editors are all linked by atool called the &quot;Mover,&quot; which allows you to view, move, copy, select, anddelete various resources in various files.andM;The editors are all organized along the same lines.andP;  A File menu loads andsaves the resource you're editing, and an Edit menu cuts, copies, and pastesparts of a shape.andP;  In the graphics editors, the palettes have tools fordrawing lines, rectangles, and ellipses, and moving shapes and changing theircolors.andM;The Resource Toolkit is easy and fun to use and makes you want to customizeyour application beyond the limits of good taste and user-friendliness.andP;  It'salso entirely written in Actor and makes a convincing demonstration of whatthe language is capable of.andM;Putting it to WorkandM;To demonstrate and evaluate these new tools, I took the Book Browserapplication provided with WinTrieve and modified it into a Rolodex file.andO;ROLO.H (Listing One, page 132) is the application header file.andP;  As in a Cprogram, this file contains constants, including menu item numbers and dialogconstants.andM;ROLO.ICO (available electronically, see &quot;Source Code Availability&quot; on page 3)is the Rolodex application icon.andP;  I took the icon provided for the BookBrowser and modified it using the Resource Toolkit, adding a spiral bindingto the side of the &quot;book.&quot;andP;  Voila! instant Rolodex.andM;ROLO.ACT (Listing Two, page 132) adds some additional methods to the Stringclass for the Rolodex.andP;  ROLO.RC (see &quot;Availability&quot;) is the resource file forthe sealed-off application.andP;  To build this file, I simply modified what wasin the Book Browser's resource file using Actor's File Editor.andM;ROLOAPP.CLS (Listing Three, page 132), ROLOFILE.CLS (Listing Four, page 132),and ROLOWIND.CLS (Listing Five, page 132) are all class files for theapplication.andP;  Listing Three implements the RoloApp class, the &quot;wrapper&quot; forthe sealed-off application.andP;  It has a single message, init(), sent when theapplication is started.andP;  It performs necessary initialization and passescontrol to RoloWindow, the application's main class.andP;  One of theinitialization steps performed in init() is to start the ISAM Manager, andeither create or open the Rolodex database.andM;ROLOFILE (Listing Four) is a descendant of the IsamFile class.andP;  It definesthe structure of the ISA, file that contains the Rolodex.andP;  The ISAM file hasthree fields: The entry's phone number, the primary key, the person's name, asecondary key, and the person's company affiliation.andP;  All these fields are30-character strings.andP;  The sole purpose of this class is to pass thisinitialization information to the ISAM Manager when the application isstarted.andM;Finally, ROLOWIND (Listing Five) implements the workhorse of the application;the RoloWindow class.andP;  Since we're developing a standalone Windows program,it'll also be the window that gets control when the program starts.andP;  TheRoloWindow class is a descendant of TextWindow, so it automatically inheritsall of the class's features, including text entry and a text cursor.andP;  But theRoloWindow class adds a menu handler that performs the functions of theapplication, including perusing the database by moving forwards and backwardsand inserting and deleting entries.andM;The RoloWindow class is relatively large because it must support an elaborateprotocol for Windows.andP;  The includes not only the messages needed to handlemenu commands to the window, but also each menu function's message, such asdeleRec() to remove the current record from the file and updateRec() toupdate the current record if it's been changed.andM;The bulk of the work in RoloWind.andP;  CLS is done in validateInput() and itsprivate messages getPerson() and getPhone().andP;  These obtain and validate inputfrom the user using Actor's Dynamic Dialogs.andP;  The recDlg() message constructsthis dialog when the RoloWindow is initialized using serveral addiItem()messages.andP;  It builds a Dictionary containing the name of each field as a keysymbol and the field's contents as the value.andP;  These are not to be confusedwith the actual ISAM records, which have the same field names but are in alluppercase.andM;The amount of code in RoloWindow is reduced by using Actor's powerfulperform() message.andP;  This allows us to create a collection of methods andmessages for all the possible responses to RoloWindow's command() message.andO;When the command() message is sent with a menu number after a menu item ispicked by the user, command() simply passes control to the method matchingthe menu ID.andP;  No multiway branches are needed.andP;  This means that new menuoptions can be easily added to the Rolodex later.andM;To get the application working, you must first load the ISAM Manager'sclasses into the Actor workspace.andP;  On my home PC (a 10-MHz 286 with only 640Kbyte of RAM) I had to chop Actor's dynamic and static storage allocationsbefore both the ISAM Manager and Actor could coexist under Windows.andP;  TheWhitewater Group recommends having at least 1 Mbyte of RAM when usingWinTrieve and Actor together.andP;  On my work PC, a 20-MHz 386 with 2 Mbyte ofRAM, this was not a problem.andP;  The sealed-off application, however, ran fineon both machines.andM;Once the ISAM manager is loaded, you need to load the Rolodex classes byloading the ROLO.LOD (see &quot;Availability&quot;) load file.andP;  You can then start theRolodex interactively using:andM;Sam:= new(RoloApp); init(Sam, nil);andM;ConclusionandM;Actor was always a convenient programming tool for Windows, and a good way tobecome familiar with Windows' facilities even if you wrote the final programin C.andP;  With Version 3.0, Actor is now better suited to developing realapplications.andP;  The addition of WinTrieve and the Whitewater Resource Toolkitbooast Actor's capabilities as a professional applications and rapidprototyping language.andP;  Programmers despairing of C for writing Windowsprograms are encouraged to consider Actor for their next programming project.andO;You might find that programs that are easy to use can also be easty to write.andM;Marty is a software engineer with Allen Testproducts Inc. of Kalamazoo,Michigan.andP;  He is the author of Object-oriented Programming Featuring Actor,published by Scott Foresman andamp; Co.andO;</TEXT></DOC>
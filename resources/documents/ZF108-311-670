<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF108-311-670  </DOCNO><DOCID>08 311 670.andM;</DOCID><JOURNAL>Lotus  April 1990 v6 n4 p48(5)* Full Text COPYRIGHT Lotus Publishing Corp. 1990.andM;</JOURNAL><TITLE>8 database enhancements. (Lotus 1-2-3 databases) (tutorial)</TITLE><AUTHOR>Tucker, Scott.andM;</AUTHOR><SUMMARY>Tips for enhancing databases created with Lotus 1-2-3 arepresented.andP;  The Data Fill command provides a convenient way tonumber records.andP;  Users can assign range names to the first datarecord with /Range Name Labels Down.andP;  Range names are limited to15 characters, and field names should not be the same as macrocommands.andP;  Entering numbers as labels prevents their accidentaluse in macro or formula calculations.andP;  The Worksheet titlescommand holds a row or range of rows in place while the user workswith a database.andP;  Creative printing options include printing onlyselected columns and generating pages of summary statistics.andO;Users should keep ranges in working order to avoid failed sortsand queries.andP;  Separating field names from data records is vital.andO;Using wild cards simplifies the query process.andP;  The asteriskcharacter matches all characters to its right, the question markmatches a single character, and the tilde matches labels.andM;</SUMMARY><DESCRIPT>Company:   Lotus Development Corp. (products).andO;Ticker:    LOTS.andO;Product:   Lotus 1-2-3 (Spreadsheet software) (usage).andO;Topic:     Data Base Management SystemsSpreadsheetsTutorialMacrosEnhancements.andM;</DESCRIPT><TEXT>8 Database EnhancementsandM;No matter how much time you spend designing a database, you'll eventuallywant to enhance it or make it easier to work with.andP;  For example, maybe youcreated a database in which you entered some numbers as values, and you nowwant to convert them to labels.andP;  Or maybe you need a way to print out onlyselected fields.andM;Those are just two problems you'll learn to solve in this article onenhancements 1-2-3 Releases 2.01, 2.2, and 3.andP;  To follow the discussion,build and save the database shown below.andP;  Like all 1-2-3 databases, this oneconsists of a row of field names, shown in row 1, followed by some datarecords, shown in rows 2 through 6.andP;  also included are a Criterion range (in1-2-3 Releases 2.2 and 3, Criteria range ) and an Output range.andM;To begin, press slash and select Worksheet Column Set-Width to set thefollowing individual column widths: B--12, C--24, D--11, and E--6.andP;  Thenenter the data shown in range A1..E6.andP;  Precede each entry in range C2..C6with an apostrophe.andP;  Copy range A1..E1 to cell A8 and A11.andP;  Save the fileunder the name SAMPLE.andP;  As you read through each tip, retrieve this file andfollow along.andP;  Don't save the changes you make to this file.andP;  If you wish youcan save the file under a different name instead.andP;  The point is that the filenamed SAMPLE should always contain only the data shown above.andM;1 Use the Data Fill command to number records.andM;1-2-3 sorts numbers and labels in either ascending or descending order.andP;  Formost of the work you do in your databse, you'll find that these options aresufficient.andP;  But you may anticipate that at some point you'll want to restorethe data records to the order in which you originally entered them.andP;  To dothis, you'll need to plan ahead by including in your database a field thatstores a recond number.andM;If the file SAMPLE is not still in memory, retrieve it.andP;  Before you sort thedatabase for the first time, assign a number to each record.andP;  First, enter aunique field name--for example, Record--in cell F1.andP;  Then use the Data Fillcommand to assign sequential numbers to the data records.andM;For  example, select/Data Fill, specify a Fill range of F2..F6, a start valueof 1, and press Return twice to accept the default step and stop values.andO;1-2-3 automatically numbers the records, as shown below:andM;Now no matter how many times you sort the database, you can always restore itto its original order simply by specifying the Record field as the primarysort key and by specifying A for ascending sort order.andM;2 Assign rang names to the first data record.andM;Most of the time, a formula in the Criterion range refers to fields in thefirst record of the database.andP;  When you're writing a criterion formula, ithsoften difficult to remember the cell address of a field.andP;  And if the databasemodel is large, building the formula by pointing to the cell takes too long.andO;To write criterion formulas faster in 1-2-3 Release 2.01 and 2.2, assign eachfield name as a range name for the corresponding entry in the first record ofthe database.andM;Retrieve the file SAMPLE.andP;  To assign the range names, select /Range NameLabels Down and specify range A1..E1.andP;  Now cell A2 is assigned the namenumber, cell B2 is assigned name, and so on, across the row.andM;Now when you write a criterion formula, use range names rather than celladdresses.andP;  For example, to locate all records that have a value of less than100 in the Number field, enter the formula +number[is less than]100 in cellA9 of the Criterion range.andP;  Then select/Data query Input.andP;  Specify rangeA1..E6 as the Input range.andP;  Select Criterion and specify range A8..E9.andO;Select Output and specify range A11..E11.andP;  Finally, select Extract Quit.andP;  Tworecords appear in the Output range, as shown below:andM;However, consider three caveats.andP;  First, a range name is limited to amaxiumum of 15 characters.andP;  When you use the Range Name Labels Down command,1-2-3 assigns the first 15 characters as the range name.andP;  Since each rangename must be unique, no two field names can begin with the same 15characters.andP;  Second, if the model uses a macro, don't choose field names thatare the same names as advanced macro commands.andP;  Otherwise, the macro will tryto run the range name as a subroutine.andP;  Third, in Release 3 use field namesin formulas without first assigning them as range names.andP;  In fact, if youassign range names to the field names, some problems may result.andM;3 Enter numbers as labels.andM;Most databases contain numbers that you'll never use in a calculation.andP;  Theseinclude zip codes, telephone numbers, or inventory part numbers.andP;  For somenumbers, it's clear that you should precede them with a label prefix.andP;  You'lldetect a problem immediately if, for example, after you enter the telephonenumber 555-1379, the number -824 appears in the cell.andM;With some reference numbers, the need to supply a label prefix isn't obvious.andO;Consider zip codes, for example.andP;  It's easy to enter many zip codes wihtout alabel prefix into the database and not see a problem.andP;  But when you enter thecodes for Connecticut, New Hampshire, or New Jersey--states whose codes beginwith a zero--1-2-3 doesn't display the leading zero.andM;To solve this problem, you simply enter the number as a label.andP;  This is agood tip to know before you enter a few hundred records.andM;Let's say you have hundreds of records and weren't wise to this tip.andO;Fortunately, you can write a string formula that converts a column of zipcode numbers to labels and adjust for missing zeros at the same time.andM;Retrieve the file SAMPLE.andP;  Enter the label ZIP in cell F1, and enter thefollowing zip codes as values in the cells indicated: F2--03755, F3--23113,F4--79602, F5--03102, and F6-06430.andP;  The values you entered in cells F2, F5,and F6 won't appear with a leading zero.andM;To correct the problem of the missing zero and return a zip code that's alabel, enter the following formula in cell G2 and copy cell G2 to rangeG3..G6:andM;@RIGHT(&quot;0&quot;andamp;@STRING(F2,0),5)andM;The formula @STRING(F2,0) CONVERTS THE CONTENTS OF cell F2 into a label anddisplays zero decimal places.andP;  The label &quot;0&quot; is concatenated with the labelreturned by the @STRING formual and thus returns the label 03755.andP;  Then the@RIGHT function returns the five rightmost characters in that label.andP;  Thatstrips off an unnecessary preceding zero for the zip code of Midlothian, Va.,andO;but leaves a necessary zero, such as in the zip code for Hanover, N.H.andM;Now you need to convert the column of formula into values.andP;  To do so, select/Range Value.andP;  Specify range G2..G6 as the From range and cell G2 as the Torange.andP;  The cells now contain the results of the @RIGHT formulas, not theformulas themselves.andP;  Finally, select /Copy and specify range G2..G6 as theFrom range and cell F2 as the To range.andP;  The Zip field of the database nowcontains zip codes that are labels, not values, as shown in the figure below:andM;Now you can erase range 62..G6.andM;4 Use the Workshett Titles command.andM;A database usually contains more columns and rows than you can display at onetime.andP;  While you can use the cursor-movement keys to roam around your data,you might forget what an entry means once the field names aren't on thescreen.andP;  Fortunately, you can use the Worksheet Titles Horizontal command tohold a row or range of rows in place while you work with your database.andM;To use this command, move the cell pointer to any cell in the row directlybelow the row containing the field names.andP;  Then select /Worksheet TitlesHorizontal.andP;  When you move the cell pointer down through the database, thefield names remain in view.andP;  For example, retrieve the file SAMPLE.andP;  Move thecell pointer to cell A2 and select/Worksheet Titles Horizontal.andP;  Press thePageDown key a few times, and you'll see that the row of field names remainsvisible at the top of the screen.andP;  When you wish to unfreeze the titles,select /Worksheet Titles Clear.andM;A related command, Worksheet Titles Vertical allows you to freeze columns sothat they remain in place as you peruse columns that are ordinarily off thescreen.andP;  Just position the cell pointer in any cell in the column just to theright of the column, or columns, that you want to hold in place.andP;  Then select/Worksheet Titles Vertical.andM;Sometimes using either of the above commands isn't enough.andP;  When you need tofreeze both columns and rows, use the Worksheet Titles Both command.andO;Position the cell pointer in the cell that is directly to the right of thecolumn you want to freeze and directly below the row you want to freeze.andO;Then select /Worksheet Titles Both.andM;5 Print your database creatively.andM;Don't overlook the value of brevity when presenting your data.andP;  Rather thanprint an entire database, extract just a portion of the database forprinting, or used th @D functions or a Data Table command to generate a pageof summary statistics.andM;If a concise analysis of the database won't suffice, perhaps you can printonly selected columns.andP;  To do this, you use hte Worksheet Column Hidecommand.andP;  For example, retrieve the file SAMPLE.andP;  Suppose you decide that youneed a printout containing only columns A, C, and E.andP;  You can hide columns Band D so that they don't appear on your printout.andM;To do so, select /Worksheet Column Hide.andP;  Specify any cell in column B.andO;Repeat the command and specify any cell in column D.andP;  As soon as you hide acolumn, 1-2-3 removes it from the display and the remaining columns aredisplayed in their place.andP;  Your worksheet should look just like the one shownto the right.andM;Now you can issue the appropriate commands to print the data.andP;  When you'reready to redisplay the columns, select /Worksheet Column Display.andP;  1-2-3immediately displays all of the hidden columns, which are marked with anasterisk, and prompts you to specify the one you want to redisplay.andP;  Move thecell pointer to column B and press Return.andP;  To redisplay column D, repeat theprocess.andP;  Alternatively, you can have 1-2-3 redispay both columns at once.andO;Just select /Worksheet Column Display and specify range B1..D1.andM;If you're convinced that you need to print the entire database, use the/Print Printer Options Setup command to enter a setup string that instructsthe printer to print in a special mode.andP;  The string \015 produces compressedtype on many dot-matrix printers, for example.andP;  Try using that code.andP;  If itdoesn't work, consult your printer manual.andP;  Finally, when you've finishedusing a special printing mode, use the setup string that resets your printerto print in normal model again.andM;6 Keep ranges in working order.andM;Adding a record to a database is easy.andP;  Remembering to redefine theData-Range and the Input range after adding the record is difficult.andP;  And ifyou forget to adjust those ranges after adding records, 1-2-3 won't processthe additional records when you sort or query the database.andM;Avoid failed sorts and queries by letting 1-2-3 automatically adjust theranges for you.andP;  Just add a row, each cell of which contains a backslash anda hyphen (\-).andP;  This produces a repeating dashed line, marking the bottom rowof the database.andP;  Then respecify the Data-Range or the Input range.andM;To test this for yourself, retrieve the file SAMPLE.andP;  Position the cellpointer on cell A7, select /Worksheet Insert Row, and press Return.andP;  Enter \-in cell A7 and copy cell A7 to rnage B7..E7.andP;  Now select /Data SortData-Range, specify range A2..E7, and select Quit.andP;  Select /Data Query Input,specify range A1..E7, and select Quit.andP;  1-2-3 now knows that your databaseincludes the row containing the dashed lines.andM;Suppose you decide to add three new records to the database.andP;  Just positionthe cell pointer anywhere in row 7, select /Worksheet Insert Row, press theDownArrow key two times, and then press Return.andP;  1-2-3 inserts three blankrows between the last record containing data and the dashed line.andM;Now you're free to enter the three additional records.andP;  If you wish, enterthe records that are on rows 7, 8, and 9 of the figure, shown below.andP;  Now ifyou select /Data Sort Data-Range or/Data Query Input, you'll see that 1-2-3has already adjusted those ranges to include the new records:andM;Remember, the row of dashed lines is an actual data record.andP;  In 1-2-3Releases 2.01 and 2.2, if you sort the database in ascending order, therecord of dashed lines remains at the bottom of the database.andP;  However, ifyou sort in descending order, the record of dashed lines shuffles to the topof the database.andP;  Therefore, you'll want to re-sort the database in ascendingorder before you add any additional records.andM;Note that if you use 1-2-3 Release 2.01 or 2.2 and you used the Installprogram to change the collating sequence to ASCII, the opposite recordshuffling occurs.andP;  The same holds true if you use 1-2-3 Release 3 and anycollating sequence.andP;  That means that if you sort in ascending order, therecord of dashes moves to the top.andP;  And if you sort in descending order, therecord of dashes remains at the bottom.andM;Also, remember to insert only as many blank rows as you have additionalrecords.andP;  You don't want the database to contain blank records, because theymay affect certain calculations.andP;  Similarly, if you use any @functions thatrequire you to specify a list of items to analyze, don't include thedashed-line record in the list.andP;  Otherwise, calculations involving suchfunctions as @AVG and @COUNT will return inappropriate results.andP;  Also, if youuse a macro that requires you to specify the number of records, don't includethe dashed-line record in your count.andM;7 Separate field names from data records.andM;It's tempting to use a dashed line to separate the row containing field namesfrom the rows of data records.andP;  In general, you must avoid doing so because1-2-3 treats the dashed line as a data record and sorts it along with therest of the database.andM;However, you can create field names that are made up of dashes and a label.andO;Then you'll place a copy of the field names above the dashed row.andP;  You createthese field names with dashes by using the backslash label prefix (\)followed by a series of dashes and a descriptive field name.andP;  The backslashcharacter is usually used to generate a repeating label.andP;  As you'll see in amoment, this prefix also confines the display of a long label to the currentwidth of the cell.andM;Retrieve the file SAMPLE.andP;  Position the cell pointer on cell A2, select/Worksheet Insert Row, and press Return.andP;  In each cell in range A2..E2, typea backslash followed by at least the same number of dashes as the currentcolumn width.andP;  Then type a descriptive label at the end of the dashes andpress Return.andP;  For example, in cell A2, which has a column width of 9, type\---------Number.andP;  Follow this same process for the cells in range B2..E2.andM;Now set up Criterion and Output ranges in order to perform data queries.andO;First, select /Range Erase and specify range A9..E12.andP;  Then select /Copy andspecify range A1..E2 as the From range and cell A9 as the To range.andP;  Repeatthe same process to copy range A1..E2 to cell A13.andM;Next, set up the Data-Range and the Input, Criterion, and Output ranges.andO;Select /Data Sort Data-Range, specify range A3..E7, and select Quit.andP;  Thenselect /Data Query Input and specify range A2..E7.andP;  Select Criterion andspecify range A10..E11, and select Output and specify range A14..E14.andO;Finally, select Quit.andM;Now, if you wish, you can re-sort the database or enter criteria on row 11and extract data.andP;  The following figure shows the database sorted inascending order according to Number and also shows the records that 1-2-3extracted when NH was the criterion.andM;When you use this somewhat unorthodox technique of creating field names thatconsist of dashes and a label, keep a few pointers in mind.andM;First, don't include the descriptive field names, located in row 1 of theexample, in the Input range.andP;  These labels are for display only and are notpart of the actual database.andM;Second, to create Criterion and Output ranges, copy the row of dashed linesto the areas where you'll locate those two ranges.andP;  Despite their oddappearance, the dashes are the legitimate field names.andP;  You may also chooseto copy the descriptive field names, located in row 1 of the example, to theCriterion and Output range areas, but don't include them when you specify therange.andM;Third, remember that a field name made up of a series of dashes and a labelmay exceed the 15-character limit for a range name.andP;  Therefore, you may notbe able to use this tip along with the technique that described how to assignthe field names as range names for the corresponding fields in the first datarecord (tip 2).andM;8 Use wild cards in queries.andM;Querying a large database can take a substantial amount of time.andP;  In fact,the more complex the query, the longer 1-2-3 takes to process the records.andO;By using wild card characters in the criteria, you can make your query lessspecific and save time.andP;  It's true that 1-2-3 may return more records thanyou want, but you can easily scan the list for the specific record you seek.andM;The available wild card characters are the asterisk (*), which matches allcharacters to the right of the asterisk; the question mark (?), which matchesa single character; and the tilde (~), which matches all labels except theone following the tilde.andM;To test these wild card characters, retrieve the file SAMPLE.andP;  Let's add acolumn to the database.andP;  Enter the label Item in cell F1 and then copy cellF1 to cells F8 and F11.andP;  Now enter the item numbers shown in range F2.F6 ofthe following figure.andM;Next, tell 1-2-3 the location of the Input, Criterion, and Output ranges.andO;Select /Data Query Input and specify range A1..F6.andP;  Select Criterion andspecify range A8..F9, and select Output and specify range A11..E11.andP;  Finally,select Quit.andM;Now let's say you want to extract all records that match the nameHigenbotham.andP;  Enter the criterion Hig* in cell B9.andP;  Select /Data QueryExtract.andP;  The record for Higenbotham appears in the Output range, as shownbelow:andM;If you want to extract all records that do not contain the abbreviation NH inthe State field, first erase the criterion in cell B9.andP;  Then enter thecriterion ~NH in cell E9.andP;  Press the Query key, and the records for Pease,Hill, and Hirsch appear in the Output range, as shown below:andM;Finally, let's say you need to see the records of those people who ordereditem number 120, which comes in small, medium, and large.andP;  Consequently, thatitem number can be S120, M120, or L120.andP;  First, erase the criterion in cellE9.andP;  Then enter the criterion ?120 in cell F9 and press the Query key.andP;  Therecords for Pease, Anselm, and Hirsch appear in the Output range, as shownbelow.andM;Scott Tucker is coauthor of Inside Lotus 1-2-3 Macros, published by Simon andSchuster, 1989.andO;</TEXT></DOC>
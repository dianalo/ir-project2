<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF207-238-942  </DOCNO><DOCID>07 238 942.andM;</DOCID><JOURNAL>Data Based Advisor  April 1989 v7 n4 p36(5)* Full Text COPYRIGHT Data Based Solutions 1989.andM;</JOURNAL><TITLE>Keeping the garbage out: here are some techniques for keeping baddata from getting into your database. (column)</TITLE><AUTHOR>Rubel, Malcolm C.andM;</AUTHOR><SUMMARY>Users who want to pull valid information out of their databasemust make sure that correct data is input.andP;  Features can be addedto a screen that check the validity of what is being entered anddBASE IV provides many ways of accomplishing this task.andP;  Beginningusers can access most of these features through the Forms panel.andO;Most common data entry problems can be eliminated by using thesefeatures properly.andP;  Step-by-step instructions for adding thesefeatures are given.andM;</SUMMARY><DESCRIPT>Product:   dBASE IV (Data base management system) (usage).andO;Topic:     Data BasesData IntegrityTutorialInformation Storage and RetrievalData Base Maintenance.andM;</DESCRIPT><TEXT>Keeping The Garbage OutandM;Last month we took the first steps towards building &quot;bullet-proof&quot; screens bylaying out our data entry screen in a well-organized, well-defined fashion.andO;This month we'll extend our control over the data entry process by addingfeatures to our screen that check the validity of what's being entered.andM;The problemandM;The oldest computer expression in the world is GIGO, or &quot;Garbage In, GarbageOut.&quot;andP;  If you want to have any reason-able chance for getting information outof your system, the data going in must be correct.andP;  dBASE IV provides manyways to check the validity of data going into a system and rejects entriesthat don't meet the defined standards.andP;  Most of these features are availableto beginning users through the Forms panel.andP;  If you use the featuresproperly, you can eliminate most of the common data entry problems you mightencounter.andM;I'm going to save the answer to last month's question about changing theediting order of our screen until the end of this article.andP;  The answerrequires that you go in and change the FMT file so it's no longer the childof the SCR file.andP;  Any changes made to a screen form through the Forms panelwill automatically regenerate the FMT file so the changes will be eliminatedwhen the program regenerates.andP;  That means we'll have to make themodifications after we've made changes to the screen.andM;The solutionsandM;Get into dBASE IV, open your catalog, activate the CUSTOMER database and theCUSTOMER screen form, and select MODIFY LAYOUT.andP;  You should be looking at thescreen form that we developed last month.andP;  Notice the Xs and 9s and theMM/DD/YY on the screen?andP;  These are basic dBASE template characters.andP;  Theydefine acceptable data input for the field.andM;Rather than describing all of the template characters, let's start bychanging the template for the FIRST__NAME field.andP;  We want to make sure thatthe first letter of the first name (and the middle initial) are capitalletters.andP;  Place the cursor in the FIRST__NAME field, press Alt-F for thefields menu, and select &quot;Modify field.&quot;andP;  Press Enter to change the TEMPLATEline and you should see a screen that looks like Fig.andP;  1.andP;  (You can also dothis by selecting &quot;Modify fields&quot; without having the cursor on the field.andP;  Inthat case you would be presented with a list of fields to choose from.andP;  Iprefer the first method so I know exactly what I'm changing.)andM;Notice that dBASE IV provides an explanation for each of the templatecharacters.andP;  Templates can be built with any combinations of symbols.andP;  Eachsymbol tells dBASE what's acceptable for that particular position in thefield.andP;  I replaced the first X in the template with an exclamation point (!).andO;This means that the first character (if it's alpha) should be converted toupper case.andP;  This does not preclude putting a number or some other non-alphacharacter in this position.andP;  The X template symbol accepts any character(including spaces), so the template will accept &quot;987654321&quot; as a proper name.andM;Red herringandM;You may think you've found the solution to our capital letters problem if youchanged the rest of the FIRST__NAME template characters to &quot;A&quot; so you wouldonly have alpha characters in the field.andP;  Not so.andP;  The &quot;A&quot; template symbolaccepts only alpha characters.andP;  Spaces and hyphens are not valid characters.andO;&quot;Jean-Claude&quot; and &quot;Billy Bob&quot; will not be accepted.andP;  The best we can do forthe moment is our combination of ! and X.andM;Ensuring capitalsandM;After you've made the change to both FIRST__NAME and MIDD__INIT, we'll changethe STATE field in a slightly different manner.andP;  We want to get two alphacharacters in the state field and we want them capitalized.andM;We know that we can put in non-alpha characters when we use the ! templatesymbol, so what are we going to do?andP;  First, we'll make sure that the twocharacters entered are alpha.andP;  Go to the template screen for STATE (as inFig.andP;  1) and put in &quot;AA&quot; to make sure that only alpha data is entered.andO;Instead of ending the entry, go down one row in the &quot;Modify field' menu to&quot;Picture functions,&quot; press Enter, and see what you get (Fig.andP;  2).andP;  Noticethat I've moved the menu bar to &quot;Upper-case conversion&quot; and toggled it &quot;ON&quot;using the space bar.andP;  This will convert the entire string (both alphacharacters) to upper case.andP;  Press Ctrl-End twice to get back to the designscreen.andP;  If you haven't been doing it as we go along, save the screen formnow so when you make your mistakes you won't have to go back to thebeginning.andM;Enhancing numbersandM;The next item we want to modify is the ZIP__CODE field.andP;  Although the fieldis character, we only want users to enter numbers.andP;  To do this, we change thetemplate from &quot;XXXXX&quot; to &quot;99999&quot;.andM;The telephone number is a 10-place character field.andP;  This lets the user putin the area code, prefix and phone number.andP;  My number is 2129722330.andP;  It'seasier to read this as (212) 972-2330.andP;  The template for this would read&quot;(999) NN9-9999&quot;.andP;  The &quot;NN&quot; is for those who still use the old letters suchas &quot;EMerson&quot; to start their phone numbers.andP;  Enter this template code in theHOME__PHONE field and see what happens when you strike Ctrl-Home to completethe entry.andP;  Do you remember how to move a field?andP;  (If you don't, check lastmonth's column.)andP;  Move the literal text and the field (now expanded byseveral characters) three spaces to the left.andM;Notice that the HOME__PHONE field now takes up 14 spaces instead of 10.andP;  Ifwe don't change something, the literals (the parentheses, the space, and thedash) would be stored in the field and the last four digits of the telephonenumber would be cut off.andP;  We can do one of two things.andP;  We can go back andchange the length of our field to 14 characters to accommodate the literals,or we can use the &quot;Picture function menu&quot; and turn &quot;Literals not part ofdata&quot; to ON so that the extra symbols are not stored with it.andP;  Using thepicture template and picture function, the telephone number is stored as 10digits but shown with the parenthesis, space and dash.andP;  Choose the secondoption, then do the same thing with the work telephone number.andM;Key numbersandM;We're going to change gears for a minute and talk about the next field, theCUST__ID field.andP;  This field is important because it's the link between theCUSTOMER and INVOICE files.andP;  It's necessary that the number given to a newcustomer be unique and unchangeable.andM;If you're programming with dBASE IV, the problem of unique customer numbersis a simple one to handle.andP;  You maintain a memory variable containing thelast customer number assigned and increment it by one when you need a newnumber.andP;  From within the forms panel, however, it's not so simple.andM;The easiest way to make sure there are no duplicate customer I.D.andP;  numbers isto assign the record number as the customer number.andP;  If we don't physicallyeliminate customers from our database, we ensure that the record numberremains unique.andM;The final solution for our customer numbers is shown in Fig.andP;  3.andP;  Notice thatI've left the &quot;Editing allowed&quot; option set to &quot;YES&quot; even though I don't wantto let my users edit the number.andP;  I have to say &quot;YES&quot; because if I say &quot;NO,&quot;the program will only display the data that's in the field.andP;  I can't put therecord number in the field.andM;Then how do you get the data into the record while not allowing the user toedit the information?andP;  The answer is on the next line of the menu.andP;  &quot;Permitedit if&quot; sets a condition that must evaluate to TRUE to allow editing.andO;Simply set the condition to false (.F.).andP;  Because it is false, editing is notallowed.andP;  The &quot;Default value&quot; (the one used when entering new customers) isthe character string containing the current record number (the one beingadded).andM;Handling character rangesandM;While going through this, I discovered that you can place a RANGE (smallestand largest allowed values) on a character field.andP;  The range doesn't evenhave to be numeric.andP;  It compiles and runs until you try to enter informationinto the field.andP;  Then it won't work.andP;  RANGE only works on date and numericdata types.andP;  Do not try to use it with character or logical data types eventhough it seems to work within the form designer.andM;Finally, let's look at the &quot;CUSTOMER SINCE&quot; field.andP;  Fig.andP;  4 shows the properuse of the RANGE feature.andP;  Notice that editing is allowed but if the userputs in a &quot;Customer Since&quot; date that's greater than the system date (today)the value won't be accepted and the error message (&quot;CUSTOMER SINCE must bebefore today's date&quot;) will show up on the message line.andP;  You should havenoticed one other thing when you were moving back and forth through the menusystem for this field.andP;  The &quot;Template&quot; and &quot;Picture functions&quot; options arenot available.andP;  That's because the CUST__SINCE field is a date variable andthere are no options for this type of field.andP;  If you want to see the date ina different order (&quot;DD/MM/YY&quot; for instance) you must go back and SET the DATEto FRENCH or some other setting.andM;Finishing up this month's workandM;To finish this month's work, save the form and try viewing your data bothwith the form active and inactive.andP;  You'll notice the difference in the wayit looks and how data entry acts both in Edit and Browse modes (Form andColumn).andP;  Try entering data that's incorrect and see what happens.andM;We've created an expanded screen format file that provides us with greatercontrol over the data entered into our database.andP;  There are many other thingsthat can be done to improve on our basic data edit routines, but they'll haveto wait until later, when we start writing programs.andM;As discussed last month, the result of this exercise is an FMT filecontaining dBASE program code.andP;  This code is compiled as any other programwould be.andP;  When you activate the CUSTOMER form, you are doing the same thingas when you issued the &quot;SET FORMAT TO CUSTOMER&quot; command from the dot prompt.andO;When you use the EDIT, CHANGE, APPEND, INSERT, READ or BROWSE commands withthis format active, dBASE automatically uses it to present and check the datathat the user is entering from the keyboard.andM;To look at the FMT file, escape out of the Control Center and go to the dotprompt.andP;  Type &quot;MODIFY COMMAND CUSTOMER.FMT&quot; to load the format file into theinternal program editor.andP;  What you see is the program code that makes up theformat file.andP;  If you wanted to, you could have typed the entire thing andused that as a format file.andM;Let's go down through the file.andP;  Halfway down the second screen you see thetitle &quot;@ SAY GETS Processing.&quot;andP;  This is the heart of the program.andP;  You cansee the fixed text, the GETS on each field and the PICTURE, DEFAULT, WHEN,VALID, and ERROR message modifiers in the file.andP;  These are the result of thework we did this month.andP;  The order of the GETS in the format file is theorder in which they're processed when editing a record or adding newcustomers.andP;  High-light the two lines of code concerned with our memo field(Fig.andP;  5) and move them just above the Format file exit code: you'll changethe order in which this field is processed from the middle of the stack tothe end, where it belongs and where I asked you to move it last month.andM;Next month I'll tell you how to change the logical field CHARGE so that itsays either &quot;Y&quot; for yest or &quot;N&quot; for no.andP;  Try it yourself, then we'll go overmy solution in the next &quot;dBASE IV Primer.&quot;andM;Malcolm Rubel is president of Performance Dynamics Associates, a businessapplications consulting firm located in New York City.andP;  He is the author of&quot;Programming the dBASE III PLUS User Interface&quot; (Bantam) and is currentlyfinishing up his new book &quot;dBASE IV Procedures and Functions&quot; (Bantam).andP;  Hecan be reached at (212) 972-2330.andO;</TEXT></DOC>
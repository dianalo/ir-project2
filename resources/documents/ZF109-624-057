<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF109-624-057  </DOCNO><DOCID>09 624 057.andM;</DOCID><JOURNAL>PC Magazine  Nov 27 1990 v9 n20 p433(7)* Full Text COPYRIGHT Ziff-Davis Publishing Co. 1990.andM;</JOURNAL><TITLE>From setup to scripts: automating on-line communications.andO;(tutorial)</TITLE><AUTHOR>Ayre, Rick.andO;AttFile:   PCMAG\V09N20\GET.BAT;0 Program:  GET.BAT  Batch file for MK4_UD1.XT.andO;PCMAG\V09N20\MK4_UD1.XTS;0 Program:  MK4_UD1.XTS  PC MagNet XTALK4 script.andO;PCMAG\V09N20\MK4_UD2.XTS;0 Program:  MK4_UD2.XTS  PC MagNet XTALK4 script.andO;PCMAG\V09N20\PLUS_UD1.ASP;0 Program:  PLUS_UD1.ASP  PC MagNet Procomm Plus script.andO;PCMAG\V09N20\PLUS_UD2.ASP;0 Program:  PLUS_UD2.ASP  PC MagNet Procomm Plus script.andO;PCMAG\V09N20\PROC_UD.CMD;0 Program:  PROC_UD.CMD  PC MagNet Procomm script.andO;PCMAG\V09N20\SCRIPTS.DOC;0 Program:  SCRIPTS.DOC  MagNet script information.andO;PCMAG\V09N20\WIN_UD.XWS;0 Program:  WIN_UD.XWS  PC MagNet XTALK for WIN script.andO;PCMAG\V09N20\XVI_UD1.XTS;0 Program:  XVI_UD1.XTS  PC MagNet XTALK XVI script.andO;PCMAG\V09N20\XVI_UD2.XTS;0 Program:  XVI_UD2.XTS  PC MagNet XTALK XVI script.andO;PCMAG\V09N20\XVI_UD3.XTS;0 Program:  XVI_UD3.XTS  PC MagNet XTALK XVI script.andM;</AUTHOR><SUMMARY>Many common microcomputer communications tasks can be automatedusing the scripting languages built into popular communicationspackages.andP;  Scripts let users automate routine downloading anduploading; sample scripts for two common packages, Crosstalk Mk 4and ProComm, are presented.andP;  Users must edit code in three placesto include specific information: the name or number of the dialingdirectory entry, the user ID and the user password.andP;  Each scriptmakes some assumptions; those for Crosstalk assume that the userhas the Filter option set to Control, and all assume thatCompuServe is being dialed directly.andP;  Both ProComm and CrossTalksupport keyboard macros.andP;  Technical details and complete listingsof each script are presented.andM;</SUMMARY><DESCRIPT>Topic:     Data CommunicationsInformation servicesOn-LineDownloadingCustomizationTutorial.andO;Feature:   illustrationtableprogram.andO;Caption:   Scripts for downloading files from PC MagNet. (table)Interactive script that automates ProComm for downloading files.andO;(program)Script file for CrossTalk Mk 4 that downloads up to 30 files inone call. (program)andM;</DESCRIPT><TEXT>From Setup to Scripts: Automating On-Line Communications Peter Norton, in hisforeword to Dvorak's Guide to PC Telecommunications (OS-borne/McGraw-Hill,1990), notes recent estimates that more than 18 million modems are connectedto computers around the world.andP;  Since many modems come bundled with acommunications program, you may already have the tools to take advantage of amodem if one of this vast, increasing number happens to be yours.andM;Having the tools and knowing how to use a modem, however, are two verydifferent things.andP;  Computer-to-computer communications remain a formidableobstacle for many.andP;  Your modems produce a litany of hums and beeps thatsomehow--if all goes well--result in the established &quot;handshake&quot; that permitsthe two modems to communicate.andP;  In teh meantime, you man the the PC, typingin required commands when prompted and standing by in case of error messages.andM;PCs came into being from the very need to automote.andP;  Why not use the PC'spotetial to handle most of the communications process on its own while youtend to other important tasks?andM;Let's take a look at how to set up your communications program to make thecomputers do all the work.andP;  I'll focus on three very specific, practical waysyou can take control of the process--setup, macros, and scrips--and in themeantime, change the way you think about on-line communication.andM;QUICK STARTandM;Most communications programs come with their own programming languages forscript creation.andP;  Scripts allow you to automate communication tasks on-line,including routine downloading (getting files) and uploading (sending files).andM;I've prepared several ready-made scripts that you can use to interact with PCMagNet.andP;  All of them perform a similar set of functions: you tell yourcomputer what files to download from the PC MagNet Utilities Database and thescript goes in and gets them.andP;  Figure 1 lists the scripts, along with thecommunications program for which they're intended.andP;  While we can print only afew scripts here, all are available on PC MagNet.andM;In this article, I will be referring to PROC_UD.CMD (Figure 2), which iswritten for ProComm, as well as to MK4_UD2.XTS and MK4_UD1.XTS, (Figure 3 and4, respectively) written for Crosstalk Mk.andP;  4, Version 2.andP;  The first two areinteractive and ask you for filenames when running; the third, MK4_UD1.XTS,must be run from a batch file.andP;  All scripts are distributed as text files,and each includes a complete set of instructions.andM;Before using a script, you must customize the code for your own use.andO;Generally, there are three places you must edit it to include use-specificinformation.andP;  The comments in the script indicate where you should entereither the name or number of the dialing directory entry, your user ID, andyour password.andM;Because the script languages are limited and you're required to keep thenumber of variables to a minimum, each script makes a few specificassumptions about the setup of your communications program.andP;  The Crosstalkscripts, for instance, assume that you have the Filter option set to Control(more about filters later).andP;  All of the scripts assume that you are dialingCompuServe directly, not via another network such as Tymnet or Telenet.andO;These and other assumptions are detailed in comments in the scripts.andM;The prompt-driven scripts can all be executed from the command line of yourcommunications program.andP;  If you're using ProComm or ProComm Plus, all you dois hit Alt-F5, then type the name of the script.andP;  When using Crosstalk, youcan get to the command line by hitting Esc once if you are in your DialingDirectory, or twice if you're in a setup screen.andP;  Once you're at the commandline in Crosstalk, simply typeandM;do  scriptnameandM;where scriptname is the name of the script you want to run.andM;PROGRAM SETUPandM;As an example, let's set up ProComm 2.4.3 or ProComm Plus to call PC MagNet.andO;You have to configure ProComm to work with your hardware; most of it isaccessible through ProComm's Setup menu, which you open by pressing Alt-S.andO;You may also need to change line settings, which include port settings (COM1,COM2, and so on) and the default settings for the communications port(parity, data bits, stop bits, baud, and duplex).andP;  To do this, press Alt-P.andO;For PC MagNet, set the bits-per-second rate (often called baud) to thehighest your modem is rated, usually 1,200 or 2,400,7 data bits, even parity,1 stop bit, and full duplex.andM;Icouldn't resist customizing ProComm to better suit my needs.andP;  In theTerminal Setup menu, I changed ENQ (Enquiry) to CIS-B (the default is Off).andO;In making this change, I'm telling ProComm to use the CompuServe-B protocolto automatically downloads files.andP;  If you leave ENQ set to Off, you'll haveto specify the protocol manually when you attempt download files.andM;Let's pause for a little discussion of protocols.andP;  A file transfer protocolis a set of standardized methods for exchanging files between differentcomputers.andP;  Each protocol has unique set of rules defining how files arebroken up into packets of information as well as how errors in transmissionare caught and corrected.andP;  Because the computers that host PC MagNet andProComm use the same protocol, it doesn't matter what kind of computer issending or receiving the files.andP;  The protocol does all the translationnecessary.andM;If your communications program is Crosstalk, the way to access the menu andthe menu choices themselves are slightly different, though the objectives arethe same.andP;  Once inside Crosstalk, press Alt-M to access what Crosstalk refersto as the Utility Scripts.andP;  Highlight Config and hit enter; you'll seechoices that generally parallel those in ProComm.andP;  For instance, theTelephone Prefixes option is nearly the same as Modem Setup andCommunications Port andamp; Modem Setup in Crosstalk is similar to ProComm's LineSettings.andM;Next, you need to tell your communications program who to call.andP;  You couldalways just type in the phone number every time you use the program, butremember--taking care of all those little details is among the jobs computersdo best.andP;  And if you want to use the scripts provided, the issue becomes morethan a matter of preference.andP;  All the scripts assume you have a dialingdirectory entry set up to call PC MagNet.andM;The dialing entries are a personal phone book plus information on thecommunications parameters.andP;  If you are using ProComm Plus, it's as easy asAlt-D.andP;  Once there, just move the highlight bar to the entry you want to setup.andP;  (These scripts assume it is 1.)andM;I named my entry PC MagNet.andP;  In the NUMBER field, enter your local PC MagNetaccess number.andP;  If you don't have one, you can obtain it by following theinstructions in the &quot;By Modem&quot; sidebar in the Utilities column.andP;  In thisfield you should also include any dialing prefixes that you use, such as 9,to reach an outside line.andM;Notice that the communications parameters are already displayed.andP;  They're thedefaults you selected earlier for the baud rate, parity, data bits, stopbits, and duplex.andP;  ProComm Plus' designers knew, however, that although thedefaults may suit your needs most of the time, they may not be the propersettings in all cases.andP;  They therefore allow you to select settingsspecifically for this dialing directory entry at this point.andM;To change the settings, press R (Revise).andP;  A little window pops up with alist of entry items.andP;  For PC MagNet, set parity to even, data bits to 7, stopbits to 1, and duplex to Full.andP;  If you want to use these scripts to downloadfiles from the PC MagNet Utilities Database, leave the Scripts field blank.andM;If you want to enable automatic downloading, press T and set CIS-B in theProtocol field.andP;  With this option selected, PC MagNet will send a filewithout requiring you to respecify a download protocol.andP;  Contrast that withthe usual way to download a file using ProComm Plus, where you must selectthe file on the remote computer that you want to transfer, hit PgDn, select afile transfer protocol from the menu, and then type in a filename.andP;  If youuse CIS-B automatic download, all you do is select the file you wish totransfer and the host handles the rest.andM;The Terminal setting is not critical in ProComm Plus.andP;  I've experimented withANSI, TTY, and VT102, and they all work fine with these scripts as well aswith my other PC MagNet activities, such as participating in forumdiscussions or joining a real-time conference.andP;  Terminal emulation settingsmatter little on PC MagNet, because CompuServe doesn't send any ANSI codes.andO;Many BBSs do use ANSI codes--to paint an attractive sign-on screen, forinstance--so if you connect to another on-line service, you may need to paymore attention to these settings.andP;  If you see left-pointing arrows, itgenerally means the host is sending ANSI-type codes but you're notinterpreting them.andM;That's all there is to the dialing directory in ProComm Plus.andP;  In Crosstalk,again assuming you are using Mk.andP;  4, Version 2, the only thing you have to doin order to create a new entry in your dialing directory is hit Insert.andP;  Thenvia the setup session, simply enter the same information just discussedregarding ProComm.andP;  The fields are NAME, NUMBER, SPEED, WORDFORMAT(Crosstalk's place for recording information about word size, data bits, andstop bits), TERMINAL, and PROTOCOL.andM;There are a few additional fields you may use to your advantage.andP;  The FILTERfield allows you to choose a communications filter module.andP;  Crosstalk offersfilter modules for a number of special uses, such as converting characters toupper- or lowercase.andP;  I've found that the CONTROL module, which stripscontrol characters from the communications session, works well with PCMagNet.andP;  Again, as in ProComm and ProComm Plus, the SCRIPT field must be leftblank in order to use these scripts.andM;A LITTLE TALK OF MACROSandM;Both ProComm and Crosstalk allow you to create and save keyboard macros,although Crosstalk is the more powerful of the two.andP;  I created a macro, forexample, called u (for utilities) to run my menu-driven Crosstalk script,MK4_UD2.XTS, shown in Figure 3.andP;  Then I added it to the AUTOEXEC file I use.andM;Don't confuse Crosstalk's AUTOEXEC with DOS's AUTOEXEC.BAT file.andP;  There areactually three &quot;AUTOEXEC&quot; files in Crosstalk: AUTOEXED, which loads thedialing directory interface; AUTOEXEM, which loads the Version 1.x menuinterface; and AUTOEXEX, which loads the Crosstalk XVI interface.andP;  I useAUTOEXED.XTS, so it was to this specific AUTOEXEC file that I added my macro.andO;At around line 45 of this file, you will see quite a few macro statements.andP;  Ijust added my macro to the end of the list by opening the file in astraight-ASCII editor and typingandM;macro u do MK4_UD2andM;Now, whenever I want to run that macro, all I have to do is go to theCrosstalk command line and type u to execute.andP;  I also added a macro called q,(for Qedit) to allow me to run Qedit without exiting Crosstalk (remember, ifyou use a word processor as your editor, you must be sure to save yourscripts in ASCII format).andP;  That line, right under the previous one, readsandM;macro q run nopause c:\qedit\q.exe %1andM;The only trick to loading a Crosstalk macro permanently is to make sure thatthe AUTOEXEC file you edit is loaded at runtime.andP;  For example, to ensure thatAUTOEXED is loaded, run Crosstalk.andP;  Once inside, type Alt-Y to access theUser Preferences Setup Panel.andP;  The very top field specifies your start file.andO;Mine, for instance, says AUTOEXED.XTS in that first field.andM;SCRIPTS FROM SQUARE ONEandM;For the uninitiated, scripts are actually interpreted programs that you canrun from inside your communications software.andP;  They are usually no more thana list of commands with a limited ability to store data in variables andtransfer control to different parts of the program via GOTO-type actions andloops.andP;  The communications program acts as an interpreter and executes eachline of the program.andM;As mentioned above, some things are common to all of the scripts listed inFigure 1.andP;  First, they automate the process of downloading files from PCMagNet.andP;  In addition, while you're still off-line, you can specify whichfiles you want the script to download when you go on-line--either by passingan arguent on the command line, as in MK'_UDI.XTS in Figure 4, or byresponding to prompts, as in the other two scripts presented here.andM;First, a script will check to see if the file or files you requested alreadyexist on your system by searching the DOS default directory for files withthe same name.andP;  (Crosstalk checks only the default download directory.)andP;  Ifit does find the same filenames, you're asked if you want to download themeven though you already have them.andP;  If the script does not find a match, itdials the dialing directory entry indicated in the script, logs onto PCMagNet, and downloads the files.andM;If the files you specified cannot be found on PC MagNet, the script promptsyou for an action; in most cases, it merely asks whether you want to continueand download the next file you requested.andP;  If it finds the file(s), it beginsdownloading.andP;  When the downloading process is done, the script logs off.andO;These scripts are not meant to run unattended, though you can modify them orwrite your own to do so.andP;  They are meant to get you on and off PC MagNetquickly, saving you money.andM;Let's take a look at what these scripts can do in ProComm.andP;  The scripts needsome input from you, make decisions about what to do with the input, se adialing directory to call up PC MagNet, navigate the Utilities Database, andlog off.andP;  In the process, they should trap as many user and communicationserrors as possible.andM;In ProComm you can create variables that will hold the filenames, and youhave to assign the variables the names SO to S9.andP;  The script PROC_UD.CMD,shown in Figure 2, starts by assigning the string EMPTY as variable names S1to S5.andP;  These are the variables into which I'm going to put the filenameslater, using the routine Get_Names.andP;  When I get to that point, I'll need tosee whether I've already &quot;filled&quot; that variable.andP;  If it contains the string&quot;EMPTY&quot;, I haven't; if it contains a filename, I have.andM;The first thing you see the script do is prompt you to name the files todownload.andP;  It does this with the Get_Names routine.andP;  Since thescreen-painting facilities are rather primitive, I use some extended ASCIIcharacters to make the screen look prettier.andP;  The script then waits for youto type in a filename.andP;  Get_Names waits for input, makes sure you didn't justhit Enter, and then checks to make sure the file doesn't already exist in theDOS default directory.andM;If the file isn't already present, Get_Names uses GOTO to jump to the routineFile_Names, which places the filenames in the variables.andP;  Using the ProCommASSIGN construct, the procedure just assigns the filename to the nextavailable variable until all the variables have filenames, or until youchoose to stop.andP;  If &quot;EMPTY&quot; variables remain, the procedure asks, &quot;DownloadAnother?&quot;andP;  If you answer yes, it prompts for the filename; if not, itproceeds to log-on to CIS, moves to the PC MagNet Utilities Database anddownloads the requested files.andM;The small procedure named What_Now, which appears in the listings just beforeLog_On, asks you what to do if the prompt for a filename is answered with acarriage return.andP;  You are prompted &quot;End This Script?andP;  (Y/N):&quot;, to which a ywill force a GOT Get_Off (ending the script), and an n will return you toGet_Names.andM;The IF NOT LINKED clause in the Log_On routine just checks to make sureyou're not already on-line.andP;  DIAL tells ProComm to dial the appropriatedialing directory entry.andP;  Most of the rest is a conversation between yourcomputer and the computer hosting PC MagNet.andP;  If you have logged on before,it should look familiar.andM;The first time you run the script, be sure to verify that you are using thecorrect dialing directory entry.andP;  Watch your screen as ProComm connects tothe remote computer for the message &quot;Connected to PC MagNet,&quot; assuming younamed your entry as I did.andM;I use one trick to move the script along as fast as possible.andP;  Theconversation between your computer and the PC MagNet host is managed by twoscript constructs.andP;  The WAITFOR statement waits to receive a string while theTRANSMIT statement sends a string, as soon as a carriage return, in the formof either an ! or a M, is detected.andP;  All you have to do is place the stringyou want to WAITFOR or TRANSMIT inside quotes.andM;I take advantage of two CompuServe traits that affect these exchanges.andO;First, you can force PC MagNet to get to the point by sending a Ctrl-C, andsecond, you can type ahead, in most cases.andP;  A good example of how to exploitthese traits is displayed right after you log on to PC MagNet.andP;  MagNet listsa whole menu of options to choose from.andP;  One of them, near the top of thelist, is &quot;What's New .andP;  .  .  .&quot;.  Instead of waiting for the whole list toscroll by, I only WAITFOR &quot;New&quot;, and on finding it, interrupt the processwith a Ctrl-C.andP;  The script then sends a character string with theinstructions that PC MagNet will execute as soon as it reaches the nextinstruction.andM;THe only procedure of note is the Get_File procedure, which does just that(one file at a time) by sending the filenames from the five variablesassigned to them earlier with the Get_Names routine.andP;  Give_File_Name worksthe way the assignment routine does, only backwards.andM;The short routines found at the end of the script perform a little cleanup.andO;The Error procedure, for instance, asks what to do if the file you requestcan't be located.andP;  When you ask to download a file by name and type in avalid filename, a brief description of the file is displayed so that you canbe sure you're downloading the file you want.andM;In each file description is the character string &quot;Utility tape:&quot;.andP;  The scriptwaits to see if that string appears.andP;  If it does, the script proceeds todownload the file.andP;  If the string doesn't appear, the Error routine iscalled.andP;  The ERROR procedure asks: &quot;Can't Find That File, Continue with Next?andO;(Y/N),&quot; to which a Y will cause a return to Give_File_Name and N will jump toGet_Off.andP;  The last two routines are Get_Off of PC MagNet and Get_Out of thescript.andP;  There's nothing fancy here.andM;TIME FOR A LITTLE CROSSTALKandM;The Crosstalk scripts are a different matter.andP;  Crosstalk Mk.4 has a scriptLanguage), CASL (Crosstalk Application Script Language), that's moreversatile than the scripting languages in ProComm.andP;  For one thing, CASL iscompiled.andP;  Crosstalk will compile scripts (translate them into binary,machine-readable form) for you the first time you run them.andP;  After that, theprogram will run the compiled version.andM;A compiled program's main advantage over the interpreted programs discussedearlier is that it can execute considerably faster.andP;  Note that the compiledscripts have the file extension.andP;  XTC, while the pre-compiled script filesmay have any file extension.andP;  (XTS is strongly recommended.)andP;  Note also that,unlike most compilers, Crosstalk does not create scripts that are standaloneexecutable files; it creates files that can only be executed from withinCrosstalk.andM;I'll present two scripts here to show CASL off.andP;  The first, MK4_UD1.XTS,parses the command line for the names of the files to download.andP;  The second,MK4_UD2.XTS, prompts you for filenames using Crosstalk's powerful FORMprocedures.andP;  Note that anything after -- in the scripts is a comment.andP;  I'veused /* to start and */ to stop some multiline comments.andM;MK4_UD1.XTS is meant to be invoked with a batch file.andP;  The following is theone I use:andM;xtalk do MK4_UDI %1 %2 %3 %4 %5 %6 %7 %8 %9andM;I call it GET.BAT.andP;  It's included with the scripts when you download themfrom PC MagNet, but as you can see, there's nothing complicated about it.andO;All GET.BAT does is run Crosstalk, execute the script usingandM;do MK4_UD1andM;and pass the script as many as nine variables from the command line.andP;  I putGET.BAT into my Crosstalk directory so that when I type.andM;GET file file fileandM;I can sit back and watch Crosstalk retrieve the files I've specified.andP;  Ofcourse, while DOS batch files may be limited in the number of parameters theycan pass, my scripts are not similarly limited in the command-line variablesthey can parse.andP;  The script has a 30-variable limit, so you could use thefollowing approach:andM;SET cm= :loop IF '%'=='' GOTO endloop SET cm=%cm% %1 SHIFT GOTO loop :endloopXTALK DOMK4_UD1 %cm% GET cm=andM;This batch file creates a huge command line by tacking each argument onto it.andO;Make this GET.BAT instead and you can get as many as 30 files in onetelephone call.andM;You can tell from the first few lines of the source code in MK4_UDI.XTS thatCrosstalk's CASL is more powerful, offering features that can't be found inProComm.andP;  Look right at the beginning of the script in the lines:andM;n=1 i=0 string my_file, choice, dFile[30]andM;I declare integer and string variables.andP;  One of the strings, dFile, is evenan array of 30 character strings.andP;  That means, for instance, that in the nextfew lines of code, in one WHILE..WEND loop, I can parse the command line,check to make sure the file isn't already in the default directory (or presetdownload directory, if specified), and load the filename into dFile array.andM;Notice that, unlike the ProComm scripts, you aren't given the choice ofdownloading the file anyway.andP;  That's because Crosstalk implements CIS-Bslightly different from ProComm.andP;  Crosstalk will not replace an old file witha new file of the same name.andM;It also means the little REPEAT..UNTIL loop in the call_pcmagnet procedure isall that I need to get the filenames from the array to the variable my_filefor download.andP;  Note that the label call_pcmagnet is not necessary.andP;  Itreceives program control just by being the next in line.andP;  The procedure isnever actually called.andM;The second Crosstalk script, MK4_UD2.XTS, using the Crosstalk FORM function,creates a window and propmts you with &quot;Filename from PC Magnet:&quot; for input.andO;The form accept statement grabs the input, which is again checked fororiginality, and then loads it into an array.andP;  The color selections arearbitrary; you can pick your own.andM;The rest of the two Crosstalk scripts are similar to the ProComm scriptsalready discussed--two computers talking to each other.andP;  The only trick is toget them in sync.andP;  In Crosstalk, the REPLY statement sends the string inquotes to PC Magnet, while the WAIT FOR statement filters input for thedesignated characters.andP;  Throw in a little error checking and you haveyourself a finished script.andM;The error checking I include is the WATCH FOR construct in the labelget_file.andP;  While the WAIT command waits for a string or a keystroke, theWATCH command waits for one of several strings and performs the commands inthe statement group of the string received.andP;  It's a conditional WAIT.andP;  Thescript waits to see a character string, in this case the prompt to downloadthe requested file, that it knows will result only if the filename was valid;otherwise,it jumps to the procedure no_file.andP;  You are alerted with the &quot;FileNot Found!&quot; message and then asked if the script should resume its task with&quot;Continue with others?andP;  (Y/N)&quot;andM;All of the scripts are documented, which will allow you not only to betterunderstand the scripts' functions but also to familiarize yourself with theterms and procedures commonly used in script languages.andP;  Armed with thisinformation, you can create your own scripts for logging on to PC Magnet andother services for variety of automated tasks.andM;Rick Ayre works for the Department of Veterans Affairs Medical Center inPittsburgh and is a Sysop for PC Magnet (72241, 215).andO;</TEXT></DOC>
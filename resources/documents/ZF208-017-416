<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO>  ZF208-017-416  </DOCNO><DOCID>08 017 416.andM;</DOCID><JOURNAL>EXE  Nov 1989 v4 n6 p43(3)* Full Text COPYRIGHT Process Communications Ltd. (England) 1989.andM;</JOURNAL><TITLE>Data and software security. (preventing theft of data fromdevelopment computers)</TITLE><AUTHOR>Schifreen, Robert.andM;</AUTHOR><SUMMARY>Software piracy is a serious problem because most programs can becopied easily with no loss of quality.andP;  Programmers concerned withpreventing software theft should consider both the security of thedevelopment environment and the possibility of taking active stepsto prevent illegal copying of programs by end users.andP;  Adevelopment machine contains source code and other valuableinformation that is easily stolen by anyone with a floppy disk.andO;Both hardware- and software-based protection utilities areavailable to control access to files via passwords or encryption.andO;Prevention of illegal software copying begins with warnings onpackaging and can include such techniques as passwords that canonly be found in menus, looking for unique markers in computers,'dongle' programs, and archiving.andM;</SUMMARY><DESCRIPT>Topic:     Access ControlsSoftware ProtectionSoftware PiracyData Security.andM;</DESCRIPT><TEXT>Data and Software Security Software, like records and tapes, is all too easyto copy.andP;  Copied software is better than copied records and tapes because, nomatter how many times you copy a floppy disk, you never get nay hiss or lossof quality.andM;As a soft developer, there are two major security headaches that you reallyneed to think about.andP;  First, the security of your development environment,and of the trade secrets and ideas that may exist in your source code, oryour office in general.andP;  Second, you need to consider whether you need totake active steps to prevent illegal copying of your applications once theyhave been launched and are generally available.andP;  This article looks at someways of implementing both of these types of security, and suggests somemethods and products that you may like to look at.andM;Development MachinesandM;A PC that you use for software development is worth an infinite amount morethan you paid for it.andP;  Assuming that you are well organised, and keepeverything in document files on the hard disk rather than on scraps of paperin filing cabinets, your development machine will contain source code, ideasfor future releases, costings, market forecasts and everything elseconcerning the current development project.andP;  The majority of developmentmachines that I have come across have absolutely no protection whatsoever.andO;It would be all too easy for someone to walk in with a highdensity floppydisk and, within half a minute, copy a couple of years' work from your sourcecode directory and walk away with it.andM;I encountered the most amusing way of stealing data a few years ago, when Iworked with BBC micros.andP;  Most applications for the Beeb came on plug-in ROMs,which mapped into the machine's address space.andP;  A friend of mine constructeda crude arcade game, which he put on a disk.andP;  At computer shows, he wouldwander up to one of the stands and ask if he could try his game on theirmachine.andP;  As the game went through its actions, some extra code sucked thecontents of all the machine's ROMs onto the disk, which he then carried offto examine at home.andM;ProtectionandM;The first step in protecting a machine is to be able to see what's actuallygoing on at the command line.andP;  At the very least, you should have a utilitypermanently installed in your machine that logs all DOS commands, plus thetime and date they were typed, and records the information in a file.andP;  Thiswill tell you if someone's using your machine in your absence, even if itcan't identify the culprit.andM;For more sophisticated protection, it's worth installing a specialistprotection utility.andP;  These are either implemented purely in software, or havea hardware component as well.andP;  The software versions sit in your AUTOEXEC.BATfile.andP;  When you boot from the hard disk, the utility asks for a password.andP;  Ifyou supply a valid password, you are allowed to use the machine, and aregiven access to the programs or directories specified by the person whoinstalled the system and set up he password file.andP;  Of course, the easiest wayto break past such a protection system is to boot from a floppy disk toprevent the security shell from starting.andP;  To prevent this, the securityprograms normally scramble something in the hard disk partition table, sothat only the security shell itself is readable.andP;  When the shell starts, itunscrambles the partition table to allow access to the hard disk.andP;  If youboot from a floppy, the partition table never gets unscrambled, so you willget &quot;invalid drive specification&quot; errors from DOS when you try to log on tothe hard disk.andM;Of course, any security method implemented purely in software can be brokenby software.andP;  Protec, for example, from International Data Security Ltd, isone of the most popular protection systems but is also one of the mostinsecure.andP;  It traps attempts at disk I/O by sitting on Int 21h and watchingfor DOS to attempt to read the disk.andP;  The system does not appear to sit onInt 13h, the BIOS disk interrupt, so any program that reads disks this waywill be able to read the disk regardless of whether Protec is installed.andP;  Ifyou'd rather boot from a floppy, a utility like the Norton Disk Doctor easilyrealises that Protec has deliberately scrambled you partition table, andpolitely restores it for you at the touch of a key.andP;  At a recent securityconference, a combination of Disk Doctor and an Int 13h-based file readerallowed me to break into a Protec-guarded PC in just a couple of minutes andlook at any sector on the disk.andP;  Ironically, the rep from International DataSecurity used an int 13h call to find out what I'd done, so IDS are certainlyaware of the problems with their product.andM;Not all software-based security systems are so immediately penetrable,however.andP;  At the same seminar, I was given a copy of Clam, from Kew-basedMicroft Technology Ltd, to break into.andP;  Clam works in a similar way toProtec, but traps Int 13h too so that avenue of penetration is immediatelyclosed.andP;  Clam also encrypts data as it writes it to disk, and decrypts it asit is read.andP;  All this is transparent to the application that requested thedata, so there are no problems.andP;  The encryption algorithm involves the user'spassword so, unless you have the correct password, the encrypted data on thedisk is of no use.andP;  On the system I was shown, I located an un-encryptedversion of a text file that had been erased.andP;  I unerased the file, andcompared it to the encrypted version.andP;  Even with both versions side by side,the algorithm was not obvious and i eventually agreed that Clam was prettysecure.andM;Surprisingly, one of the easiest challenges of the day was posed by Apricot.andO;The Qi machine has an actual lock on the back of the case.andP;  Also, the systemI was shown was configured in such a way that I was asked for a password assoon as the machine was turned on, irrespective of which drive it was bootedfrom.andP;  Further, once the password was entered, I was required to press abutton on a remote-control unit called a Qi card, which would send anotherpassword to the machine.andP;  For the test, I was not given the key for the backof the machine, a password or a Qi card, yet it took just a few minutes forthe machine to reveal its secrets.andP;  A small screwdriver was all that wasrequired to prise off the case from the front, bypassing the lock.andP;  The harddisk was removed from its connector and installed inside a different machine,and the rest was easy.andP;  Apricot are 'aware' of the problem, and say that thenext version of their hard disk BIOS will dynamically encrypt data beforestoring it.andM;For a really secure PC, the new DataSafe 286 from Opus appears a fairly safesystem.andP;  It's been designed from scratch for use in a highly secureenvironment.andP;  Even the screws that secure the case have non standard heads,and can't easily be opened.andP;  The security software is built into the BIOS andinstalled in the rest of the system.andP;  Users can be assigned passwords, andthese passwords can restrict access to any part of the machine.andP;  Even theserial port can be disabled at hardware level, to prevent data being sentfrom the back of the machine using only OUT commands to write direct to theport.andP;  Data on the hard disk is not only encrypted, but a non-DOS format isused.andP;  This makes it secure, but it also means that you can't recover lostfiles with Norton and such like.andM;Having used the machine briefly, I can't see any way of breaking thesecurity, except by stealing a copy of someone's backup disks, which areeasily readable.andP;  As always, though, people themselves are the weakest linkin a security system.andP;  At the recent PC show, Opus issued a challenge tovisitors, to break into a DataSafe system.andP;  At the end of the first day, onejournalist sneaked back into the exhibition hall and swapped the &quot;hack thisand win a Metro&quot; machine with one of the other demo machines.andP;  Next morning,said journalist appeared on the Opus stand, pointed to what used to be a demomachine and asked to be shown round it.andP;  The attendant on the stand thenunknowingly showed him around the secure machine.andP;  History does not relatewhether he was awarded the prize.andM;Other hardware-oriented security systems for PCs include Lektor, from BritishTelecom, and Portcullis, from Kingsbury-based Loadplan.andP;  These two productscomprise a card that plugs into the PC, and require a physical token (pluspassword) to gain access to the machine.andP;  In the case of Portcullis(manufactured by Micronyx but sold by Loadplan in the UK), the data on thehard disk is encrypted and tied to the particular PC and Portcullis card byspecial algorithms.andM;Copy ProtectionandM;Once you have written software, and distributed it, you need to think abouthow to prevent it being illegally copied.andP;  A well-written licence agreementis the first line of defence.andP;  Make it clear, before the customer uses thepackage, that he is not allowed to make copies, or use the program on morethan one machine at a time.andP;  John Mawhood went into great detail on thesubject in September 1989's issue, and a sample licence agreement prepared byJohn is available free of charge by sending a large, appropriately marked SAEto the .EXE offices.andM;Other MethodsandM;Before you install any form of copy protection in your software, stop andthink.andP;  Assess the risks, and ask if you really need protection at all.andO;Users hate protected software, and anyone who has actually lost data from ahard disk because of it will hate it even more.andP;  Also, it's only thelegitimate purchasers that have the inconvenience of having uncopyablesoftware -- those who manage to get pirated copies usually end up withversions that have had the protection removed.andM;If you feel that the type of product you are selling, and the market intowhich it is being sold, demand that the software be protected, there are anumber of options.andP;  The easiest way to deter the pirates is to have theinstallation program ask for the user's name, company and address.andP;  Havingdone this, the installation program patches the personal details into thesoftware, and then deletes itself to prevent the details being changed.andP;  Thesoftware is not actually protected against copying, but few people will wishto use programs whose sign-on screen flashes up someone else's name andcompany.andP;  To prevent patching of the details with DEBUG, a simple method canbe used to hide the text--just flipping every other bit, for example, will dothe trick.andM;Having embedded messages is especially important if you're developingsoftware for use only inside your company, and not for commercial sale.andO;Ensure that the title screen makes it clear that the program is for internaluse only, and put serial numbers on all disks.andP;  Make it clear that anyonewhose numbered program appears outside the company is liable to hanging,flogging, instant dismissal etc.andP;  Unsurprisingly, some of the most usefulutility programs that I have seen have &quot;IBM Internal Use Only&quot; displayed whenyou start them up.andP;  While the software may be excellent, their securityprocedures are certainly not.andM;Doing It YourselfandM;If you want to add some real form of copy protection, there are a couple ofways you can do it yourself.andP;  One way is to have the program ask, each timeit is used, for the user to &quot;please type in the 4th word from page 72 of themanual&quot;.andP;  This means that the pirate also needs a manual, which immediatelyprevents your work from being circulated on bulletin boards.andP;  If you're goingin for this kind of protection, though, don't use a simple DOS get-stringcall to read the word from the manual, as a hacker can find and remove thecall in half a minute.andP;  Either write your own routine to read the keyboard,or use self-modifying code so that nowhere in the program does theinstruction Int 21h actually appear.andP;  Make it Int 91h, or something, and havea piece of code at the start of the program patch the 91 into a 21.andP;  On thesubject of manuals, the trend nowadays is away from printed documentation andtowards online help screens.andP;  FoxPro, for example, has some 550K of help textincluded in the application, which means that it's possible to use the wholepackage without reading any manuals.andP;  While this is good news for legitimateusers, it does make it far easier for the software to be copied.andP;  There islittle that can be done to ease this situation.andM;Protection can also be achieved by looking for a unique marker in a PC, andrefusing to run the software if the marker is not found.andP;  For example, readeach sector of a hard disk with Int 25h, and trap all errors.andP;  This lets youbuild up a picture of the drive's bad track table, and you can embed a copyof this table in the software at installation time.andP;  If this table doesn'tmatch the disk characteristics at run time, assume that a pirate is about.andO;This is roughly the principle that is used by Copy Control, a new copyprotection system recently announced by Microcosm (0272 441230).andP;  The systembuilds a picture of a hard or floppy disk, and uses the picture to lock theprotection to a particular disk.andP;  Even if you know exactly how the methodworks, says Microcosm, you couldn't crack it, because of the minute defectsin the disk surface that the program manages to find.andP;  Copy Control is 319pound sterling per copy, and that allows you to protect any number offloppies.andP;  You don't even need the source code of the program you'reprotecting, either.andM;A number of protection systems rely on using the BIOS to format non-standardtracks and sectors.andP;  Put a signature in a non-standard track, and have yourprogram refuse to run if the track is not there.andP;  COPY and DISKCOPY can'tunderstand non-standard tracks, so the disk is not easily copyable.andP;  Rememberthat there are programs that are less fussy than COPY and DISKCOPY, whichwill make duplicates of many protected disks, and that these programs areoften freely available on bulletin boards.andP;  The legal position with respectto the new Copyright, Design and Patents Act is untested, though it may wellbe that such utilities are now illegal.andM;DonglesandM;We reviewed half a dozen dongles in September 1988's issue.andP;  These devicesmake software pretty secure, but add around 20 pound sterling to the realcost of producing a copy of a program.andP;  Assuming that no one discovers thepart of your code that actually calls and interrogates the dongle, yourprogram is safe.andP;  Many dongle manuals give advice on how you should disguisethe call, and on how many calls you should make.andP;  It's worth reading thisadvice very carefully, as you don't want to spend money on dongles, only tofind that a quick POKE to the file can render the protection useless.andM;ArchivingandM;While we're talking of security and protection, archiving programs shouldreally be mentioned.andP;  An archive program compresses a number of files intoone, which makes for easier distribution.andP;  Along the way, compressionalgorithms normally result in a typical .EXE file shrinking to around 50% ofits original size.andP;  A.DBF file will reduce to around 20% of its size, becauseof all the blank spaces.andP;  A matching un-archive program restores the files totheir correct name and size ready for when you want to use them.andP;  Archivedfiles are cheaper to distribute, because less disks are involved.andP;  They'reharder for pirates to patch, too.andP;  The most common archive program is calledPKZIP (and its companion, PKUNZIP).andP;  The PK is Phil Katz, who designed andwrote the utilities.andP;  The programs are shareware, so you can get hold of themfrom any bulletin board.andP;  Registration (money that you send to the author ifyou like the programs) is just $25.andP;  If you download the programs from aUS-based bulletin board, you get an added encryption feature, which willencrypt files to DES standard before adding them to the archive.andP;  Current USlaw requires all sorts of licences before DES programs can be exported (eventhough the algorithms are widely published).andO;</TEXT></DOC>
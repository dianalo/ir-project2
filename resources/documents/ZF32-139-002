<?xml version='1.0' encoding='UTF-8'?>
<DOC><DOCNO> ZF32-139-002 </DOCNO><DOCID>10 888 652</DOCID><JOURNAL>DBMS  June 1991 v4 n7 p60(4)* Full Text COPYRIGHT Mandamp;T Publishing 1991.andM;</JOURNAL><TITLE>Linking spreadsheets with databases; how the Windows DDE linksspreadsheets to databases, and a look at how SQLVision makes thelink. (Dynamic Data Exchange)</TITLE><AUTHOR>Schatzman, Bruce.andM;</AUTHOR><SUMMARY>Microsoft Windows' Dynamic Data Exchange (DDE) provides a solutionfor the problem of information sharing between spreadsheet anddatabase applications.andP;  DDE uses a messaging and shared memorysystem for inter-application communication.andP;  Vendors are offeringproducts that let users link databases and spreadsheets to allowfor database information to be imported into a spreadsheet's rowsand columns.andP;  Henley Business Software's SQLVision uses DDEprotocol in connecting Lotus 1-2-3 and Microsoft Excelspreadsheets with the SQLBase structured query language (SQL)server from Gupta, providing a spreadsheet-based front end toSQLBase databases.andP;  SQLVision lets spreadsheet users create macrosthat carry out data analysis and generate reports using SQLBasedata.andP;  Vendors are likely to use DDE in their marketing strategiesin linking to certain applications but deliberately excludingothers.andM;</SUMMARY><DESCRIPT>Product:   Microsoft Windows (Graphical user interface) (Usage)SQLVision (Search software) (Usage)Microsoft Excel (Spreadsheet software) (Usage)SQLBase (Data base management system) (Usage)Lotus 1-2-3 (Spreadsheet software) (Usage).andO;Topic:     SpreadsheetsData Base Management SystemsMacrosStructured Query LanguageInteroperabilityMarketing Strategy.andO;Feature:   illustrationtablechart.andO;Caption:   DDE message descriptions. (table)DDE DATA message format. (chart)DDE messages coordinate transfer of data through shared memory.andO;(chart)andM;</DESCRIPT><TEXT>How the Windows DDE links spreadsheets to databases., and a look at howSQLVIsion makes the link.andM;As many PC users can testify, sharing information between spreadsheet anddatabase applications has always presented something of a challenge.andP;  Withinthe Windows environment, Microsoft's Dynamic Data Exchange (DDE) provides asolution.andM;Consider the situation where information from several different Lotus 1-2-3spreadsheets must be imported into Xbase as records.andP;  From within 1-2-3, eachworksheet must be manually dumped to disk in a file format that can beimported by the Xbase application.andP;  Because different versions of Xbasesupport different file import formats, you must be sure to select the rightone for your dialect.andP;  Next, You must launch the Xbase application and importeach of the spreadsheet files as a record.andM;If you alter this newly imported information within your databaseapplication, you'll have to import it back into 1-2-3 using the same tedious&quot;export and read&quot; technique in reverse.andP;  If this is done frequently, you mayneed to assign someone to coordinate these activities on a regular basis.andM;Clearly, automating this kind of interapplication exchange would make workingwith data less of a logistics exercise.andP;  In the case of Lotus 1-2-3 andXbase, what's needed is a software &quot;connection&quot; so that, when informationwithin either a spreadsheet or database is changed, the correspondinginformation in the other application is dynamically updated.andP;  This is justthe facility that Windows' DDE provides.andM;What is DDE?andM;Microsoft's Windows environment is the result of a well-defined softwarearchitecture.andP;  In order to run as a Windows application, a program must beable to work within this architecture, which is somewhat like a piece fittingin a jigsaw puzzle.andP;  Factors such as user interface guidelines, memorymanagement schemes, and message passing must be incorporated into everyWindows program.andM;DDE is simply one element of the Windows software architecture.andP;  It wasdesigned for the purpose of inter-application communication.andP;  To communicatewith other PC programs, Windows applications must follow a well-defined andwell-documented standard for exchanging information.andP;  In other words,regardless of how different these programs may be, they must all speak thesame language.&quot; Much as TCP/IP and XNS became standards for the exchange ofinformation across a network, DDE acts as a communications protocol by whichapplications send each other information.andP;  In fact, developers will noticethat DDE's programming paradigm is similar to that used for building networksolutions.andM;DDE is not, as some believe, a self-contained program that somehow connectstwo applications together.andP;  For an application to support DDE communication,software vendors must implement features that conform to DDE specifications.andO;For example, if numerical data in a word processing program is to be updatedautomatically when a spreadsheet is changed, developers must incorporate menufunctions that let users designate which values in the document aredynamically linked with cells in the spreadsheet.andP;  Thus, like TCP/IP and XNS,DDE is a lower-level mechanism, on top of which application-levelfunctionality must be builtandM;How Does DDE Work?andM;Like the Macintosh, Windows is a message-based environment.andP;  Many of theactions to be performed within the environment are achieved by sendingmessages back and forth.andP;  For example, messages are used to handle mouseevents, to manipulate dialog boxes, and to change the color palette.andO;Messages can be strings or bits.andP;  Each message is identified by a uniquename, while the layout of the bits can be used to convey special information.andO;A small subset of the Windows message set is specific to DDE, and is used byapplications to communicate with each other.andM;Any application that initiates a DDE action is called a client, while theapplication that responds is known as a server.andP;  (Note the use of networkingterminology.) ne overall session during which data and messages are exchangedis referred to as a conversation.andM;To start a conversation, the client application will send an INITIATE messageto the server.andP;  In most cases, the server will respond with an ACK(acknowledge) message to indicate that it is ready to communicate.andP;  Thisinitial exchange opens the pipeline&quot; of communication, after which a varietyof messages can be sent back and forth.andP;  There are a total of nine DDEmessage types, as described in Table 1.andM;Although messaging is the key to DDE, it defines only how applicationscoordinate an exchange of data.andP;  The data itself is not contained withinmessages but is transferred through a scheme known as shared memory.andP;  Sharedmemory is simply a block of RAM that can be accessed by two or morecommunicating applications.andP;  It is in this block of memory that the actualdata to be transferred is stored and retrieved, somewhat like a mailbox.andO;Each DDE message has a specific format and a content that is defined by theDDE protocol specification (see Figure 1).andP;  The DATA message, for example,contains two parts: a pointer (or handle) to the location in shared memorywhere the data to be exchanged will be placed, and an identifier regardingthe data item that is available.andP;  Each message is placed in a Windows&quot;packet&quot; that contains a window ID for both the sending and receivingapplication.andP;  This packet is either broadcast to all active Windowsapplications or sent directly to a specific application window.andM;In order to retrieve data that has been placed in shared memory, the receiverof the DATA message (in this case, the client) cooperates with Windows systemsoftware to access the exact location in shared memory in which the sender(server) has stored the data item  Figure 2), and the exchange is thuscompleted.andP;  Not all DDE transactions involve the exchange of data throughshared memory.andP;  ACK, INITIATE, and UNADVISE, for example, are simple messageswith no attached data.andM;Using the above messaging and shared memory system, a variety of usefulfunctions can be implemented, each of which establish a different type ofrelationship between two applications.andP;  Here are three of the interestingfeatures currently being developed by vendors.andM;One-time data transfer.andP;  In a onetime transfer, two applications establishcommunications for the purpose of exchanging a single, predefined set ofdata.andP;  For example, one application can send another a graphics image, thevalues given in a spreadsheet, or another well-defined dataset.andP;  Once thedata has been transferred  through shared memory) the link is closed terminated), and the shared memory is released back to Windows.andM;Permanent data link Also known as a &quot;hot-link,&quot; this mode of communicationenables the client to establish an ongoing real-time conversation with aserver application.andP;  Perhaps the most interesting feature that can beimplemented with DDE, this allows a high level of transparent integrationbetween two applications.andP;  For example, as data is updated in a SQL database,the corresponding numbers in a spreadsheet table are dynamically modified.andO;What this means to the user is that information becomes &quot;common' acrossapplications, relieving users from the burden of updating every instance ofthat information in multiple applications.andM;Another version of the permanent data link is the  warm fink,&quot; in which theclient is advised of any changes to a specified data item, but that data isnot sent to the client unless explicitly requested.andM;Remote command execution.andP;  There is frequently the need for one applicationto request that another application execute one of its commands.andP;  Forexample, an accounting package may automatically request that a databaseprogram print a report.andP;  Remote command execution reduces the need to switchto a new application in order to perform just one or two functions.andP;  Usersmay eventually be able to specify a whole string of remote events that happenwhen just a single command is executed within one application.andP;  The impact ofthis is far-reaching and will make PCs much more powerful.andM;Working with DDE on Three Levels There are really three ways to interact withDDE, depending on whether you are an average user, a  power&quot; user, or adeveloper.andP;  The average PC user will utilize new commands on their pull-downmenus such as  Link To...' and &quot;Remote Execute...,' enabling them toestablish hot links, remote command features, and other connections betweenapplications.andP;  The DDE mechanism itself will remain completely hidden - onlythe functionality provided will be of interest.andM;Sophisticated users have a broader range of options, and can implement theirown DDE finks with popular application macro languages like those found inExcel and Lotus 1-2-3.andP;  These spreadsheets have already been extended withcommands that support the DDE protocol, and inter-application links can beachieved with surprising ease.andP;  There is no need to understand Windowsprogramming or the DDE protocol itself.andM;Although these macro-based links are a quick and reliable solution for manyapplications, the implementation of DDE connections between programs that donot support high level languages must be done by developers using C, C++, andother low-level languages.andP;  Unlike the use of simple macro languages, thisrequires in-depth knowledge of the Windows programming environment and theDDE protocol.andP;  Developers are already doing serious work with DDE and manynew interapplication capabilities will begin to appear over the next 12-18months.andM;DDE: Excel to a SOL DBMSandM;Spreadsheets are excellent for quick and easy manipulation of character andnumeric arrays in a flat-file format.andP;  Databases satisfy the need forrelational operations among larger sets of data, and are better fordeveloping more robust, full-featured applications.andM;These two applications are therefore complementary, with the weakness of onethe other.andP;  Users have long desired a  means for lining the two togetherallowing database information to be  downloaded&quot; into the rows and columns ofa spreadsheet.andP;  This would enable quick &quot;what-if' types of analyses ondatabase data without the need to invest time and money in custom databaseapplications.andM;This capability exists today, and vendors are already offering productssatisfy this user demand.andP;  On product is SQLVision from Henley BusinessSoftware, based in Great Britain.andP;  SQLVision uses Microsoft's DDE protocol toconnect both Microsoft Excel and Lotus 1-2-3 spreadsheets with Gupta'sSQLBase SQL server.andP;  The combination provides a powerful spreadsheet-basedfront end to SQI, Base databases.andM;With SQLVision, spreadsheet users can build macros that perform data analysisand produce reports using SQLBase data that is either local or across anetwork.andP;  listing 1 is a sample of code for a simple Excel macro that opens aDDE link with a SQLBase database and retrieves some data.andM;Some of these macro commands, including =REQUEST, may not be familiar to manyExcel users or database programmers, but they are part of Excel's macrolanguage, and are documented in the manuals.andP;  These commands are the macrouser's high-level interface into DDE, and enable sophisticated applicationintegration without the pain of low-level programming.andP;  SQLVision interceptsDDE messages, re-formats them as SQLBase queries, and sends them to thedatabase engine for processing.andP;  SQLVision is thus a  backstage&quot;communications facilitator and is not used directly by the user.andP;  SQIBaseitself does not currently support DDE communications, but you can expect tosee many database programs support these capabilities directly in the nearfuture.)andM;In the sample macro shown in Listing 1, the first command loads the SQLVisionprogram into RAM.andP;  The second and third fines open and activate an Excelworksheet called REPORTS.XLS in which the database information will beplaced.andP;  The fourth line sets up a DDE channel that will be associated withthe REPORT.XLS spreadsheet.andP;  The channel number is stored in the variableCHAN, and will be used again for subsequent communications.andP;  At this point, abidirectional connection now exists between the database and the spreadsheet.andO;The fifth fine opens a DDE connection to the database called ACCOUNTS usingthe channel specified in the previous step.andM;In the next step, a modified SQL statement is used to select the threecolumns DATE, HOURS_BILLED, and EXPENSES frOM the database, and identifiesthe spreadsheet cells in which the information is to be put (in this casecolumns one, two, and three, starting with row 10).andP;  Some selection criteriaare then given with the SQL WHERE and AND clauses.andP;  The DBMS processes theselect string and sends the needed information, whereby SQLVision puts itinto the specified place in the spreadsheet.andP;  The connection with thedatabase is terminated and the user is ready to manipulate the informationmanually or with additional macros.andM;Perhaps the most striking aspect of this example is its simplicity.andP;  justseven lines of macro commands create a connection to a database and retrievesdata directly into your spreadsheet.andP;  Much more sophisticated applicationscan be built, even some that are fairly easy to implement.andP;  For instance,several DDE channels can be open at once, and information can be sent fromdifferent databases into multiple spreadsheets.andP;  This data can be processedby spreadsheet macros and written back into the database as updated recordswith the POKE macro command.andP;  Virtually all functions you would normallyperform on a SQLBase database (including record insertion, data rollback, andother standard features) can be accomplished through Excel macros, allowingthe quick construction of complete database user interfaces.andM;Other Spreadsheets, Databases SQLVision is one of several products on themarket that handle database and spreadsheet integration.andP;  Q+E from PioneerSoftware lets you integrate Excel and Lotus 1-2-3 with Microsoft's SQL Serverand DBASE.andP;  Again, you only need know the basics of the spreadsheet macrolanguage and the rudiments of SQL In recognition of the importance of thisnew capability, Microsoft now ships Q+E with every copy of Excel 3.0.andM;What the Future HoldsandM;DDE puts us on the threshold of a new age in software integration.andP;  In two orthree years, we will see a wide range of interapplication connections wherebyusers can transfer data between applications with virtually no effort and noloss of format or content.andP;  Spreadsheets and databases will be among thefirst to achieve this level of integration.andM;Although this type of integration is technically possible, it is unclear howaggressively vendors will act to implement it.andP;  Microsoft must take aleadership position with the implementation of DDE in its own products inorder to move the rest of the market forward.andP;  Once users discover thepossibilities, they will begin to make purchasing decisions based on theexistence of interapplication finks.andP;  This, of course, will be the triggerfor all vendors to begin implementing DDE connections.andP;  However, whichapplications will be linked together is still an unsettled question.andO;Clearly, Excel will not be able to establish DDE finks with every wordprocessing, database, and page layout application, even though all may claimto &quot;support&quot; DDE communications.andP;  Most vendors will use DDE as a strategicmarketing tool, linking to some applications while deliberately omittingothers.andM;In the next two to three years, we will also see the natural extension of PCapplication integration: inter-PC application integration accomplished over avariety of network architectures.andP;  In this scenario, applications on separatePCs will transparently communicate over Novell, 3Com, and other networks.andO;These capabilities should produce a substantial evolution in computing andprovide much more power and ease of use to all computer users.andO;</TEXT></DOC>